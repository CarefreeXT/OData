
<!-- saved from url=(0101)http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=windows-1252">

<meta name="Generator" content="Microsoft Word 14 (filtered)">
<!--<base href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html">--><base href=".">
<title>OData Extension for Data Aggregation Version 4.0</title>
<style>
<!--
 /* Font Definitions */
 @font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Courier;
	panose-1:2 7 4 9 2 2 5 2 4 4;}
@font-face
	{font-family:"Tms Rmn";
	panose-1:2 2 6 3 4 5 5 2 3 4;}
@font-face
	{font-family:Helv;
	panose-1:2 11 6 4 2 2 2 3 2 4;}
@font-face
	{font-family:"New York";
	panose-1:2 4 5 3 6 5 6 2 3 4;}
@font-face
	{font-family:System;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
@font-face
	{font-family:Batang;
	panose-1:2 3 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimSun;
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:PMingLiU;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MS Gothic";
	panose-1:2 11 6 9 7 2 5 8 2 4;}
@font-face
	{font-family:Dotum;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:SimHei;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:MingLiU;
	panose-1:2 2 5 9 0 0 0 0 0 0;}
@font-face
	{font-family:Mincho;
	panose-1:2 2 6 9 4 3 5 8 3 5;}
@font-face
	{font-family:Gulim;
	panose-1:2 11 6 0 0 1 1 1 1 1;}
@font-face
	{font-family:Century;
	panose-1:2 4 6 4 5 5 5 2 3 4;}
@font-face
	{font-family:"Angsana New";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"Cordia New";
	panose-1:2 11 3 4 2 2 2 2 2 4;}
@font-face
	{font-family:Mangal;
	panose-1:2 4 5 3 5 2 3 3 2 2;}
@font-face
	{font-family:Latha;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Sylfaen;
	panose-1:1 10 5 2 5 3 6 3 3 3;}
@font-face
	{font-family:Vrinda;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Raavi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Shruti;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Sendnya;
	panose-1:0 0 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:Gautami;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Tunga;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Estrangelo Edessa";
	panose-1:3 8 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Cambria Math";
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:Cambria;
	panose-1:2 4 5 3 5 4 6 3 2 4;}
@font-face
	{font-family:Calibri;
	panose-1:2 15 5 2 2 2 4 3 2 4;}
@font-face
	{font-family:Tahoma;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Consolas;
	panose-1:2 11 6 9 2 2 4 3 2 4;}
@font-face
	{font-family:MingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:Marlett;
	panose-1:0 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Arial Black";
	panose-1:2 11 10 4 2 1 2 2 2 4;}
@font-face
	{font-family:"Calibri Light";
	panose-1:2 15 3 2 2 2 4 3 2 4;}
@font-face
	{font-family:"Comic Sans MS";
	panose-1:3 15 7 2 3 3 2 2 2 4;}
@font-face
	{font-family:Ebrima;
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Franklin Gothic Medium";
	panose-1:2 11 6 3 2 1 2 2 2 4;}
@font-face
	{font-family:Gabriola;
	panose-1:4 4 6 5 5 16 2 2 13 2;}
@font-face
	{font-family:Gadugi;
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:Georgia;
	panose-1:2 4 5 2 5 4 5 2 3 3;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;}
@font-face
	{font-family:"Javanese Text";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Leelawadee UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Leelawadee UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Lucida Console";
	panose-1:2 11 6 9 4 5 4 2 2 4;}
@font-face
	{font-family:"Lucida Sans Unicode";
	panose-1:2 11 6 2 3 5 4 2 2 4;}
@font-face
	{font-family:"Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"\@Malgun Gothic";
	panose-1:2 11 5 3 2 0 0 2 0 4;}
@font-face
	{font-family:"Malgun Gothic Semilight";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Malgun Gothic Semilight";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Himalaya";
	panose-1:1 1 1 0 1 1 1 1 1 1;}
@font-face
	{font-family:"Microsoft JhengHei";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft JhengHei UI";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei UI";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft JhengHei Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft JhengHei UI Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"\@Microsoft JhengHei UI Light";
	panose-1:2 11 3 4 3 5 4 4 2 4;}
@font-face
	{font-family:"Microsoft New Tai Lue";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft PhagsPa";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Sans Serif";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Microsoft Tai Le";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"Microsoft YaHei UI";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"\@Microsoft YaHei UI";
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"Microsoft YaHei Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft YaHei UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@Microsoft YaHei UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Microsoft Yi Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU-ExtB";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:PMingLiU-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@PMingLiU-ExtB";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:MingLiU_HKSCS-ExtB;
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@MingLiU_HKSCS-ExtB";
	panose-1:2 2 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Mongolian Baiti";
	panose-1:3 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MV Boli";
	panose-1:2 0 5 0 3 2 0 9 0 0;}
@font-face
	{font-family:"Myanmar Text";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Nirmala UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Palatino Linotype";
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:"Segoe MDL2 Assets";
	panose-1:5 10 1 2 1 1 1 1 1 1;}
@font-face
	{font-family:"Segoe Print";
	panose-1:2 0 6 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Segoe Script";
	panose-1:2 11 5 4 2 0 0 0 0 3;}
@font-face
	{font-family:"Segoe UI";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Black";
	panose-1:2 11 10 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Emoji";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Historic";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Light";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semibold";
	panose-1:2 11 7 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Semilight";
	panose-1:2 11 4 2 4 2 4 2 2 3;}
@font-face
	{font-family:"Segoe UI Symbol";
	panose-1:2 11 5 2 4 2 4 2 2 3;}
@font-face
	{font-family:"\@SimSun";
	panose-1:2 1 6 0 3 1 1 1 1 1;}
@font-face
	{font-family:NSimSun;
	panose-1:2 1 6 9 3 1 1 1 1 1;}
@font-face
	{font-family:"\@NSimSun";
	panose-1:2 1 6 9 3 1 1 1 1 1;}
@font-face
	{font-family:SimSun-ExtB;
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"\@SimSun-ExtB";
	panose-1:2 1 6 9 6 1 1 1 1 1;}
@font-face
	{font-family:"Sitka Small";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Text";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Subheading";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Heading";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Display";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Sitka Banner";
	panose-1:2 0 5 5 0 0 0 2 0 4;}
@font-face
	{font-family:"Trebuchet MS";
	panose-1:2 11 6 3 2 2 2 2 2 4;}
@font-face
	{font-family:Verdana;
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:Webdings;
	panose-1:5 3 1 2 1 5 9 6 7 3;}
@font-face
	{font-family:"Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic UI";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic UI Semibold";
	panose-1:2 11 7 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Semibold";
	panose-1:2 11 7 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic UI Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Light";
	panose-1:2 11 3 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic Medium";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic Medium";
	panose-1:2 11 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Yu Gothic UI Semilight";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"\@Yu Gothic UI Semilight";
	panose-1:2 11 4 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR BERKLEY";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR BLANCA";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR BONNIE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR CARTER";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR CENA";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR CHRISTY";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DARLING";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DECODE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DELANEY";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR DESTINE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR ESSENCE";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR HERMANN";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"AR JULIAN";
	panose-1:2 0 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:"MT Extra";
	panose-1:5 5 1 2 1 2 5 2 2 2;}
@font-face
	{font-family:"\@Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Wingdings 2";
	panose-1:5 2 1 2 1 5 7 7 7 7;}
@font-face
	{font-family:"Wingdings 3";
	panose-1:5 4 1 2 1 8 7 7 7 7;}
@font-face
	{font-family:"Book Antiqua";
	panose-1:2 4 6 2 5 3 5 3 3 4;}
@font-face
	{font-family:"Century Gothic";
	panose-1:2 11 5 2 2 2 2 2 2 4;}
@font-face
	{font-family:Garamond;
	panose-1:2 2 4 4 3 3 1 1 8 3;}
@font-face
	{font-family:"Monotype Corsiva";
	panose-1:3 1 1 1 1 2 1 1 1 1;}
@font-face
	{font-family:Algerian;
	panose-1:4 2 7 5 4 10 2 6 7 2;}
@font-face
	{font-family:"Baskerville Old Face";
	panose-1:2 2 6 2 8 5 5 2 3 3;}
@font-face
	{font-family:"Bauhaus 93";
	panose-1:4 3 9 5 2 11 2 2 12 2;}
@font-face
	{font-family:"Bell MT";
	panose-1:2 2 5 3 6 3 5 2 3 3;}
@font-face
	{font-family:"Berlin Sans FB";
	panose-1:2 14 6 2 2 5 2 2 3 6;}
@font-face
	{font-family:"Bernard MT Condensed";
	panose-1:2 5 8 6 6 9 5 2 4 4;}
@font-face
	{font-family:"Bodoni MT Poster Compressed";
	panose-1:2 7 7 6 8 6 1 5 2 4;}
@font-face
	{font-family:"Britannic Bold";
	panose-1:2 11 9 3 6 7 3 2 2 4;}
@font-face
	{font-family:Broadway;
	panose-1:4 4 9 5 8 11 2 2 5 2;}
@font-face
	{font-family:"Brush Script MT";
	panose-1:3 6 8 2 4 4 6 7 3 4;}
@font-face
	{font-family:"Californian FB";
	panose-1:2 7 4 3 6 8 11 3 2 4;}
@font-face
	{font-family:Centaur;
	panose-1:2 3 5 4 5 2 5 2 3 4;}
@font-face
	{font-family:Chiller;
	panose-1:4 2 4 4 3 16 7 2 6 2;}
@font-face
	{font-family:"Colonna MT";
	panose-1:4 2 8 5 6 2 2 3 2 3;}
@font-face
	{font-family:"Cooper Black";
	panose-1:2 8 9 4 4 3 11 2 4 4;}
@font-face
	{font-family:"Footlight MT Light";
	panose-1:2 4 6 2 6 3 10 2 3 4;}
@font-face
	{font-family:"Freestyle Script";
	panose-1:3 8 4 2 3 2 5 11 4 4;}
@font-face
	{font-family:"Harlow Solid Italic";
	panose-1:4 3 6 4 2 15 2 2 13 2;}
@font-face
	{font-family:Harrington;
	panose-1:4 4 5 5 5 10 2 2 7 2;}
@font-face
	{font-family:"High Tower Text";
	panose-1:2 4 5 2 5 5 6 3 3 3;}
@font-face
	{font-family:Jokerman;
	panose-1:4 9 6 5 6 13 6 2 7 2;}
@font-face
	{font-family:"Juice ITC";
	panose-1:4 4 4 3 4 10 2 2 2 2;}
@font-face
	{font-family:"Kristen ITC";
	panose-1:3 5 5 2 4 2 2 3 2 2;}
@font-face
	{font-family:"Kunstler Script";
	panose-1:3 3 4 2 2 6 7 13 13 6;}
@font-face
	{font-family:"Lucida Bright";
	panose-1:2 4 6 2 5 5 5 2 3 4;}
@font-face
	{font-family:"Lucida Calligraphy";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"Lucida Fax";
	panose-1:2 6 6 2 5 5 5 2 2 4;}
@font-face
	{font-family:"Lucida Handwriting";
	panose-1:3 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:Magneto;
	panose-1:4 3 8 5 5 8 2 2 13 2;}
@font-face
	{font-family:"Matura MT Script Capitals";
	panose-1:3 2 8 2 6 6 2 7 2 2;}
@font-face
	{font-family:Mistral;
	panose-1:3 9 7 2 3 4 7 2 4 3;}
@font-face
	{font-family:"Modern No\. 20";
	panose-1:2 7 7 4 7 5 5 2 3 3;}
@font-face
	{font-family:"Niagara Engraved";
	panose-1:4 2 5 2 7 7 3 3 2 2;}
@font-face
	{font-family:"Niagara Solid";
	panose-1:4 2 5 2 7 7 2 2 2 2;}
@font-face
	{font-family:"Old English Text MT";
	panose-1:3 4 9 2 4 5 8 3 8 6;}
@font-face
	{font-family:Onyx;
	panose-1:4 5 6 2 8 7 2 2 2 3;}
@font-face
	{font-family:Parchment;
	panose-1:3 4 6 2 4 7 8 4 8 4;}
@font-face
	{font-family:Playbill;
	panose-1:4 5 6 3 10 6 2 2 2 2;}
@font-face
	{font-family:"Poor Richard";
	panose-1:2 8 5 2 5 5 5 2 7 2;}
@font-face
	{font-family:Ravie;
	panose-1:4 4 8 5 5 8 9 2 6 2;}
@font-face
	{font-family:"Informal Roman";
	panose-1:3 6 4 2 3 4 6 11 2 4;}
@font-face
	{font-family:"Showcard Gothic";
	panose-1:4 2 9 4 2 1 2 2 6 4;}
@font-face
	{font-family:"Snap ITC";
	panose-1:4 4 10 7 6 10 2 2 2 2;}
@font-face
	{font-family:Stencil;
	panose-1:4 4 9 5 13 8 2 2 4 4;}
@font-face
	{font-family:"Tempus Sans ITC";
	panose-1:4 2 4 4 3 13 7 2 2 2;}
@font-face
	{font-family:"Viner Hand ITC";
	panose-1:3 7 5 2 3 5 2 2 2 3;}
@font-face
	{font-family:Vivaldi;
	panose-1:3 2 6 2 5 5 6 9 8 4;}
@font-face
	{font-family:"Vladimir Script";
	panose-1:3 5 4 2 4 4 7 7 3 5;}
@font-face
	{font-family:"Wide Latin";
	panose-1:2 10 10 7 5 5 5 2 4 4;}
@font-face
	{font-family:Pristina;
	panose-1:3 6 4 2 4 4 6 8 2 4;}
@font-face
	{font-family:Papyrus;
	panose-1:3 7 5 2 6 5 2 3 2 5;}
@font-face
	{font-family:"French Script MT";
	panose-1:3 2 4 2 4 6 7 4 6 5;}
@font-face
	{font-family:"Bradley Hand ITC";
	panose-1:3 7 4 2 5 3 2 3 2 3;}
@font-face
	{font-family:"Bookman Old Style";
	panose-1:2 5 6 4 5 5 5 2 2 4;}
@font-face
	{font-family:"Bookshelf Symbol 7";
	panose-1:5 1 1 1 1 1 1 1 1 1;}
@font-face
	{font-family:"MS Reference Sans Serif";
	panose-1:2 11 6 4 3 5 4 4 2 4;}
@font-face
	{font-family:"MS Reference Specialty";
	panose-1:5 0 5 0 0 0 0 0 0 0;}
@font-face
	{font-family:"Berlin Sans FB Demi";
	panose-1:2 14 8 2 2 5 2 2 3 6;}
@font-face
	{font-family:"Arial Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:"Albertus Medium";
	panose-1:2 14 6 2 3 3 4 2 3 4;}
@font-face
	{font-family:Albertus;
	panose-1:2 14 7 2 4 3 4 2 2 4;}
@font-face
	{font-family:"Albertus Extra Bold";
	panose-1:2 14 8 2 4 3 4 2 2 4;}
@font-face
	{font-family:"ITC Avant Garde Gothic";
	panose-1:2 11 6 2 2 2 2 2 2 4;}
@font-face
	{font-family:"ITC Avant Garde Gothic Demi";
	panose-1:2 11 8 2 2 2 2 2 2 4;}
@font-face
	{font-family:"ITC Bookman Light";
	panose-1:2 5 6 4 5 5 5 2 2 4;}
@font-face
	{font-family:"ITC Bookman Demi";
	panose-1:2 5 8 4 4 5 5 2 2 4;}
@font-face
	{font-family:"CG Omega";
	panose-1:2 11 5 2 5 5 8 2 3 4;}
@font-face
	{font-family:"CG Times";
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:"ITC Zapf Chancery";
	panose-1:3 2 7 2 4 4 3 8 8 4;}
@font-face
	{font-family:Clarendon;
	panose-1:2 4 6 4 4 5 5 2 2 4;}
@font-face
	{font-family:"Clarendon Condensed";
	panose-1:2 4 7 6 4 7 5 4 2 4;}
@font-face
	{font-family:"Clarendon Extended";
	panose-1:2 4 8 5 5 5 5 2 2 4;}
@font-face
	{font-family:Coronet;
	panose-1:3 3 5 2 4 4 6 7 6 5;}
@font-face
	{font-family:CourierPS;
	panose-1:2 7 6 9 2 2 5 2 4 4;}
@font-face
	{font-family:"ITC Zapf Dingbats";
	panose-1:5 2 1 2 1 7 4 2 6 9;}
@font-face
	{font-family:"Helvetica Narrow";
	panose-1:2 11 6 6 2 2 2 3 2 4;}
@font-face
	{font-family:"Letter Gothic";
	panose-1:2 11 4 9 2 2 2 3 2 4;}
@font-face
	{font-family:Marigold;
	panose-1:3 2 7 2 4 4 2 2 5 4;}
@font-face
	{font-family:"New Century Schoolbook";
	panose-1:2 4 6 3 5 7 5 2 3 4;}
@font-face
	{font-family:"Antique Olive";
	panose-1:2 11 6 3 2 2 4 3 2 4;}
@font-face
	{font-family:"Antique Olive Compact";
	panose-1:2 11 9 4 3 5 4 3 2 4;}
@font-face
	{font-family:Palatino;
	panose-1:2 4 5 2 5 5 5 3 3 4;}
@font-face
	{font-family:SymbolPS;
	panose-1:5 5 1 2 1 6 7 2 6 7;}
@font-face
	{font-family:Times;
	panose-1:2 2 6 3 5 4 5 2 3 4;}
@font-face
	{font-family:Univers;
	panose-1:2 11 6 3 2 2 2 3 2 4;}
@font-face
	{font-family:"Univers Condensed";
	panose-1:2 11 6 6 2 2 2 6 2 4;}
@font-face
	{font-family:Candara;
	panose-1:2 14 5 2 3 3 3 2 2 4;}
@font-face
	{font-family:Constantia;
	panose-1:2 3 6 2 5 3 6 3 3 3;}
@font-face
	{font-family:Corbel;
	panose-1:2 11 5 3 2 2 4 2 2 4;}
@font-face
	{font-family:"DejaVu Sans Condensed";
	panose-1:2 11 6 6 3 8 4 2 2 4;}
@font-face
	{font-family:OpenSymbol;
	panose-1:5 1 0 0 0 0 0 0 0 0;}
@font-face
	{font-family:Arimo;
	panose-1:2 11 6 4 2 2 2 2 2 4;}
@font-face
	{font-family:"Gentium Basic";
	panose-1:2 0 5 3 6 0 0 2 0 4;}
@font-face
	{font-family:"Gentium Book Basic";
	panose-1:2 0 5 3 6 0 0 2 0 4;}
@font-face
	{font-family:"DejaVu Sans";
	panose-1:2 11 6 3 3 8 4 2 2 4;}
@font-face
	{font-family:"DejaVu Sans Mono";
	panose-1:2 11 6 9 3 8 4 2 2 4;}
@font-face
	{font-family:"DejaVu Serif Condensed";
	panose-1:2 6 6 6 5 6 5 2 2 4;}
@font-face
	{font-family:"DejaVu Serif";
	panose-1:2 6 6 3 5 6 5 2 2 4;}
@font-face
	{font-family:"DejaVu Sans Light";
	panose-1:2 11 2 3 3 8 4 2 2 4;}
@font-face
	{font-family:"\@MS Mincho";
	panose-1:2 2 6 9 4 2 5 8 3 4;}
 /* Style Definitions */
 p.MsoNormal, li.MsoNormal, div.MsoNormal
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
h1
	{mso-style-link:"Heading 1 Char";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	page-break-before:always;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h2
	{mso-style-name:"Heading 2\,H2";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.4in;
	text-indent:-.4in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h3
	{mso-style-name:"Heading 3\,H3";
	mso-style-link:"Heading 3 Char\,H3 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	text-indent:-.5in;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h4
	{mso-style-name:"Heading 4\,H4";
	mso-style-link:"Heading 4 Char\,H4 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.6in;
	text-indent:-.6in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h5
	{mso-style-link:"Heading 5 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.7in;
	text-indent:-.7in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
h6
	{mso-style-link:"Heading 6 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.8in;
	text-indent:-.8in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoHeading7, li.MsoHeading7, div.MsoHeading7
	{mso-style-link:"Heading 7 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.9in;
	text-indent:-.9in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoHeading8, li.MsoHeading8, div.MsoHeading8
	{mso-style-link:"Heading 8 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	text-indent:-1.0in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
p.MsoHeading9, li.MsoHeading9, div.MsoHeading9
	{mso-style-link:"Heading 9 Char";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.1in;
	text-indent:-1.1in;
	page-break-after:avoid;
	font-size:11.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
p.MsoToc1, li.MsoToc1, div.MsoToc1
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc2, li.MsoToc2, div.MsoToc2
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:12.0pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc3, li.MsoToc3, div.MsoToc3
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:24.0pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc4, li.MsoToc4, div.MsoToc4
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:.5in;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc5, li.MsoToc5, div.MsoToc5
	{margin-top:3.0pt;
	margin-right:0in;
	margin-bottom:3.0pt;
	margin-left:48.0pt;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc6, li.MsoToc6, div.MsoToc6
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:60.0pt;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";}
p.MsoToc7, li.MsoToc7, div.MsoToc7
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:1.0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoFootnoteText, li.MsoFootnoteText, div.MsoFootnoteText
	{mso-style-link:"Footnote Text Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoCommentText, li.MsoCommentText, div.MsoCommentText
	{mso-style-link:"Comment Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";}
p.MsoHeader, li.MsoHeader, div.MsoHeader
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoFooter, li.MsoFooter, div.MsoFooter
	{mso-style-link:"Footer Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoCaption, li.MsoCaption, div.MsoCaption
	{margin-top:6.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:9.0pt;
	font-family:"Arial","sans-serif";
	font-style:italic;}
span.MsoFootnoteReference
	{vertical-align:super;}
span.MsoEndnoteReference
	{vertical-align:super;}
p.MsoEndnoteText, li.MsoEndnoteText, div.MsoEndnoteText
	{mso-style-link:"Endnote Text Char";
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoListBullet, li.MsoListBullet, div.MsoListBullet
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoListBullet2, li.MsoListBullet2, div.MsoListBullet2
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoTitle, li.MsoTitle, div.MsoTitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:24.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{mso-style-link:"Body Text Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:0in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoSubtitle, li.MsoSubtitle, div.MsoSubtitle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.MsoNoteHeading, li.MsoNoteHeading, div.MsoNoteHeading
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
a:link, span.MsoHyperlink
	{color:#0000EE;
	text-decoration:none;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;}
p
	{margin-right:0in;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial Unicode MS","sans-serif";}
code
	{font-family:"Courier New";}
pre
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial Unicode MS","sans-serif";}
tt
	{font-family:"Arial Unicode MS","sans-serif";}
p.MsoCommentSubject, li.MsoCommentSubject, div.MsoCommentSubject
	{mso-style-link:"Comment Subject Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Times New Roman","serif";
	font-weight:bold;}
p.MsoAcetate, li.MsoAcetate, div.MsoAcetate
	{mso-style-link:"Balloon Text Char";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:8.0pt;
	font-family:"Tahoma","sans-serif";}
span.MsoPlaceholderText
	{color:gray;}
p.MsoRMPane, li.MsoRMPane, div.MsoRMPane
	{margin:0in;
	margin-bottom:.0001pt;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
p.MsoListParagraph, li.MsoListParagraph, div.MsoListParagraph
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoListParagraphCxSpFirst, li.MsoListParagraphCxSpFirst, div.MsoListParagraphCxSpFirst
	{margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoListParagraphCxSpMiddle, li.MsoListParagraphCxSpMiddle, div.MsoListParagraphCxSpMiddle
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.MsoListParagraphCxSpLast, li.MsoListParagraphCxSpLast, div.MsoListParagraphCxSpLast
	{margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Titlepageinfo, li.Titlepageinfo, div.Titlepageinfo
	{mso-style-name:"Title page info";
	margin:0in;
	margin-bottom:.0001pt;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.Titlepageinfodescription, li.Titlepageinfodescription, div.Titlepageinfodescription
	{mso-style-name:"Title page info description";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.TitlepageinfodescriptionCxSpFirst, li.TitlepageinfodescriptionCxSpFirst, div.TitlepageinfodescriptionCxSpFirst
	{mso-style-name:"Title page info descriptionCxSpFirst";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.TitlepageinfodescriptionCxSpMiddle, li.TitlepageinfodescriptionCxSpMiddle, div.TitlepageinfodescriptionCxSpMiddle
	{mso-style-name:"Title page info descriptionCxSpMiddle";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.TitlepageinfodescriptionCxSpLast, li.TitlepageinfodescriptionCxSpLast, div.TitlepageinfodescriptionCxSpLast
	{mso-style-name:"Title page info descriptionCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Contributor, li.Contributor, div.Contributor
	{mso-style-name:Contributor;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.ContributorCxSpFirst, li.ContributorCxSpFirst, div.ContributorCxSpFirst
	{mso-style-name:ContributorCxSpFirst;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.ContributorCxSpMiddle, li.ContributorCxSpMiddle, div.ContributorCxSpMiddle
	{mso-style-name:ContributorCxSpMiddle;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.ContributorCxSpLast, li.ContributorCxSpLast, div.ContributorCxSpLast
	{mso-style-name:ContributorCxSpLast;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Legalnotice, li.Legalnotice, div.Legalnotice
	{mso-style-name:"Legal notice";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.LegalnoticeCxSpFirst, li.LegalnoticeCxSpFirst, div.LegalnoticeCxSpFirst
	{mso-style-name:"Legal noticeCxSpFirst";
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.LegalnoticeCxSpMiddle, li.LegalnoticeCxSpMiddle, div.LegalnoticeCxSpMiddle
	{mso-style-name:"Legal noticeCxSpMiddle";
	margin:0in;
	margin-bottom:.0001pt;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.LegalnoticeCxSpLast, li.LegalnoticeCxSpLast, div.LegalnoticeCxSpLast
	{mso-style-name:"Legal noticeCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
span.Datatype
	{mso-style-name:Datatype;
	font-family:"Courier New";}
p.Code, li.Code, div.Code
	{mso-style-name:Code;
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#D9D9D9;
	border:none;
	padding:0in;
	font-size:9.0pt;
	font-family:"Courier New";}
p.AppendixHeading2, li.AppendixHeading2, div.AppendixHeading2
	{mso-style-name:AppendixHeading2;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.4in;
	text-indent:-.4in;
	page-break-after:avoid;
	font-size:14.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Element
	{mso-style-name:Element;
	font-family:"Courier New";}
span.Attribute
	{mso-style-name:Attribute;
	font-family:"Courier New";}
span.Keyword
	{mso-style-name:Keyword;
	font-family:"Courier New";}
p.Note, li.Note, div.Note
	{mso-style-name:Note;
	margin-top:6.0pt;
	margin-right:.5in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Definitionterm, li.Definitionterm, div.Definitionterm
	{mso-style-name:"Definition term";
	margin-top:4.0pt;
	margin-right:2.0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	font-weight:bold;}
p.Definition, li.Definition, div.Definition
	{mso-style-name:Definition;
	margin-top:4.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Ref, li.Ref, div.Ref
	{mso-style-name:Ref;
	margin-top:2.0pt;
	margin-right:0in;
	margin-bottom:2.0pt;
	margin-left:1.5in;
	text-indent:-1.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	color:black;}
p.AppendixHeading1, li.AppendixHeading1, div.AppendixHeading1
	{mso-style-name:AppendixHeading1;
	margin-right:0in;
	margin-left:.25in;
	text-indent:-.25in;
	page-break-before:always;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Refterm
	{mso-style-name:"Ref term";
	font-weight:bold;}
p.Example, li.Example, div.Example
	{mso-style-name:Example;
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#E6E6E6;
	font-size:9.0pt;
	font-family:"Courier New";}
span.CODEtemp
	{mso-style-name:"CODE temp";
	font-family:"Courier New";}
p.Codesmall, li.Codesmall, div.Codesmall
	{mso-style-name:"Code small";
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#E6E6E6;
	border:none;
	padding:0in;
	font-size:8.0pt;
	font-family:"Courier New";}
p.Examplesmall, li.Examplesmall, div.Examplesmall
	{mso-style-name:"Example small";
	margin-top:0in;
	margin-right:.3in;
	margin-bottom:0in;
	margin-left:.3in;
	margin-bottom:.0001pt;
	background:#E6E6E6;
	font-size:8.0pt;
	font-family:"Courier New";}
span.Variable
	{mso-style-name:Variable;
	font-style:italic;}
span.FootnoteTextChar
	{mso-style-name:"Footnote Text Char";
	mso-style-link:"Footnote Text";
	font-family:"Arial","sans-serif";}
p.RelatedWork, li.RelatedWork, div.RelatedWork
	{mso-style-name:"Related Work";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.RelatedWorkCxSpFirst, li.RelatedWorkCxSpFirst, div.RelatedWorkCxSpFirst
	{mso-style-name:"Related WorkCxSpFirst";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.RelatedWorkCxSpMiddle, li.RelatedWorkCxSpMiddle, div.RelatedWorkCxSpMiddle
	{mso-style-name:"Related WorkCxSpMiddle";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.75in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.RelatedWorkCxSpLast, li.RelatedWorkCxSpLast, div.RelatedWorkCxSpLast
	{mso-style-name:"Related WorkCxSpLast";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.75in;
	text-indent:-.25in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Abstract, li.Abstract, div.Abstract
	{mso-style-name:Abstract;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:.5in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.Notices, li.Notices, div.Notices
	{mso-style-name:Notices;
	margin-top:0in;
	margin-right:0in;
	margin-bottom:12.0pt;
	margin-left:0in;
	page-break-before:always;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.TextBody, li.TextBody, div.TextBody
	{mso-style-name:"Text Body";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:4.0pt;
	margin-left:0in;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";}
p.AppendixHeading3, li.AppendixHeading3, div.AppendixHeading3
	{mso-style-name:AppendixHeading3;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	page-break-after:avoid;
	font-size:13.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.EndnoteTextChar
	{mso-style-name:"Endnote Text Char";
	mso-style-link:"Endnote Text";
	font-family:"Arial","sans-serif";}
p.AppendixHeading4, li.AppendixHeading4, div.AppendixHeading4
	{mso-style-name:AppendixHeading4;
	margin-top:12.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.25in;
	text-indent:-.25in;
	page-break-after:avoid;
	font-size:12.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.AppendixHeading5, li.AppendixHeading5, div.AppendixHeading5
	{mso-style-name:AppendixHeading5;
	margin-top:10.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.7in;
	text-indent:-.7in;
	page-break-after:avoid;
	font-size:10.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
p.Heading1WP, li.Heading1WP, div.Heading1WP
	{mso-style-name:"Heading 1 WP";
	margin-top:24.0pt;
	margin-right:0in;
	margin-bottom:6.0pt;
	margin-left:.3in;
	text-indent:-.3in;
	page-break-after:avoid;
	border:none;
	padding:0in;
	font-size:18.0pt;
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.FooterChar
	{mso-style-name:"Footer Char";
	mso-style-link:Footer;
	font-family:"Arial","sans-serif";}
span.BalloonTextChar
	{mso-style-name:"Balloon Text Char";
	mso-style-link:"Balloon Text";
	font-family:"Tahoma","sans-serif";}
span.Heading1Char
	{mso-style-name:"Heading 1 Char";
	mso-style-link:"Heading 1";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.code-quote
	{mso-style-name:code-quote;}
span.code-keyword
	{mso-style-name:code-keyword;}
span.Heading4Char
	{mso-style-name:"Heading 4 Char\,H4 Char";
	mso-style-link:"Heading 4\,H4";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Heading3Char
	{mso-style-name:"Heading 3 Char\,H3 Char";
	mso-style-link:"Heading 3\,H3";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
p.BulletItem, li.BulletItem, div.BulletItem
	{mso-style-name:BulletItem;
	mso-style-link:"BulletItem Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:.5in;
	margin-bottom:.0001pt;
	text-indent:-.25in;
	font-size:12.0pt;
	font-family:"Times New Roman","serif";}
span.BodyTextChar
	{mso-style-name:"Body Text Char";
	mso-style-link:"Body Text";
	font-family:"MS Mincho","serif";}
span.BulletItemChar
	{mso-style-name:"BulletItem Char";
	mso-style-link:BulletItem;}
span.CommentTextChar
	{mso-style-name:"Comment Text Char";
	mso-style-link:"Comment Text";
	font-family:"MS Mincho","serif";}
span.CommentSubjectChar
	{mso-style-name:"Comment Subject Char";
	mso-style-link:"Comment Subject";
	font-family:"MS Mincho","serif";
	font-weight:bold;}
span.Heading5Char
	{mso-style-name:"Heading 5 Char";
	mso-style-link:"Heading 5";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Heading6Char
	{mso-style-name:"Heading 6 Char";
	mso-style-link:"Heading 6";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Heading7Char
	{mso-style-name:"Heading 7 Char";
	mso-style-link:"Heading 7";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;}
span.Heading8Char
	{mso-style-name:"Heading 8 Char";
	mso-style-link:"Heading 8";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
span.Heading9Char
	{mso-style-name:"Heading 9 Char";
	mso-style-link:"Heading 9";
	font-family:"Arial","sans-serif";
	color:#3B006F;
	font-weight:bold;
	font-style:italic;}
span.apple-converted-space
	{mso-style-name:apple-converted-space;}
span.VerbatimChar
	{mso-style-name:"Verbatim Char";
	mso-style-link:"Source Code";
	font-family:"Courier New";}
p.SourceCode, li.SourceCode, div.SourceCode
	{mso-style-name:"Source Code";
	mso-style-link:"Verbatim Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:21.25pt;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SourceCodeCxSpFirst, li.SourceCodeCxSpFirst, div.SourceCodeCxSpFirst
	{mso-style-name:"Source CodeCxSpFirst";
	mso-style-link:"Verbatim Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SourceCodeCxSpMiddle, li.SourceCodeCxSpMiddle, div.SourceCodeCxSpMiddle
	{mso-style-name:"Source CodeCxSpMiddle";
	mso-style-link:"Verbatim Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:0in;
	margin-left:21.25pt;
	margin-bottom:.0001pt;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Courier New";}
p.SourceCodeCxSpLast, li.SourceCodeCxSpLast, div.SourceCodeCxSpLast
	{mso-style-name:"Source CodeCxSpLast";
	mso-style-link:"Verbatim Char";
	margin-top:0in;
	margin-right:0in;
	margin-bottom:10.0pt;
	margin-left:21.25pt;
	word-break:break-all;
	font-size:10.0pt;
	font-family:"Courier New";}
span.msoIns
	{mso-style-name:"";
	text-decoration:underline;
	color:red;}
span.msoDel
	{mso-style-name:"";
	text-decoration:line-through;
	color:blue;}
.MsoChpDefault
	{font-size:10.0pt;}
 /* Page Definitions */
 @page WordSection1
	{size:8.5in 11.0in;
	margin:1.0in 1.0in .5in 1.0in;}
div.WordSection1
	{page:WordSection1;}
@page WordSection2
	{size:8.5in 11.0in;
	margin:1.0in 1.0in .5in 1.0in;}
div.WordSection2
	{page:WordSection2;}
 /* List Definitions */
 ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>

</head>

<body lang="EN-US" link="#0000EE" vlink="purple">

<div class="WordSection1">

<p class="MsoHeader"><a href="https://www.oasis-open.org/"><span style="color:windowtext"><img border="0" width="204" height="53" id="Picture 1" src="./OData Extension for Data Aggregation Version 4.0_files/image001.jpg" alt="oasis"></span></a></p>

<div style="border:none;border-top:solid gray 1.0pt;padding:1.0pt 0in 0in 0in">

<p class="MsoSubtitle"><a name="_top"></a><span style="font-size:24.0pt">OData
Extension for Data Aggregation Version 4.0</span></p>

<p class="MsoSubtitle">Committee Specification 02</p>

<p class="MsoSubtitle">04 November 2015</p>

</div>

<p class="Titlepageinfo"><span style="font-size:12.0pt">Specification URIs</span></p>

<p class="Titlepageinfo">This version:</p>

<p class="TitlepageinfodescriptionCxSpFirst"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.docx">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.docx</a><span class="MsoHyperlink"><span style="color:windowtext"> (Authoritative)</span></span></p>

<p class="TitlepageinfodescriptionCxSpMiddle"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html</a></p>

<p class="TitlepageinfodescriptionCxSpLast"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.pdf">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.pdf</a><span class="MsoHyperlink"><span style="color:windowtext"> </span></span></p>

<p class="Titlepageinfo">Previous version:</p>

<p class="TitlepageinfodescriptionCxSpFirst"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/csprd03/odata-data-aggregation-ext-v4.0-csprd03.docx">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/csprd03/odata-data-aggregation-ext-v4.0-csprd03.docx</a><span class="MsoHyperlink"><span style="color:windowtext"> (Authoritative)</span></span></p>

<p class="TitlepageinfodescriptionCxSpMiddle"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/csprd03/odata-data-aggregation-ext-v4.0-csprd03.html">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/csprd03/odata-data-aggregation-ext-v4.0-csprd03.html</a></p>

<p class="TitlepageinfodescriptionCxSpLast"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/csprd03/odata-data-aggregation-ext-v4.0-csprd03.pdf">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/csprd03/odata-data-aggregation-ext-v4.0-csprd03.pdf</a></p>

<p class="Titlepageinfo">Latest version:</p>

<p class="TitlepageinfodescriptionCxSpFirst"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.docx">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.docx</a><span class="MsoHyperlink"><span style="color:windowtext"> (Authoritative)</span></span></p>

<p class="TitlepageinfodescriptionCxSpMiddle"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html</a></p>

<p class="TitlepageinfodescriptionCxSpLast"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.pdf">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.pdf</a></p>

<p class="Titlepageinfo">Technical Committee:</p>

<p class="Titlepageinfodescription"><a href="https://www.oasis-open.org/committees/odata/">OASIS Open Data Protocol
(OData) TC</a></p>

<p class="Titlepageinfo">Chairs:</p>

<p class="ContributorCxSpFirst">Ralf Handl (<a href="mailto:ralf.handl@sap.com">ralf.handl@sap.com</a>),
<a href="http://www.sap.com/">SAP AG</a></p>

<p class="ContributorCxSpLast">Ram Jeyaraman (<a href="mailto:Ram.Jeyaraman@microsoft.com">Ram.Jeyaraman@microsoft.com</a>), <a href="http://www.microsoft.com/">Microsoft</a></p>

<p class="Titlepageinfo">Editors:</p>

<p class="ContributorCxSpFirst">Ralf Handl (<a href="mailto:ralf.handl@sap.com">ralf.handl@sap.com</a>),
<a href="http://www.sap.com/">SAP AG</a></p>

<p class="ContributorCxSpMiddle">Hubert Heijkers (<a href="mailto:hubert.heijkers@nl.ibm.com">hubert.heijkers@nl.ibm.com</a>), <a href="http://www.ibm.com/">IBM</a></p>

<p class="ContributorCxSpMiddle">Gerald Krause (<a href="mailto:gerald.krause@sap.com">gerald.krause@sap.com</a>), <a href="http://www.sap.com/">SAP AG</a></p>

<p class="ContributorCxSpMiddle">Michael Pizzo (<a href="mailto:mikep@microsoft.com">mikep@microsoft.com</a>), <a href="http://www.microsoft.com/">Microsoft</a></p>

<p class="ContributorCxSpLast">Martin Zurmuehl (<a href="mailto:martin.zurmuehl@sap.com">martin.zurmuehl@sap.com</a>), <a href="http://www.sap.com/">SAP AG</a></p>

<p class="Titlepageinfo">Additional <a name="AdditionalArtifacts">artifacts</a>:</p>

<p class="Titlepageinfodescription">This prose specification is one component of
a Work Product that also includes:</p>

<p class="RelatedWorkCxSpFirst"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>OData Aggregation ABNF Construction Rules Version 4.0: <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/abnf/odata-aggregation-abnf.txt">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/abnf/odata-aggregation-abnf.txt</a></p>

<p class="RelatedWorkCxSpMiddle"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>OData Aggregation ABNF Test Cases: <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/abnf/odata-aggregation-testcases.xml">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/abnf/odata-aggregation-testcases.xml</a></p>

<p class="RelatedWorkCxSpLast"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>OData Aggregation Vocabulary: <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/vocabularies/Org.OData.Aggregation.V1.xml">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/vocabularies/Org.OData.Aggregation.V1.xml</a></p>

<p class="Titlepageinfo">Related work:</p>

<p class="Titlepageinfodescription">This specification is related to:</p>

<p class="RelatedWorkCxSpFirst"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>OData Version 4.0</i>. Edited by Michael Pizzo, Ralf Handl,
and Martin Zurmuehl. A multi-part Work Product that includes:</p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData Version 4.0 Part 1: Protocol</i>. Latest version. <a href="http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html">http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part1-protocol.html</a></p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData Version 4.0 Part 2: URL Conventions</i>. Latest version.
<a href="http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part2-url-conventions.html">http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part2-url-conventions.html</a></p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData Version 4.0 Part 3: Common Schema Definition Language
(CSDL)</i>. Latest version. <a href="http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part3-csdl.html">http://docs.oasis-open.org/odata/odata/v4.0/odata-v4.0-part3-csdl.html</a></p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData ABNF Construction Rules Version 4.0</i>. 30 October
2014. <a href="http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/abnf/odata-abnf-construction-rules.txt">http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/abnf/odata-abnf-construction-rules.txt</a></p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData ABNF Test Cases</i>. 30 October 2014. <a href="http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/abnf/">http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/abnf/</a></p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData Core Vocabulary</i>. 30 October 2014. <a href="http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/vocabularies/Org.OData.Core.V1.xml">http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/vocabularies/Org.OData.Core.V1.xml</a></p>

<p class="RelatedWorkCxSpMiddle" style="margin-left:1.25in"><span style="font-family:&quot;Courier New&quot;">o<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;
</span></span><i>OData Measures Vocabulary</i>. 30 October 2014. <a href="http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/vocabularies/Org.OData.Measures.V1.xml">http://docs.oasis-open.org/odata/odata/v4.0/errata02/os/complete/vocabularies/Org.OData.Measures.V1.xml</a></p>

<p class="RelatedWorkCxSpLast"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><i>OData JSON Format Version 4.0</i>. Edited by Ralf Handl, Mike
Pizzo, and Mark Biamonte. Latest version. <a href="http://docs.oasis-open.org/odata/odata-json-format/v4.0/odata-json-format-v4.0.html">http://docs.oasis-open.org/odata/odata-json-format/v4.0/odata-json-format-v4.0.html</a></p>

<p class="Titlepageinfo">Abstract:</p>

<p class="Abstract">This specification adds basic grouping and aggregation
functionality (e.g. sum, min, and max) to the Open Data Protocol (OData)
without changing any of the base principles of OData.</p>

<p class="Titlepageinfo">Status:</p>

<p class="Abstract">This document was last revised or approved by the OASIS Open
Data Protocol (OData) TC on the above date. The level of approval is also
listed above. Check the Latest version location noted above for possible
later revisions of this document. Any other numbered Versions and other technical
work produced by the Technical Committee (TC) are listed at <a href="https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=odata#technical">https://www.oasis-open.org/committees/tc_home.php?wg_abbrev=odata#technical</a>.</p>

<p class="Abstract">TC members should send comments on this specification to the
TCs email list. Others should send comments to the TCs public comment list,
after subscribing to it by following the instructions at the <a href="https://www.oasis-open.org/committees/comments/index.php?wg_abbrev=odata">Send
A Comment</a> button on the TCs web page at <a href="https://www.oasis-open.org/committees/odata/">https://www.oasis-open.org/committees/odata/</a><span class="MsoHyperlink"><span style="color:black">.</span></span></p>

<p class="Abstract">For information on whether any patents have been disclosed
that may be essential to implementing this specification, and any offers of patent
licensing terms, please refer to the Intellectual Property Rights section of
the TCs web page (<a href="https://www.oasis-open.org/committees/odata/ipr.php">https://www.oasis-open.org/committees/odata/ipr.php</a><span class="MsoHyperlink"><span style="color:black">).</span></span></p>

<p class="Titlepageinfo">Citation format:</p>

<p class="Abstract">When referencing this specification the following citation
format should be used:</p>

<p class="Abstract"><span class="Refterm">[OData-Data-Agg-v4.0]</span></p>

<p class="Abstract"><i>OData Extension for Data Aggregation Version 4.0</i>. Edited
by Ralf Handl, Hubert Heijkers, Gerald Krause, Michael Pizzo, and Martin
Zurmuehl. 04 November 2015. OASIS Committee Specification 02. <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html</a><span class="MsoHyperlink"><span style="color:windowtext">. Latest version: </span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html">http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/odata-data-aggregation-ext-v4.0.html</a>.</p>

<p class="Abstract">&nbsp;</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:1.0pt 0in 0in 0in">

<p class="Notices">Notices</p>

</div>

<p class="MsoNormal">Copyright © OASIS Open 2015. All Rights Reserved.</p>

<p class="MsoNormal">All capitalized terms in the following text have the
meanings assigned to them in the OASIS Intellectual Property Rights Policy (the
"OASIS IPR Policy"). The full <a href="https://www.oasis-open.org/policies-guidelines/ipr">Policy</a> may be
found at the OASIS website.</p>

<p class="MsoNormal">This document and translations of it may be copied and
furnished to others, and derivative works that comment on or otherwise explain
it or assist in its implementation may be prepared, copied, published, and
distributed, in whole or in part, without restriction of any kind, provided
that the above copyright notice and this section are included on all such
copies and derivative works. However, this document itself may not be modified
in any way, including by removing the copyright notice or references to OASIS,
except as needed for the purpose of developing any document or deliverable
produced by an OASIS Technical Committee (in which case the rules applicable to
copyrights, as set forth in the OASIS IPR Policy, must be followed) or as
required to translate it into languages other than English.</p>

<p class="MsoNormal">The limited permissions granted above are perpetual and will
not be revoked by OASIS or its successors or assigns.</p>

<p class="MsoNormal">This document and the information contained herein is
provided on an "AS IS" basis and OASIS DISCLAIMS ALL WARRANTIES,
EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE OF
THE INFORMATION HEREIN WILL NOT INFRINGE ANY OWNERSHIP RIGHTS OR ANY IMPLIED
WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR PURPOSE.</p>

<p class="MsoNormal">OASIS requests that any OASIS Party or any other party that
believes it has patent claims that would necessarily be infringed by
implementations of this OASIS Committee Specification or OASIS Standard, to
notify OASIS TC Administrator and provide an indication of its willingness to
grant patent licenses to such patent claims in a manner consistent with the IPR
Mode of the OASIS Technical Committee that produced this specification.</p>

<p class="MsoNormal">OASIS invites any party to contact the OASIS TC
Administrator if it is aware of a claim of ownership of any patent claims that
would necessarily be infringed by implementations of this specification by a
patent holder that is not willing to provide a license to such patent claims in
a manner consistent with the IPR Mode of the OASIS Technical Committee that
produced this specification. OASIS may include such claims on its website, but
disclaims any obligation to do so.</p>

<p class="MsoNormal">OASIS takes no position regarding the validity or scope of
any intellectual property or other rights that might be claimed to pertain to
the implementation or use of the technology described in this document or the
extent to which any license under such rights might or might not be available;
neither does it represent that it has made any effort to identify any such
rights. Information on OASIS' procedures with respect to rights in any document
or deliverable produced by an OASIS Technical Committee can be found on the
OASIS website. Copies of claims of rights made available for publication and
any assurances of licenses to be made available, or the result of an attempt
made to obtain a general license or permission for the use of such proprietary
rights by implementers or users of this OASIS Committee Specification or OASIS
Standard, can be obtained from the OASIS TC Administrator. OASIS makes no
representation that any information or list of intellectual property rights
will at any time be complete, or that any claims in such list are, in fact,
Essential Claims.</p>

<p class="MsoNormal">The name "OASIS" is a trademark of <a href="https://www.oasis-open.org/">OASIS</a>, the owner and developer of this
specification, and should be used only to refer to the organization and its
official outputs. OASIS welcomes reference to, and implementation and use of,
specifications, while reserving the right to enforce its marks against
misleading uses. Please see <a href="https://www.oasis-open.org/policies-guidelines/trademark">https://www.oasis-open.org/policies-guidelines/trademark</a>
for above guidance.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:1.0pt 0in 0in 0in">

<p class="Notices">Table of Contents</p>

</div>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016557">1<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Introduction<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">7</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016558">1.1 Terminology<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">7</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016559">1.2 Normative References<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">7</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016560">1.3 Non-Normative References<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">7</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016561">1.4 Typographical Conventions<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">7</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016562">2<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Overview<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">8</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016563">2.1 Definitions<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">8</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016564">2.2 Example Data Model<span style="color:windowtext;display:none"> </span><span style="color:windowtext;display:none">8</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016565">2.3 Example Data<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">10</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016566">2.4 Example Use Cases<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">10</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016567">3<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>System
Query Option <span style="font-family:&quot;Courier New&quot;">$apply</span><span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">12</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016568">3.1 Transformation <span style="font-family:&quot;Courier New&quot;">aggregate</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">12</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016569">3.1.1 Keyword <span style="font-family:
&quot;Courier New&quot;">as</span><span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">13</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016570">3.1.2 Keyword <span style="font-family:
&quot;Courier New&quot;">with</span><span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">14</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016571">3.1.3 Aggregation Methods<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">14</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016572">3.1.4 Keyword <span style="font-family:
&quot;Courier New&quot;">from</span><span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">16</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016573">3.1.5 Virtual Property <span style="font-family:&quot;Courier New&quot;">$count</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">17</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016574">3.2 Transformation <span style="font-family:&quot;Courier New&quot;">topcount</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">17</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016575">3.3 Transformation <span style="font-family:&quot;Courier New&quot;">topsum</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">18</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016576">3.4 Transformation <span style="font-family:&quot;Courier New&quot;">toppercent</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">18</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016577">3.5 Transformation <span style="font-family:&quot;Courier New&quot;">bottomcount</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">19</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016578">3.6 Transformation <span style="font-family:&quot;Courier New&quot;">bottomsum</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">20</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016579">3.7 Transformation <span style="font-family:&quot;Courier New&quot;">bottompercent</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">20</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016580">3.8 Transformation <span style="font-family:&quot;Courier New&quot;">identity</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">21</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016581">3.9 Transformation <span style="font-family:&quot;Courier New&quot;">concat</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">21</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016582">3.10 Transformation <span style="font-family:&quot;Courier New&quot;">groupby</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">21</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016583">3.10.1 Simple Grouping<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">22</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016584">3.10.2 Grouping with <span style="font-family:&quot;Courier New&quot;">rollup</span> and <span style="font-family:
&quot;Courier New&quot;">$all</span><span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">23</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016585">3.11 Transformation <span style="font-family:&quot;Courier New&quot;">filter</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">24</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016586">3.12 Transformation <span style="font-family:&quot;Courier New&quot;">expand</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">25</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016587">3.13 Transformation <span style="font-family:&quot;Courier New&quot;">search</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">26</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016588">3.14 Transformation <span style="font-family:&quot;Courier New&quot;">compute</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">26</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016589">3.15 Filter Function <span style="font-family:&quot;Courier New&quot;">isdefined</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">27</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016590">3.16 Evaluating <span style="font-family:&quot;Courier New&quot;">$apply</span><span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">27</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016591">3.17 Evaluating <span style="font-family:&quot;Courier New&quot;">$apply</span> as an Expand Option<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">27</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016592">3.18 ABNF for Extended URL
Conventions<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">28</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016593">4<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Representation
of Aggregated Instances<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">29</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016594">5<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Cross-Joins
and Aggregation<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">30</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016595">6<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Vocabulary
for Data Aggregation<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">31</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016596">6.1 Aggregation Capabilities<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">31</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016597">6.2 Property Annotations<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">31</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016598">6.2.1 Groupable Properties<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">31</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016599">6.2.2 Aggregatable Properties<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">31</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016600">6.2.3 Custom Aggregates<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">32</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016601">6.2.4 Context-Defining Properties<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">32</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016602">6.2.5 Example<span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">33</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016603">6.3 Hierarchies<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">33</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016604">6.3.1 Leveled Hierarchy<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">34</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016605">6.3.2 Recursive Hierarchy<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">34</span></a></p>

<p class="MsoToc3"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016606">6.3.3 Examples<span style="color:
windowtext;display:none">. </span><span style="color:windowtext;display:none">34</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016607">6.4 Actions and Functions on
Aggregated Entities<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">37</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016608">7<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Examples<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">38</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016609">7.1 Distinct Values<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">38</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016610">7.2 Aggregation Methods<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">39</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016611">7.3 Custom Aggregates<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">42</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016612">7.4 Aliasing<span style="color:windowtext;
display:none">. </span><span style="color:windowtext;display:none">43</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016613">7.5 Combining Transformations per
Group<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">44</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016614">7.6 Model Functions as Set
Transformations<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">45</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016615">7.7 Controlling Aggregation per
Rollup Level<span style="color:windowtext;display:none"> </span><span style="color:windowtext;display:none">46</span></a></p>

<p class="MsoToc2"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016616">7.8 Transformation Sequences<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">46</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016617">8<span style="font-size:11.0pt;
font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Conformance<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">49</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016618">Appendix A.<span style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Acknowledgments<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">50</span></a></p>

<p class="MsoToc1"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc435016619">Appendix B.<span style="font-size:
11.0pt;font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;;color:windowtext">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Revision
History<span style="color:windowtext;display:none">. </span><span style="color:windowtext;display:none">51</span></a></p>

<p class="TextBody">&nbsp;</p>

<p class="TextBody">&nbsp;</p>

</div>

<span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;"><br clear="all" style="page-break-before:always">
</span>

<div class="WordSection2">

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016557"></a><a name="_Toc432754659"></a><a name="_Toc376977416"></a><a name="_Toc362428702"></a><a name="_Toc354668931"></a><a name="_Toc354070165"></a><a name="_Toc354059054"></a><a name="_Toc353983361"></a><a name="_Toc353453165"></a><a name="_Toc353390931"></a><a name="_Toc353377429"></a><a name="_Toc353294845"></a><a name="_Toc353294793"></a><a name="_Toc337731786"></a><a name="_Ref337719104">1<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Introduction</a></h1>

</div>

<p class="MsoNormal" style="margin:0in;margin-bottom:.0001pt"><a name="_Toc287332007"></a><a name="_Toc85472893">This specification adds the
notion of aggregation to the Open Data Protocol (OData) without changing any of
the base principles of OData. It defines semantics and a representation for
aggregation of data, especially:</a></p>

<ul style="margin-top:0in" type="disc">
 <li class="MsoNormal" style="margin-top:0in;margin-bottom:0in;margin-bottom:
     .0001pt">Semantics and operations for querying aggregated data,</li>
 <li class="MsoNormal" style="margin-top:0in;margin-bottom:0in;margin-bottom:
     .0001pt">Results format for queries containing aggregated data,</li>
 <li class="MsoNormal" style="margin-top:0in;margin-bottom:0in;margin-bottom:
     .0001pt">Vocabulary terms to annotate what can be aggregated, and how.</li>
</ul>

<h2><a name="_Toc435016558"></a><a name="_Toc432754660"></a><a name="_Toc376977417"></a><a name="_Toc362428703"></a><a name="_Toc354668932"></a><a name="_Toc354070166"></a><a name="_Toc354059055"></a><a name="_Toc353983362"></a><a name="_Toc353453166"></a><a name="_Toc353390932"></a><a name="_Toc353377430"></a><a name="_Toc353294846"></a><a name="_Toc353294794"></a><a name="_Toc337731787"></a><a name="_Toc340007107"></a><a name="_Toc340051396"></a><a name="_Toc340159250"></a>1.1
Terminology</h2>

<p class="MsoNormal">The key words "MUST", "MUST NOT",
"REQUIRED", "SHALL", "SHALL NOT",
"SHOULD", "SHOULD NOT", "RECOMMENDED",
"MAY", and "OPTIONAL" in this document are to be
interpreted as described in <span class="Refterm">[</span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#rfc2119"><span class="Refterm"><span style="color:windowtext">RFC2119</span></span></a><span class="Refterm">]</span><b>.</b></p>

<h2><a name="_Toc435016559"></a><a name="_Toc432754661"></a><a name="_Toc376977418"></a><a name="_Toc362428704"></a><a name="_Toc354668933"></a><a name="_Toc354070167"></a><a name="_Toc354059056"></a><a name="_Toc353983363"></a><a name="_Toc353453167"></a><a name="_Toc353390933"></a><a name="_Toc353377431"></a><a name="_Toc353294847"></a><a name="_Toc353294795"></a><a name="_Toc337731788"></a><a name="_Toc287332008"></a><a name="_Toc85472894"></a><a name="_Toc12011611"></a><a name="_Ref7502892">1.2 Normative</a> References</h2>

<p class="MsoNormal" style="margin-left:108.05pt;text-indent:-93.85pt"><a name="ABNF"><span class="Refterm">[OData-ABNF]</span></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>OData ABNF
Construction Rules Version 4.0</i>. <br>
See the link in "Related work" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><a name="AggABNF"><span class="Refterm">[OData-Agg-ABNF]</span></a>&nbsp;&nbsp; <i>OData
Aggregation ABNF Construction Rules Version 4.0</i>. <br>
See link in "Additional artifacts" section on cover page. </p>

<p class="Ref" style="text-indent:-93.8pt"><span class="Refterm">[<a name="csdl">OData-CSDL</a>]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>OData
Version 4.0 Part 3: CSDL</i>. <br>
See link in "Related work" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><a name="rfc2119"><b>[</b></a><a name="ODataJSONRef"><b>OData-JSON</b></a><b>]</b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>OData JSON Format
Version 4.0.</i> <br>
See link in "Related work" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><span class="Refterm">[<a name="odata">OData-Protocol</a>]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>OData
Version 4.0 Part 1: Protocol</i>. <br>
See link in "Related work" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><a name="url"><span class="Refterm">[OData-URL]</span></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>OData
Version 4.0 Part 2: URL Conventions</i>. <br>
See link in "Related work" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><a name="VocAggr"><b>[OData-VocAggr]</b></a>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <i>OData
Aggregation Vocabulary</i>. <br>
See link in "Additional artifacts" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><b>[<a name="VocMeas">OData-VocMeas</a>]</b>&nbsp;&nbsp;&nbsp;&nbsp; <i>OData
Measures Vocabulary</i>. <br>
See link in "Related work" section on cover page.</p>

<p class="Ref" style="text-indent:-93.8pt"><span class="Refterm">[RFC2119]</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Bradner,
S., Key words for use in RFCs to Indicate Requirement Levels, BCP 14, RFC
2119, March 1997. <a href="http://www.ietf.org/rfc/rfc2119.txt">http://www.ietf.org/rfc/rfc2119.txt</a>.</p>

<h2><a name="_Toc435016560"></a><a name="_Toc432754662"></a><a name="_Toc376977419"></a><a name="_Toc362428705"></a><a name="_Toc354668934"></a><a name="_Toc354070168"></a><a name="_Toc354059057"></a><a name="_Toc353480500"></a><a name="_Toc353801071"></a><a name="_Toc353801178"></a><a name="_Toc353875716"></a><a name="_Toc353878538"></a><a name="_Toc353881678"></a><a name="_Toc353956647"></a><a name="_Toc353980707"></a><a name="_Toc353980814"></a><a name="_Toc353981171"></a><a name="_Toc353981591"></a><a name="_Toc353981872"></a><a name="_Toc353983045"></a><a name="_Toc353983140"></a><a name="_Toc353984616"></a>1.3 Non-Normative
References</h2>

<p class="Ref"><a name="Rollup"><span class="Refterm">[TSQL ROLLUP]</span></a><span class="Refterm">&nbsp;&nbsp;&nbsp;&nbsp; </span><a href="http://msdn.microsoft.com/en-us/library/bb522495.aspx">http://msdn.microsoft.com/en-us/library/bb522495.aspx</a></p>

<h2><a name="_Toc354668935"></a><a name="_Toc354070169"></a><a name="_Toc354059058"></a><a name="_Toc353983365"></a><a name="_Toc353453169"></a><a name="_Toc353390935"></a><a name="_Toc353377433"></a><a name="_Toc353294849"></a><a name="_Toc353294797"></a><a name="_Toc357161893"></a><a name="_Toc357006662"></a><a name="_Toc356909526"></a><a name="_Toc435016561"></a><a name="_Toc432754663"></a><a name="_Toc376977420"></a><a name="_Toc362428706"></a><a name="_Toc357493267"></a><a name="_Toc357180831">1.4 Typographical Conventions</a></h2>

<p class="MsoNormal">Keywords defined by this specification use this <span class="Datatype">monospaced</span> font.</p>

<p class="SourceCode">Normative source code uses this paragraph style.</p>

<p class="MsoNormal">Some sections of this specification are illustrated with
non-normative examples.</p>

<p class="MsoCaption">Example 1: text describing an example uses this paragraph
style</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">Non-normative
examples use this paragraph style.</p>

</div>

<p class="MsoNormal">All examples in this document are non-normative and
informative only.</p>

<p class="MsoNormal">All other text is normative unless otherwise labeled.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016562"></a><a name="_Toc432754664"></a><a name="_Toc376977421"></a><a name="_Toc362428707">2<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Overview</a></h1>

</div>

<p class="MsoNormal">Open Data (OData) services expose a data model that describes
the schema of the service in terms of the Entity Data Model (EDM, see <b>[</b><span class="Refterm">OData-CSDL</span><b>]</b>)<b> </b>and then allows for
querying data in terms of this model. The responses returned by an OData
service are based on that data model and retain the relationships between the
entities in the model. </p>

<p class="MsoNormal">Extending the OData query features with simple aggregation
capabilities avoids cluttering OData services with an exponential number of explicitly
modeled aggregation level entities or else restricting the consumer to a
small subset of predefined aggregations. </p>

<p class="MsoNormal">Adding the notion of aggregation to OData without changing
any of the base principles in OData<span style="font-size:11.0pt;font-family:
&quot;Helvetica&quot;,&quot;sans-serif&quot;"> </span>has two aspects:</p>

<ol style="margin-top:0in" start="1" type="1">
 <li class="MsoNormal" style="margin-top:0in;margin-bottom:0in;margin-bottom:
     .0001pt">Means for the consumer to query aggregated data on top of any
     given data model (for sufficiently capable data providers)</li>
 <li class="MsoNormal" style="margin-top:0in;margin-bottom:0in;margin-bottom:
     .0001pt">Means for the provider to annotate what data can be aggregated,
     and in which way, allowing consumers to avoid asking questions that the
     provider cannot answer.</li>
</ol>

<p class="MsoNormal">Implementing any of these two aspects is valuable in itself
independent of the other, and implementing both provides additional value for
consumers. The descriptions provided by the provider help a consumer understand
more of the data structure looking at the service's exposed data model. The
query extensions allow the consumers to express explicitly the desired
aggregation behavior for a particular query. They also allow consumers to
formulate queries that refer to the annotations as shorthand.</p>

<h2><a name="_Toc435016563"></a><a name="_Toc432754665"></a><a name="_Toc376977422"></a><a name="_Toc362428708"></a><a name="_Toc354668936"></a><a name="_Toc354070170"></a><a name="_Toc354059059"></a><a name="_Toc353983366"></a><a name="_Definitions"></a>2.1 Definitions</h2>

<p class="MsoNormal">This specification defines the following terms:</p>

<ul style="margin-top:0in" type="disc">
 <li class="MsoNormal"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregatable_Properties"><i>Aggregatable Property</i></a>
      a property for which the values can be aggregated using an aggregation
     method.</li>
 <li class="MsoNormal"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Methods"><i>Aggregation Method</i></a><i>
     </i> a method that can be used to aggregate an aggregatable property or
     expression</li>
 <li class="MsoNormal"><i>Standard Aggregation Method </i> one of the standard
     aggregation methods: <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Standard_Aggregation_1"><span style="font-family:&quot;Courier New&quot;">sum</span></a>, <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Standard_Aggregation"><span style="font-family:&quot;Courier New&quot;">min</span></a>,
     <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method_1"><span style="font-family:&quot;Courier New&quot;">max</span></a>,
     <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method_2"><span style="font-family:&quot;Courier New&quot;">average</span></a>,
     and <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method"><span style="font-family:&quot;Courier New&quot;">countdistinct</span></a></li>
 <li class="MsoNormal"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Aggregation_Methods_1"><i>Custom
     Aggregation Method</i></a><i> </i> a custom aggregation method that can
     be applied to expressions of a specified type</li>
 <li class="MsoNormal"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Dynamic_Aggregatable_1"><i>Custom
     Aggregate</i></a><i>  </i>a dynamic property that can appear in an
     aggregate clause</li>
 <li class="MsoNormal"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc361944707"><i>Groupable Property</i></a>  a
     property whose values can be used to group entities or complex type
     instances for aggregation.</li>
 <li class="MsoNormal"><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc339034389"><i>Hierarchy</i></a>  an
     arrangement of groupable properties whose values are represented as being
     above, below, or at the same level as one another.</li>
</ul>

<h2><a name="_Toc435016564"></a><a name="_Toc432754666"></a><a name="_Toc376977423"></a><a name="_Toc362428709"></a><a name="_Toc354668937"></a><a name="_Toc354070171"></a><a name="_Toc354059060"></a><a name="_Toc353983367"></a><a name="_Ref353983019"></a><a name="_Toc353453170"></a><a name="_Toc353390936"></a><a name="_Toc353377434"></a><a name="_Toc353294850"></a><a name="_Toc353294798">2.2
Example Data Model</a></h2>

<p class="MsoCaption">Example 2: The following diagram shows the terms defined in
the section above applied to a simple model that is used throughout this
document.</p>

<p class="MsoNormal" style="page-break-after:avoid"><img border="0" width="547" height="452" id="Grafik 22" src="./OData Extension for Data Aggregation Version 4.0_files/image002.png"></p>

<p class="MsoCaption">The Amount property in the Sales entity type is an
aggregatable property, and the properties of the related entity types are
groupable. These can be arranged in four hierarchies:</p>

<p class="MsoCaption" style="margin-top:6.0pt;margin-right:19.85pt;margin-bottom:
0in;margin-left:.75in;margin-bottom:.0001pt;text-indent:-.25in;page-break-after:
avoid"><span style="font-family:Symbol;font-style:normal">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Product hierarchy based on groupable properties of the Category
and Product entity types</p>

<p class="MsoCaption" style="margin-top:6.0pt;margin-right:19.85pt;margin-bottom:
0in;margin-left:.75in;margin-bottom:.0001pt;text-indent:-.25in;page-break-after:
avoid"><span style="font-family:Symbol;font-style:normal">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Customer hierarchy based on Country and Customer</p>

<p class="MsoCaption" style="margin-top:6.0pt;margin-right:19.85pt;margin-bottom:
0in;margin-left:.75in;margin-bottom:.0001pt;text-indent:-.25in;page-break-after:
avoid"><span style="font-family:Symbol;font-style:normal">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>Time hierarchy based on Year, Month and Date</p>

<p class="MsoCaption" style="margin-top:6.0pt;margin-right:19.85pt;margin-bottom:
0in;margin-left:.75in;margin-bottom:.0001pt;text-indent:-.25in;page-break-after:
avoid"><span style="font-family:Symbol;font-style:normal">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>SalesOrganization based on the recursive association to itself</p>

<p class="MsoCaption">In the context of Online Analytical Processing (OLAP), this
model might be described in terms of a Sales cube with an Amount measure
and three dimensions. This document will avoid such terms, as they are
heavily overloaded.</p>

<p class="MsoNormal">Query extensions and descriptive annotations can both be
applied to normalized as well as partly or fully denormalized schemas. </p>

<p class="MsoNormal">&nbsp;</p>

<p class="MsoNormal"><img border="0" width="624" height="193" id="Picture 2" src="./OData Extension for Data Aggregation Version 4.0_files/image003.png"></p>

<p class="MsoNormal">Note that ODatas Entity Data Model (EDM) does not mandate a
single storage model; it may be realized as a completely conceptual model whose
data structure is calculated on-the-fly for each request. The actual
"entity-relationship structure" of the model should be chosen to
simplify understanding and querying data for the target audience of a service.
Different target audiences may well require differently structured services on
top of the same storage model.</p>

<h2><a name="_Toc435016565"></a><a name="_Toc432754667"></a><a name="_Toc376977424"></a><a name="_Toc362428710"></a><a name="_Toc354668938"></a><a name="_Toc354070172"></a><a name="_Toc354059061"></a><a name="_Toc353983368"></a><a name="_Toc353453171"></a><a name="_Toc353390937"></a><a name="_Toc353377435"></a><a name="_Toc353294851"></a><a name="_Toc353294799"></a><a name="_Example_Data"></a>2.3
Example Data</h2>

<p class="MsoCaption"><a name="_Toc337483479"></a>Example 3: The following sample
data will be used to further illustrate the capabilities introduced by this
extension.</p>

<p class="MsoNormal"><img border="0" width="582" height="512" id="Picture 3" src="./OData Extension for Data Aggregation Version 4.0_files/image004.png"></p>

<h2><a name="_Toc435016566"></a><a name="_Toc432754668"></a><a name="_Toc376977425"></a><a name="_Toc362428711"></a><a name="_Toc354668939"></a><a name="_Toc354070173"></a><a name="_Toc354059062"></a><a name="_Ref354053854"></a><a name="_Ref354000508"></a><a name="_Toc353983369"></a><a name="_Toc353453172"></a><a name="_Toc353294852"></a><a name="_Toc353294800"></a><a name="_Toc353390938"></a><a name="_Toc353377436">2.4 Example Use Cases</a></h2>

<p class="MsoCaption">Example 4: In the example model, one prominent use case is
the relation of customers to products. The first question that is likely to be asked
is: Which customers bought which products? </p>

<p class="MsoCaption">This leads to the second more quantitative question: Who
bought how much of what? </p>

<p class="MsoCaption">The answer to the second question typically is visualized
as a cross-table:</p>

<div align="center">

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" width="586" style="width:439.45pt;border-collapse:collapse">
 <tbody><tr>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="66" style="width:49.6pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="47" style="width:35.45pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:none;border-top:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Food</span></p>
  </td>
  <td width="76" style="width:56.7pt;border-top:solid windowtext 1.0pt;
  border-left:none;border-bottom:solid windowtext 1.0pt;border-right:none;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="85" style="width:63.8pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="76" style="width:56.7pt;border:none;border-top:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Non-Food</span></p>
  </td>
  <td width="66" style="width:49.6pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
 </tr>
 <tr>
  <td width="76" style="width:56.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="66" style="width:49.6pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="47" style="width:35.45pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="95" style="width:70.9pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="76" style="width:56.7pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sugar</span></p>
  </td>
  <td width="85" style="width:63.8pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Coffee</span></p>
  </td>
  <td width="76" style="width:56.7pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Paper</span></p>
  </td>
 </tr>
 <tr>
  <td width="76" style="width:56.7pt;border:none;border-left:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USA</span></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="47" style="width:35.45pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">14</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="85" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">12</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">5</span></b></p>
  </td>
  <td width="66" style="width:49.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">5</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="76" style="width:56.7pt;border-top:none;border-left:solid windowtext 1.0pt;
  border-bottom:none;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;&nbsp;&nbsp; Joe</span></p>
  </td>
  <td width="47" style="width:35.45pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">6</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">2</span></p>
  </td>
  <td width="85" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">4</span></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">1</span></b></p>
  </td>
  <td width="66" style="width:49.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">1</span></p>
  </td>
 </tr>
 <tr>
  <td width="76" style="width:56.7pt;border:solid windowtext 1.0pt;border-top:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;&nbsp;&nbsp; Sue</span></p>
  </td>
  <td width="47" style="width:35.45pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">8</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="85" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">8</span></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">4</span></b></p>
  </td>
  <td width="66" style="width:49.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">4</span></p>
  </td>
 </tr>
 <tr>
  <td width="76" style="width:56.7pt;border:none;border-left:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Netherlands</span></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="47" style="width:35.45pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">EUR</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="85" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">3</span></b></p>
  </td>
  <td width="66" style="width:49.6pt;border:none;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">3</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="76" style="width:56.7pt;border:solid windowtext 1.0pt;border-top:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;background:#B8CCE4;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;&nbsp;&nbsp; Sue</span></p>
  </td>
  <td width="47" style="width:35.45pt;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">EUR</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="76" style="width:56.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">2</span></p>
  </td>
  <td width="85" style="width:63.8pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">&nbsp;</span></p>
  </td>
  <td width="76" style="width:56.7pt;border:none;border-bottom:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">3</span></b></p>
  </td>
  <td width="66" style="width:49.6pt;border-top:none;border-left:none;border-bottom:
  solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">3</span></p>
  </td>
 </tr>
</tbody></table>

</div>

<p class="MsoCaption">The data in this cross-table can be written down in a shape
that more closely resembles the structure of the data model, leaving cells
empty that have been aggregated away:</p>

<div align="center">

<table class="MsoNormalTable" border="0" cellspacing="0" cellpadding="0" style="border-collapse:collapse">
 <tbody><tr>
  <td width="106" style="width:79.55pt;border:solid windowtext 1.0pt;background:
  #B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Customer/Country</span></p>
  </td>
  <td width="104" style="width:78.05pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Customer/Name</span></p>
  </td>
  <td width="140" style="width:104.65pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Product/Category/Name</span></p>
  </td>
  <td width="85" style="width:63.8pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Product/Name</span></p>
  </td>
  <td width="57" style="width:42.5pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Amount</span></p>
  </td>
  <td width="95" style="width:70.9pt;border:solid windowtext 1.0pt;border-left:
  none;background:#B8CCE4;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Currency /Code</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USA</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Joe</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Non-Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Paper</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">1</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;border:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USA</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Joe</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sugar</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">2</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USA</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Joe</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Coffee</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">4</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USA</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sue</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Coffee</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">8</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USA</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sue</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Non-Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Paper</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">4</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">USD</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Netherlands</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sue</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sugar</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">2</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">EUR</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Netherlands</span></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Sue</span></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Non-Food</span></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">Paper</span></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">3</span></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><span style="font-size:8.0pt">EUR</span></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Sugar</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Coffee</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">12</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Paper</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">5</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Netherlands</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Sugar</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">EUR</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Netherlands</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Paper</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">1</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">EUR</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Joe</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">6</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Joe</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">1</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Sue</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">8</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Sue</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">4</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Netherlands</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Sue</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">EUR</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Netherlands</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Sue</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">3</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">EUR</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">14</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USA</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">5</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">USD</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Netherlands</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">2</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">EUR</span></b></p>
  </td>
 </tr>
 <tr>
  <td width="106" valign="top" style="width:79.55pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Netherlands</span></b></p>
  </td>
  <td width="104" valign="top" style="width:78.05pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="140" valign="top" style="width:104.65pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">Non-Food</span></b></p>
  </td>
  <td width="85" valign="top" style="width:63.8pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">&nbsp;</span></b></p>
  </td>
  <td width="57" valign="top" style="width:42.5pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">3</span></b></p>
  </td>
  <td width="95" valign="top" style="width:70.9pt;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal" style="margin-top:1.0pt;margin-right:0in;margin-bottom:
  1.0pt;margin-left:0in"><b><span style="font-size:8.0pt">EUR</span></b></p>
  </td>
 </tr>
</tbody></table>

</div>

<p class="MsoCaption">Note that this result contains seven fully qualified
aggregate values, plus fifteen rollup rows with subtotal values, shown in bold.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016567"></a><a name="_Toc432754669"></a><a name="_Toc376977426"></a><a name="_Toc362428712"></a><a name="_Toc354668940"></a><a name="_Toc354070174"></a><a name="_Toc354059063"></a><a name="_Toc353983370"></a><a name="_Ref353460970"></a><a name="_Toc353453173"></a><a name="_Ref353442482"></a><a name="_Ref353442470"></a><a name="_Toc353390939"></a><a name="_Toc353377437"></a><a name="_Toc353294853"></a><a name="_Toc353294801"></a><a name="_Toc337731794"></a><a name="_Toc337566368"></a><a name="_Toc337566454"></a><a name="_The_System_Query"></a><a name="_System_Query_Option"></a>3<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>System Query Option <span class="Datatype">$apply</span></h1>

</div>

<p class="MsoNormal"><a name="_Toc337731795">Aggregation behavior is triggered
using the query option </a><span class="Keyword">$apply</span>. It takes a sequence
of set transformations, separated by forward slashes to express that they are
consecutively applied, i.e. the result of each transformation is the input to
the next transformation. This is consistent with the use of service-defined
bindable and composable functions in path segments.</p>

<p class="MsoNormal">Unless otherwise noted, each set transformation: </p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>preserves the structure of the input type, so the structure of
the result fits into the data model of the service. </p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>does not necessarily preserve the number of instances in the result,
as this will typically differ from the number of instances in the input set.</p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>does not necessarily guarantee that all properties of the result instances
have a well-defined value.</p>

<p class="MsoNormal">So the actual (or relevant) structure of each intermediary
result will resemble a projection of the original data model that could also
have been formed using the standard system query options <span class="Datatype">$expand</span>
and <span class="Datatype">$select</span> defined in <b>[</b><span class="Refterm">OData-Protocol</span><b>]</b>, with dynamic properties representing the
aggregate values. The parameters of set transformations allow specifying how
the result instances are constructed from the input instances.</p>

<p class="MsoNormal">The set transformations defined by this extension are</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_aggregate_Transformation_1"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_topcount_Transformation"><span style="font-family:
&quot;Courier New&quot;">topcount</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_topsum_Transformation"><span style="font-family:
&quot;Courier New&quot;">topsum</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_toppercent_Transformation"><span style="font-family:
&quot;Courier New&quot;">toppercent</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_bottomcount_Transformation"><span style="font-family:&quot;Courier New&quot;">bottomcount</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_bottomsum_Transformation"><span style="font-family:
&quot;Courier New&quot;">bottomsum</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_bottompercent_Transformation"><span style="font-family:&quot;Courier New&quot;">bottompercent</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_identity_Transformation"><span style="font-family:
&quot;Courier New&quot;">identity</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Transformation_concat"><span style="font-family:&quot;Courier New&quot;">concat</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:
&quot;Courier New&quot;">groupby</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span class="Datatype"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_filter_Transformation"><span style="font-family:&quot;Courier New&quot;">filter</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span class="MsoHyperlink"><span style="font-family:Symbol;color:windowtext">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_expand_Transformation"><span style="font-family:&quot;Courier New&quot;">expand</span></a></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span class="Datatype"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Transformation_search"><span style="font-family:
&quot;Courier New&quot;">search</span></a></p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in"><span class="Datatype"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Transformation_compute"><span style="font-family:
&quot;Courier New&quot;">compute</span></a></p>

<p class="MsoNormal">Service-defined bound functions that take an entity set as
their binding parameter MAY be used as set transformations within <span class="Datatype">$apply</span> if the type of the binding parameter matches the
type of the result set of the preceding transformation. If it returns an entity
set, further transformations can follow the bound function. The parameter
syntax for bound function segments is identical to the parameter syntax for
bound functions in resource path segments or <span class="Datatype">$filter</span>
expressions. See section 7.6 for an example.</p>

<p class="MsoNormal"><a name="_The_aggregate_Transformation"></a>If a data
service that supports <span class="Datatype">$apply</span> does not support it on
the collection identified by the request resource path, it MUST fail with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_501_Not_Implemented"><span class="Datatype"><span style="color:windowtext">501
Not Implemented</span></span></a> and a meaningful human-readable error
message.</p>

<h2><a name="_Toc353453174"></a><a name="_Toc353377438"></a><a name="_Toc353294854"></a><a name="_Toc353294802"></a><a name="_Toc353390940"></a><a name="_Toc435016568"></a><a name="_Toc432754670"></a><a name="_Toc376977427"></a><a name="_Toc362428713"></a><a name="_Toc354668941"></a><a name="_Toc354070175"></a><a name="_Toc354059064"></a><a name="_Toc353983371"></a><a name="_Toc361760556"></a><a name="_Toc361844135"></a><a name="_Toc361944674"></a><a name="_The_aggregate_Transformation_1"></a><a name="_Transformation_aggregate"></a>3.1
Transformation <span class="Datatype">aggregate</span> </h2>

<p class="MsoNormal">The <span class="Datatype">aggregate</span> transformation
takes a comma-separated list of one or more <i>aggregate expressions</i> as
parameters and returns a result set with a single instance, representing the
aggregated value for all instances in the input set.</p>

<p class="MsoNormal">An aggregate expression may be:</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>an expression valid in a <span class="Datatype">$filter</span>
system query option on the input set that results in a simple value, e.g. the
path to an aggregatable property, with a specified <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Methods_1">aggregation method</a>, </p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>a <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Aggregates"><span style="color:windowtext">custom
aggregat</span></a>e,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>any of the above, followed by a <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Keyword_from"><span style="font-family:&quot;Courier New&quot;">from</span></a> expression,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>any of the above, enclosed in parentheses and prefixed with a
navigation path to related entities,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>the virtual property <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Keyword_with_1"><span style="font-family:&quot;Courier New&quot;">$count</span></a>.</p>

<p class="MsoListParagraphCxSpMiddle">&nbsp;</p>

<p class="MsoListParagraphCxSpLast" style="margin-left:0in">Any aggregate
expression that specifies an aggregation method MUST define an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Keyword_as">alias</a> for the resulting aggregated value. The
resulting instance contains one dynamic property per parameter representing the
aggregated value across all instances within the input set. The JSON
representation of these dynamic properties will include <span class="Datatype">odata.type</span>
annotations where required by <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#ODataJSONRef"><b><span style="color:black">[OData-JSON]</span></b></a><b><span style="color:black">. </span></b>If
paths are present, the corresponding navigation properties are implicitly
expanded to make the properties part of the result representation.</p>

<p class="MsoNormal"><a name="_Toc353453175"></a><a name="_Toc353390941"></a><a name="_Toc353377439"></a><a name="_Toc353294855"></a><a name="_Toc353294803"></a><a name="_Toc353289643"></a><a name="_Toc362428714"></a><a name="_Toc354668942"></a><a name="_Toc354070176"></a><a name="_Toc354059065"></a><a name="_Toc353983372"></a><a name="_The_Keyword_as"></a><a name="_Toc374610359"></a><a name="_Toc374610898"></a><a name="_Toc374621096"></a><a name="_Toc374626103"></a><a name="_Toc374626224"></a><a name="_Keyword_as"></a><a name="_Toc374610360"></a><a name="_Toc374610899"></a><a name="_Toc374621097"></a><a name="_Toc374626104"></a><a name="_Toc374626225"></a><a name="_Toc374610361"></a><a name="_Toc374610900"></a><a name="_Toc374621098"></a><a name="_Toc374626105"></a><a name="_Toc374626226"></a><a name="_Virtual_Value_$all"></a><a name="_Toc374610362"></a><a name="_Toc374610901"></a><a name="_Toc374621099"></a><a name="_Toc374626106"></a><a name="_Toc374626227"></a><a name="_Keyword_as_1"></a>The aggregate
transformation affects the structure of the result set: An expression resulting
in a simple value and a custom aggregate corresponds to a dynamic property in a
<span class="Datatype">$select</span> option. If they are preceded by a
navigation path, the corresponding <span class="Datatype">$select</span> option
would be nested in one <span class="Datatype">$expand</span> option for each
navigation property in the navigation path.</p>

<h3><a name="_Toc435016569"></a><a name="_Toc432754671"></a><a name="_Toc376977428"></a><a name="_Keyword_as_2"></a>3.1.1 Keyword <span class="Datatype">as</span> </h3>

<p class="MsoNormal">Aggregate expressions can define an alias using the <span class="Datatype">as</span> keyword, followed by a SimpleIdentifier (see <b>[</b><span class="Refterm">OData-CSDL</span><b>, section 17.2]</b>).</p>

<p class="MsoNormal">The alias will introduce a dynamic property in the
aggregated result set. The introduced dynamic property is added to the type containing
the original expression or custom aggregate. The alias MUST NOT collide with
names of declared properties, custom aggregates, or other aliases in that type.</p>

<p class="MsoNormal">When an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Methods_1">aggregation method</a>
is specified, an alias MUST be applied to the expression.</p>

<p class="MsoCaption">Example 5:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount with sum as Total,Amount with max as MxA)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Total,MxA)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Total": 24, "MxA": 8 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 6:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount mul Product/TaxRate with sum as Tax)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{ </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Tax)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value":<span class="Datatype"> [<br>
&nbsp;&nbsp;&nbsp; { </span>"@odata.id": null, <span class="Datatype">"Tax":
2.08 }</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp; ]</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">}</span></p>

</div>

<p class="MsoNormal">If the expression is to be evaluated on related entities,
the expression and its alias MUST be enclosed in parentheses and prefixed with
the navigation path to the related entities. The expression within the
parentheses MUST be an expression that could also be used in a <span class="Datatype">$filter</span> system query option on the related entities
identified by the navigation path. This syntax is intentionally similar to the
syntax of <span class="Datatype">$expand</span> with nested query options.</p>

<p class="MsoCaption">Example 7:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Products?$apply=aggregate(Sales(Amount mul Product/TaxRate with sum as Tax))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{ </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Sales(Tax))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value":<span class="Datatype"> </span>[<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Sales": [ { "Tax": 2.08
} ] }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc362428715"></a><a name="_Ref361833995"></a><a name="_Toc354668944"></a><a name="_Toc354070178"></a><a name="_Toc354059067"></a><a name="_Toc353983374"></a><a name="_Ref353970005"></a><a name="_Keyword_with"></a><a name="_Toc374610364"></a><a name="_Toc374610903"></a><a name="_Toc374621101"></a><a name="_Toc374626108"></a><a name="_Toc374626229"></a><a name="_Toc374610365"></a><a name="_Toc374610904"></a><a name="_Toc374621102"></a><a name="_Toc374626109"></a><a name="_Toc374626230"></a><a name="_Toc374610366"></a><a name="_Toc374610905"></a><a name="_Toc374621103"></a><a name="_Toc374626110"></a><a name="_Toc374626231"></a><a name="_Toc361047145"></a><a name="_Toc361237350"></a><a name="_Toc361237443"></a><a name="_Toc361260064"></a><a name="_Toc361332221"></a>An alias affects the
structure of the result set: each alias corresponds to a dynamic property in a <span class="Datatype">$select</span> option that is nested in an <span class="Datatype">$expand</span>
option for each navigation property in the path of the aliased expression.</p>

<h3><a name="_Toc435016570"></a><a name="_Toc432754672"></a><a name="_Toc376977429">3.1.2 Keyword </a><span class="Datatype">with</span> </h3>

<p class="MsoNormal">The keyword<span class="Datatype"> with</span> is used to
apply an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Methods_1">aggregation method</a> to an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc375242618">aggregatable property</a> or expression. The property or
expression being aggregated is followed by the keyword<span class="Datatype">
with</span>, followed by the name of the aggregation method to apply, followed
by the keyword <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Keyword_as_1"><span style="font-family:&quot;Courier New&quot;">as</span></a>
and an alias.</p>

<h3><a name="_Toc435016571"></a><a name="_Toc432754673"></a><a name="_Toc376977430"></a><a name="_Aggregation_Methods_1"></a>3.1.3 Aggregation
Methods</h3>

<p class="MsoNormal">Values can be aggregated using the standard aggregation
methods <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Standard_Aggregation_1"><span style="font-family:&quot;Courier New&quot;">sum</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Standard_Aggregation"><span style="font-family:&quot;Courier New&quot;">min</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method_1"><span style="font-family:&quot;Courier New&quot;">max</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method_2"><span style="font-family:&quot;Courier New&quot;">average</span></a>,
and <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method"><span style="font-family:&quot;Courier New&quot;">countdistinct</span></a>,
or with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Aggregation_Methods_1">custom aggregation methods</a>
defined by the service. Aggregate expressions containing an aggregation method
MUST define an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Keyword_as">alias</a> for the resulting aggregate
value.</p>

<h4><a name="_Toc432754675"></a><a name="_Toc376977431"></a><a name="_Toc362428716"></a><a name="_Toc354668945"></a><a name="_Toc354070179"></a><a name="_Toc354059068"></a><a name="_Toc353983375"></a><a name="_Ref353461880"></a><a name="_Toc353453176"></a><a name="_Toc353390942"></a><a name="_Toc353377440"></a><a name="_Toc353294856"></a><a name="_Toc353294804"></a><a name="_The_Standard_Aggregation_1"></a><a name="_Aggregation_Methods"></a>3.1.3.1
Standard Aggregation Method <span class="Datatype">sum</span></h4>

<p class="MsoNormal">The standard aggregation method <span class="Keyword">sum</span>
can be applied to numeric values to return the sum of the non-null values, or
null if there are no non-null values or the input set is empty. The provider
MUST choose a single type for the property across all instances of that type in
the result that is capable of representing the aggregated values. This may
require a larger integer type, <span class="Datatype">Edm.Decimal</span> with
sufficient <span class="Datatype">Precision</span> and <span class="Datatype">Scale</span>,
or <span class="Datatype">Edm.Double</span>.</p>

<p class="MsoCaption">Example 8:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount with sum as Total)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Total": 24 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h4><a name="_Toc354668946"></a><a name="_Toc354070180"></a><a name="_Toc354059069"></a><a name="_Toc353983376"></a><a name="_Toc353453177"></a><a name="_Toc353390943"></a><a name="_Toc353377441"></a><a name="_Toc353294857"></a><a name="_Toc353294805"></a><a name="_Toc432754676"></a><a name="_Toc376977432"></a><a name="_Toc362428717"></a><a name="_The_Standard_Aggregation"></a>3.1.3.2 Standard
Aggregation Method <span class="Datatype">min</span></h4>

<p class="MsoNormal">The standard aggregation method <span class="Keyword">min</span>
can be applied to values with a totally ordered domain to return the smallest
of the non-null values, or null if there are no non-null values or the input
set is empty.</p>

<p class="MsoNormal">The result property will have the same type as the input
property.</p>

<p class="MsoCaption">Example 9:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount with min as MinAmount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(MinAmount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "MinAmount": 1 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h4><a name="_Toc432754677"></a><a name="_Toc376977433"></a><a name="_Toc362428718"></a><a name="_Standard_Aggregation_Method_1"></a>3.1.3.3 Standard
Aggregation Method <span class="Datatype">max</span></h4>

<p class="MsoNormal">The standard aggregation method <span class="Keyword">max</span>
can be applied to values with a totally ordered domain to return the largest of
the non-null values, or null if there are no non-null values or the input set
is empty.</p>

<p class="MsoNormal">The result property will have the same type as the input
property</p>

<p class="MsoCaption">Example 10:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount with max as MaxAmount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(MaxAmount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "MaxAmount": 8 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h4><a name="_Toc432754678"></a><a name="_Toc376977434"></a><a name="_Toc362428719"></a><a name="_Ref361757813"></a><a name="_Standard_Aggregation_Method_2"></a>3.1.3.4 Standard Aggregation Method <span class="Datatype">average</span></h4>

<p class="MsoNormal">The standard aggregation method <span class="Keyword">average</span>
can be applied to numeric values to return the sum of the non-null values
divided by the count of the non-null values, or null if there are no non-null
values or the input set is empty.</p>

<p class="MsoNormal">The provider MUST choose a single type for the property
across all instances of that type in the result that is capable of representing
the aggregated values; either <span class="Datatype">Edm.Double</span> or <span class="Datatype">Edm.Decimal</span> with sufficient <span class="Datatype">Precision</span>
and <span class="Datatype">Scale</span>.</p>

<p class="MsoCaption">Example 11:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET ~/Sales?$apply=aggregate(Amount
with average as AverageAmount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(AverageAmount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "AverageAmount": 3.0 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h4><a name="_Toc432754679"></a><a name="_Toc376977435"></a><a name="_Toc362428720"></a><a name="_Standard_Aggregation_Method"></a>3.1.3.5 Standard
Aggregation Method <span class="Datatype">countdistinct</span></h4>

<p class="MsoNormal">The aggregation method <span class="Keyword">countdistinct</span>
counts the distinct values, omitting any null values. For navigation properties,
it counts the distinct entities in the union of all entities related to
entities in the input set. For collection-valued primitive properties, it
counts the distinct items in the union of all collection values in the input
set. </p>

<p class="MsoNormal">The result property MUST have type <span class="Keyword">Edm.Decimal</span>
with <span class="Datatype">Scale=</span>"<span class="Datatype">0</span>"
and sufficient <span class="Datatype">Precision</span>.</p>

<p class="MsoCaption">Example 12:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Product with countdistinct as DistinctProducts)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(DistinctProducts)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "DistinctProducts": 3 }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">The number of instances in the input set can be counted with
the virtual property <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Keyword_with_1"><span style="font-family:&quot;Courier New&quot;">$count</span></a>.</p>

<h4><a name="_Toc432754680"></a><a name="_Custom_Aggregation_Methods_1"></a>3.1.3.6
Custom Aggregation Methods</h4>

<p class="MsoNormal">Services can define custom aggregation methods if the
functionality offered by the standard aggregation methods is not sufficient for
the intended consumers. </p>

<p class="MsoNormal"><a name="_Toc353453179"></a><a name="_Toc353390951"></a><a name="_Toc353377449"></a><a name="_Toc353294860"></a><a name="_Toc353294808"></a><a name="_Toc376977436"></a><a name="_Toc362428721"></a><a name="_Toc354668947"></a><a name="_Ref354561006"></a><a name="_Toc354070181"></a><a name="_Toc354059070"></a><a name="_Toc353983377"></a><a name="_The_as_Keyword"></a><a name="_The_from_Keyword"></a><a name="_Keyword_from"></a>Custom aggregation
methods MUST use a namespace-qualified name (see <b><span class="Refterm">[OData-ABNF]</span></b>), i.e. contain at least one dot. Dot-less names are
reserved for future versions of this specification.</p>

<p class="MsoCaption">Example 13: custom aggregation methods that concatenates
distinct string values separated by commas</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Country),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
aggregate(Amount with sum as Total,</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Product/Name with Custom.concat as ProductNames))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Country),Amount,ProductNames)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null, "Customer":{ "Country":"Netherlands"
}, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Amount": 5, ProductNames:"Paper,Sugar" },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null, "Customer":{ "Country":"USA"
}, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Amount":19, ProductNames:"Coffee,Paper,Sugar" }<br>
&nbsp; ]<br>
}</p>

</div>

<h3><a name="_Toc435016572"></a><a name="_Toc432754681">3.1.4 Keyword </a><span class="Datatype">from</span> </h3>

<p class="MsoNormal">The <span class="Datatype">from</span> keyword gives control
over the order of aggregation across properties that are not part of the result
structure and over the aggregation methods applied in every step. </p>

<p class="MsoNormal">Instead of applying a single aggregation method for
calculating the aggregated value of an expression across all properties not
included in the result structure, other aggregation methods to be applied when <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc361760556">aggregating away</a> certain properties MAY be specified
using the <span class="Datatype">from</span> keyword, followed by a property path
of a groupable property. Each groupable property MUST be followed by a <span class="Datatype">with</span> clause unless the aggregate expression is a custom
aggregate, in which case the provider-defined behavior of the custom aggregate
is used:</p>

<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="131" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image005.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;as </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="30" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image006.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;</span></p>

<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="122" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image007.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;[ with </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="128" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image008.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;]</span></p>

<p class="MsoNormal"><span style="font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span></p>

<p class="MsoNormal" style="text-indent:.5in"><span style="font-family:&quot;Courier New&quot;">from
</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="123" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image009.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;[ with </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="129" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image010.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;]</span></p>

<p class="MsoNormal">If the <span class="Datatype">from</span> keyword is used, an
alias MUST be introduced.</p>

<p class="MsoNormal">If the <span class="Datatype">from</span> keyword is present,
first the aggregation method determined by the aggregate expression is used to
aggregate away properties that are not mentioned in a <span class="Datatype">from</span>
clause and are not <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Simple_Grouping">grouping properties</a>.</p>

<p class="MsoNormal">Then consecutively properties not part of the result are
aggregated away in the order of the <span class="Datatype">from</span> clauses
and using the method specified by the <span class="Datatype">from</span> clause.</p>

<p class="MsoNormal">More formally, the calculation of <span class="Datatype">aggregate</span>
with the <span class="Datatype">from</span> keyword is equivalent with a list of
set transformations:</p>

<p class="MsoNormal"><span class="Datatype">groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="122" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image007.png"></span>, , <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="123" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image009.png"></span><span class="Datatype">),</span></p>

<p class="MsoNormal"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="132" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image011.png"></span><span style="font-family:&quot;Courier New&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; as</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="59" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image012.png"></span><span class="Datatype">))</span></p>

<p class="MsoNormal"><span class="Datatype">/groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="123" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image013.png"></span>, , <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="123" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image009.png"></span><span class="Datatype">), </span></p>

<p class="MsoNormal"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="59" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image012.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="Datatype">with</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="128" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image008.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="Datatype">as</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="59" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image014.png"></span><span class="Datatype">))</span></p>

<p class="MsoNormal"></p>

<p class="MsoNormal"><span class="Datatype">/groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="123" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image009.png"></span><span class="Datatype">), </span></p>

<p class="MsoNormal"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="72" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image015.png"></span>&nbsp;&nbsp; <span class="Datatype">with</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="141" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image016.png"></span>&nbsp;&nbsp;&nbsp; <span class="Datatype">as</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="60" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image017.png"></span><span class="Datatype">))</span></p>

<p class="MsoNormal"><span class="Datatype">/aggregate(&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="60" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image017.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="Datatype">with</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="129" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image010.png"></span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <span class="Datatype">as</span> <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;
position:relative;top:2.5pt"><img width="30" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image006.png"></span><span class="Datatype">))</span></p>

<p class="MsoNormal">The order of <span class="Datatype">from</span> clauses has to
be compatible with hierarchies<span class="MsoHyperlink"> </span>referenced from
a<span class="MsoHyperlink"> </span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Leveled_Hierarchy">leveled
hierarchy annotation</a><span class="MsoHyperlink"> </span>or specified as an<span class="MsoHyperlink"> </span>unnamed hierarchy in<span class="MsoHyperlink"> </span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Grouping_with_rollup_1">groupby with rollup</a><span class="MsoHyperlink"><span style="color:windowtext">: l</span></span>ower nodes
in a hierarchy need to be mentioned before higher nodes in the same hierarchy.
Properties not belonging to any hierarchy can appear at any point in the <span class="Datatype">from</span> clause.</p>

<p class="MsoCaption"><a name="_Ref357758511"></a><a name="_Ref357758524">Example
</a>14:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount with sum as DailyAverage </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
from Time with average)</p>

</div>

<p class="MsoCaption">is equivalent to</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Time),aggregate(Amount with sum as Total)) <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /aggregate(Total with average as DailyAverage)</p>

</div>

<p class="MsoCaption">and results in the average sales volume per day</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(DailyAverage)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "DailyAverage": 3.428571428571429
}<br>
&nbsp; ]<a name="_Toc353294861"></a><a name="_Toc353294809"></a><a name="_Toc354668948"></a><a name="_Toc354070182"></a><a name="_Toc354059071"></a><a name="_Toc353983378"></a><a name="_Toc353453180"></a><a name="_Toc353390952"></a><a name="_Toc353377450"></a><a name="_The_topcount_Transformation"></a><a name="_The_Virtual_Property"></a></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h3><a name="_Toc435016573"></a><a name="_Toc432754682"></a><a name="_Toc376977437"></a><a name="_Toc362428722"></a><a name="_Keyword_with_1"></a><a name="_Virtual_Property_$count"></a>3.1.5 Virtual Property <span class="Datatype">$</span><span class="Datatype">count</span></h3>

<p class="MsoNormal">The value of the virtual property <span class="Keyword">$count</span>
is the number of instances in the input set. It MUST always specify an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Keyword_as">alias</a> and MUST NOT specify an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Methods_1">aggregation method</a>.</p>

<p class="MsoNormal">The result property will have type <span class="Keyword">Edm.Decimal</span>
with <span class="Datatype">Scale=</span>"<span class="Datatype">0</span>"
and sufficient <span class="Datatype">Precision</span>.</p>

<p class="MsoCaption">Example 15:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate($count as SalesCount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(SalesCount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "SalesCount": 8 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc353453181"></a><a name="_Toc353390953"></a><a name="_Toc353377451"></a><a name="_Toc435016574"></a><a name="_Toc432754683"></a><a name="_Toc376977438"></a><a name="_Toc362428723"></a><a name="_Toc354668949"></a><a name="_Toc354070183"></a><a name="_Toc354059072"></a><a name="_Toc353983379"></a><a name="_The_topcount_Transformation_1"></a>3.2 Transformation <span class="Datatype">topcount</span> </h2>

<p class="MsoNormal">The <span class="Datatype">topcount</span> transformation
takes two parameters. </p>

<p class="MsoNormal">The first parameter specifies the number of instances to
return in the transformed set. It MUST be an expression that can be evaluated
on the set level and MUST result in a positive integer.</p>

<p class="MsoNormal">The second parameter specifies the value by which the instances
are compared for determining the result set. It MUST be an expression that can
be evaluated on instances of the input set and MUST result in a primitive
numeric value.</p>

<p class="MsoNormal">The transformation retains the number of instances specified
by the first parameter that have the highest values specified by the second
expression.</p>

<p class="MsoNormal">In case the value of the second expression is ambiguous, the
service MUST impose a stable ordering before determining the returned instances.</p>

<p class="MsoCaption">Example 16:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=topcount(2,Amount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 4, "Amount": 8, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453182"></a><a name="_Toc353390954"></a><a name="_Toc353377452"></a><a name="_Toc353294862"></a><a name="_Toc353294810"></a><a name="_Toc354668950"></a><a name="_Toc354070184"></a><a name="_Toc354059073"></a><a name="_Toc353983380"></a><a name="OLE_LINK2"></a><a name="OLE_LINK1"></a><a name="_The_topsum_Transformation"></a>The result set of <span class="Datatype">topcount</span>
has the same structure as the input set.</p>

<h2><a name="_Toc435016575"></a><a name="_Toc432754684"></a><a name="_Toc376977439"></a><a name="_Toc362428724">3.3 Transformation </a><span class="Datatype">topsum</span> </h2>

<p class="MsoNormal">The <span class="Datatype">topsum</span> transformation takes
two parameters. </p>

<p class="MsoNormal">The first parameter indirectly specifies the number of instances
to return in the transformed set. It MUST be an expression that can be
evaluated on the set level and MUST result in a number.</p>

<p class="MsoNormal">The second parameter specifies the value by which the instances
are compared for determining the result set. It MUST be an expression that can
be evaluated on instances of the input set and MUST result in a primitive
numeric value.</p>

<p class="MsoNormal">The transformation returns the minimum set of instances that
have the highest values specified by the second parameter and whose sum of
these values is equal to or greater than the value specified by the first
parameter. It does not change the order of the instances in the input set.</p>

<p class="MsoNormal">In case the value of the second expression is ambiguous, the
service MUST impose a stable ordering before determining the returned instances.</p>

<p class="MsoCaption">Example 17:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=topsum(15,Amount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 4, "Amount": 8, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 5, "Amount": 4, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453183"></a><a name="_Toc353390955"></a><a name="_Toc353377453"></a><a name="_Toc353294863"></a><a name="_Toc353294811"></a><a name="_Toc354668951"></a><a name="_Toc354070185"></a><a name="_Toc354059074"></a><a name="_Toc353983381"></a><a name="_The_toppercent_Transformation"></a>The
result set of <span class="Datatype">topsum</span> has the same structure as the
input set.</p>

<h2>3.4 &nbsp;<a name="_Toc435016576"></a><a name="_Toc432754685"></a><a name="_Toc376977440"></a><a name="_Toc362428725">Transformation </a><span class="Datatype">toppercent</span> </h2>

<p class="MsoNormal">The <span class="Datatype">toppercent</span> transformation
takes two parameters. </p>

<p class="MsoNormal">The first parameter specifies the number of instances to
return in the transformed set. It MUST be an expression that can be evaluated
on the set level and MUST result in a positive number less than or equal to
100.</p>

<p class="MsoNormal">The second parameter specifies the value by which the instances
are compared for determining the result set. It MUST be an expression that can
be evaluated on instances of the input set and MUST result in a primitive
numeric value.</p>

<p class="MsoNormal">The transformation returns the minimum set of instances that
have the highest values specified by the second parameter and whose cumulative
total is equal to or greater than the percentage of the cumulative total of all
instances in the input set specified by the first parameter. It does not change
the order of the instances in the input set.</p>

<p class="MsoNormal">In case the value of the second expression is ambiguous, the
service MUST impose a stable ordering before determining the returned instances.</p>

<p class="MsoCaption">Example 18:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=toppercent(50,Amount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 4, "Amount": 8, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453184"></a><a name="_Toc353390956"></a><a name="_Toc353377454"></a><a name="_Toc353294864"></a><a name="_Toc353294812"></a><a name="_Toc354668952"></a><a name="_Toc354070186"></a><a name="_Toc354059075"></a><a name="_Toc353983382"></a><a name="_The_bottomcount_Transformation"></a>The
result set of <span class="Datatype">toppercent</span> has the same structure as
the input set.</p>

<h2>3.5 &nbsp;<a name="_Toc435016577"></a><a name="_Toc432754686"></a><a name="_Toc376977441"></a><a name="_Toc362428726">Transformation </a><span class="Datatype">bottomcount</span> </h2>

<p class="MsoNormal">The <span class="Datatype">bottomcount</span> transformation
takes two parameters. </p>

<p class="MsoNormal">The first parameter specifies the number of instances to
return in the transformed set. It MUST be an expression that can be evaluated
on the set level and MUST result in a positive integer.</p>

<p class="MsoNormal">The second parameter specifies the value by which the instances
are compared for determining the result set. It MUST be an expression that can
be evaluated on instances of the input set and MUST result in a primitive
numeric value.</p>

<p class="MsoNormal">The transformation retains the number of instances specified
by the first parameter that have the lowest values specified by the second
parameter. It does not change the order of the instances in the input set.</p>

<p class="MsoNormal">In case the value of the second expression is ambiguous, the
service MUST impose a stable ordering before determining the returned instances.</p>

<p class="MsoCaption">Example 19:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=bottomcount(2,Amount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales"</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 1, "Amount": 1, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 7, "Amount": 1, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453185"></a><a name="_Toc353390957"></a><a name="_Toc353377455"></a><a name="_Toc353294865"></a><a name="_Toc353294813"></a><a name="_Toc354668953"></a><a name="_Toc354070187"></a><a name="_Toc354059076"></a><a name="_Toc353983383"></a><a name="_The_bottomsum_Transformation"></a>The result
set of <span class="Datatype">bottomcount</span> has the same structure as the
input set.</p>

<h2>3.6 &nbsp;<a name="_Toc435016578"></a><a name="_Toc432754687"></a><a name="_Toc376977442"></a><a name="_Toc362428727">Transformation </a><span class="Datatype">bottomsum</span> </h2>

<p class="MsoNormal">The <span class="Datatype">bottomsum</span> transformation
takes two parameters. </p>

<p class="MsoNormal">The first parameter indirectly specifies the number of instances
to return in the transformed set. It MUST be an expression that can be
evaluated on the set level and MUST result in a number.</p>

<p class="MsoNormal">The second parameter specifies the value by which the instances
are compared for determining the result set. It MUST be an expression that can
be evaluated on instances of the input set and MUST result in a primitive
numeric value.</p>

<p class="MsoNormal">The transformation returns the minimum set of instances that
have the lowest values specified by the second parameter and whose sum of these
values is equal to or greater than the value specified by the first parameter.
It does not change the order of the instances in the input set.</p>

<p class="MsoNormal">In case the value of the second expression is ambiguous, the
service MUST impose a stable ordering before determining the returned instances.</p>

<p class="MsoCaption">Example 20:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=bottomsum(7,Amount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 2, "Amount": 2, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 6, "Amount": 2, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 7, "Amount": 1, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 8, "Amount": 2, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453186"></a><a name="_Toc353390958"></a><a name="_Toc353377456"></a><a name="_Toc353294866"></a><a name="_Toc353294814"></a><a name="_Toc354668954"></a><a name="_Toc354070188"></a><a name="_Toc354059077"></a><a name="_Toc353983384"></a><a name="_The_bottompercent_Transformation"></a>The
result set of <span class="Datatype">bottomsum</span> has the same structure as
the input set.</p>

<h2>3.7 &nbsp;<a name="_Toc435016579"></a><a name="_Toc432754688"></a><a name="_Toc376977443"></a><a name="_Toc362428728">Transformation </a><span class="Datatype">bottompercent</span> </h2>

<p class="MsoNormal">The <span class="Datatype">bottompercent</span> transformation
takes two parameters. </p>

<p class="MsoNormal">The first parameter indirectly specifies the number of instances
to return in the transformed set. It MUST be an expression that can be
evaluated on the set level and MUST result in a positive number less than or
equal to 100.</p>

<p class="MsoNormal">The second parameter specifies the value by which the instances
are compared for determining the result set. It MUST be an expression that can
be evaluated on instances of the input set and MUST result in a primitive
numeric value.</p>

<p class="MsoNormal">The transformation returns the minimum set of instances that
have the lowest values specified by the second parameter and whose cumulative
total is equal to or greater than the percentage of the cumulative total of all
instances in the input set specified by the first parameter. It does not change
the order of the instances in the input set.</p>

<p class="MsoNormal">In case the value of the second expression is ambiguous, the
service MUST impose a stable ordering before determining the returned instances.</p>

<p class="MsoCaption">Example 21:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=bottompercent(50,Amount)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 1, "Amount": 1, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 2, "Amount": 2, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 5, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 6, "Amount": 2, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 7, "Amount": 1, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 8, "Amount": 2, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453187"></a><a name="_Toc353390959"></a><a name="_Toc353377457"></a><a name="_Toc353294867"></a><a name="_Toc353294815"></a><a name="_Toc354668955"></a><a name="_Toc354070189"></a><a name="_Toc354059078"></a><a name="_Toc353983385"></a><a name="_The_identity_Transformation"></a>The result
set of <span class="Datatype">bottompercent</span> has the same structure as the
input set.</p>

<h2>3.8 &nbsp;<a name="_Toc435016580"></a><a name="_Toc432754689"></a><a name="_Toc376977444"></a><a name="_Toc362428729">Transformation </a><span class="Datatype">identity</span> </h2>

<p class="MsoNormal">The <span class="Datatype">identity</span> transformation
returns its input set.</p>

<p class="MsoCaption"><a name="_Toc353453188"></a><a name="_Toc353390960"></a><a name="_Toc353377458"></a><a name="_Toc353294868"></a><a name="_Toc353294816"></a><a name="_The_combine_Transformation"></a>Example 22:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=identity</p>

</div>

<h2><a name="_Toc435016581"></a><a name="_Toc432754690"></a><a name="_Toc376977445"></a><a name="_Toc362428730"></a><a name="_Toc354668956"></a><a name="_Toc354070190"></a><a name="_Toc354059079"></a><a name="_Toc353983386"></a><a name="_Transformation_concat"></a>3.9 Transformation <span class="Datatype">concat</span>
</h2>

<p class="MsoNormal">The <span class="Datatype">concat</span> transformation takes
two or more parameters, each of which is a sequence of set transformations.</p>

<p class="MsoNormal">It applies each transformation sequence to the input set and
concatenates the intermediate result sets in the order of the parameters into
the result set, preserving the ordering of the individual result sets as well
as the structure of each result instance, potentially leading to an
inhomogeneously structured result set.</p>

<p class="MsoCaption">Example 23:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=concat(topcount(2,Amount),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 4, "Amount": 8, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "@odata.context": "$metadata#Sales(Amount)/$entity", "Amount":
24<a name="_The_groupby_Transformation"></a> }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption"><a name="_Toc353453189"></a><a name="_Toc353390961"></a><a name="_Toc353377459"></a><a name="_Toc353294869"></a><a name="_Toc353294817"></a><a name="_Toc362428731"></a><a name="_Toc354668957"></a><a name="_Toc354070191"></a><a name="_Toc354059080"></a><a name="_Toc353983387"></a><a name="_The_groupby_Transformation_1"></a><a name="_Transformation_groupby"></a><a name="_Toc374621121"></a><a name="_Toc374626128"></a><a name="_Toc374626249"></a>Note
that two Sales entities with the second highest amount 4 exist in the input
set; the entity with ID 3 is included in the result, because the service chose
to use the <span class="Datatype">ID</span> property for imposing a stable
ordering. </p>

<p class="MsoNormal">The result set of <span class="Datatype">concat</span> has a mixed
form consisting of the structures imposed by the two transformation sequences.</p>

<h2><a name="_Toc435016582"></a><a name="_Toc432754691"></a><a name="_Toc376977446">3.10 Transformation </a><span class="Datatype">groupby</span>
</h2>

<p class="MsoNormal">The <span class="Datatype">groupby</span> transformation takes
one or two parameters and</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in">1.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp; </span>Splits the
initial set into subsets where all instances in a subset have the same values
for the grouping properties specified in the first parameter,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in">2.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp; </span>Applies
set transformations to each subset according to the second parameter, resulting
in a new set of potentially different structure and cardinality,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in">3.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp; </span>Ensures
that the instances in the result set contain all grouping properties with the
correct values for the group,</p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in">4.<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp; </span>Concatenates
the intermediate result sets into one result set.</p>

<h3><a name="_Toc435016583"></a><a name="_Toc432754692"></a><a name="_Toc376977447"></a><a name="_Toc362428732"></a><a name="_Toc354668958"></a><a name="_Toc354070192"></a><a name="_Toc354059081"></a><a name="_Toc353983388"></a><a name="_Toc353453190"></a><a name="_Toc353390962"></a><a name="_Toc353377460"></a><a name="_Ref353369134"></a><a name="_Toc353294870"></a><a name="_Toc353294818"></a><a name="_Toc376944821"></a><a name="_Toc376977249"></a><a name="_Toc377026816"></a><a name="_Toc377031919"></a><a name="_Simple_Grouping"></a><a name="_Toc376977250"></a>3.10.1
Simple Grouping</h3>

<p class="MsoNormal">In its simplest form the first parameter of <span class="Datatype">groupby</span> specifies the <i>grouping properties</i>, a
comma-separated list of one or more single-valued property paths (paths ending
in a single-valued primitive, complex, or navigation property) that is enclosed
in parentheses. The same property path SHOULD NOT appear more than once;
redundant property paths MAY be considered valid, but MUST NOT alter the
meaning of the request. If the property path leads to a single-valued
navigation property, this means grouping by the entity-id of the related
entities. </p>

<p class="MsoNormal">The optional second parameter is a list of set transformations,
separated by forward slashes to express that they are consecutively applied.
Transformations may take into account the grouping properties for producing
their result, e.g. <span class="Datatype">aggregate</span> removes properties
that are used neither for grouping nor for aggregation. </p>

<p class="MsoNormal">If the service is unable to group by same values for any of
the specified properties, it MUST reject the request with an error response. It
MUST NOT apply any implicit rules to group instances indirectly by another
property related to it in some way. </p>

<p class="MsoCaption"><a name="_Ref357763019">Example </a>24:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:21.55pt;margin-right:21.55pt">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">GET ~/Sales?$apply=groupby((Customer/Country,Product/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as Total))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Country),Product(Name),Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Country"
: "Netherlands" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Name": "Paper" }, "Total":
3 },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Country":
"Netherlands" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Name": "Sugar" }, "Total":
2},<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Country:
"USA" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Name": "Coffee" }, "Total":
12},<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Country:
"USA" },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Name": "Paper" },"Total":
5},<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Country:
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Sugar" }, "Total":
2}</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353390963"></a><a name="_Toc353377461"></a><a name="_Toc353294871"></a><a name="_Toc353294819"></a><a name="_Grouping_with_rollup"></a>The second parameter can be omitted to request
distinct value combinations of the grouping properties. </p>

<p class="MsoCaption">Example 25:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Product/Name,Amount))</p>

</div>

<p class="MsoCaption">and result in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Product(Name),Amount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Product": { "Name":
"Coffee" }, "Amount": 4 },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Product": { "Name":
"Coffee" }, "Amount": 8 },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Product": { "Name":
"Paper"&nbsp; }, "Amount": 1 },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Product": { "Name":
"Paper"&nbsp; }, "Amount": 2 },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Product": { "Name":
"Paper"&nbsp; }, "Amount": 4 },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Product": { "Name":
"Sugar"&nbsp; }, "Amount": 2 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption"><a name="_Toc354668959"></a><a name="_Toc354070193"></a><a name="_Toc354059082"></a><a name="_Toc353983389"></a><a name="_Toc353453191"></a><a name="_Grouping_with_rollup_1"></a>Note that the result has the same structure,
but not the same content as</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$expand=Product($select=Name)&amp;$select=Amount</p>

</div>

<p class="MsoNormal"><a name="_Toc362428733"></a><a name="_Grouping_with_rollup_2"></a>A
<span class="Datatype">groupby</span> transformation affects the structure of the
result set similar to <span class="Datatype">$select</span> where each grouping
property corresponds to an item in a <span class="Datatype">$select</span> clause.
Grouping properties that specify navigation properties are automatically
expanded, and the specified properties of that navigation property correspond
to properties specified in a <span class="Datatype">$select</span> expand option
on the expanded navigation property. The set transformations specified in the
second parameter of <span class="Datatype">groupby</span> further affect the
structure as described for each transformation; for example, the <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc361760556"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a>
transformation adds properties for each aggregate expression.<a name="_Toc376947494"></a><a name="_Toc376944822"></a></p>

<h3>3.10.2 &nbsp;<a name="_Toc435016584"></a><a name="_Toc432754693"></a><a name="_Toc376977448">Grouping with </a><span class="Datatype">rollup</span> and <span class="Datatype">$all</span></h3>

<p class="MsoNormal" style="margin:0in;margin-bottom:.0001pt">The <span class="Keyword">rollup</span> grouping operator allows requesting additional
levels of aggregation in addition to the most granular level defined by the
grouping properties. It can be used instead of a property path in the first
parameter of <span class="Datatype">groupby</span>.</p>

<p class="MsoNormal">The <span class="Datatype">rollup</span> grouping operator has
two overloads, depending on the number of parameters. </p>

<p class="MsoNormal">If used with one parameter, the parameter MUST be the value
of the <span class="Datatype">Qualifier</span> attribute of an annotation with
term <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Leveled_Hierarchy"><span style="font-family:&quot;Courier New&quot;">LeveledHierarchy</span></a>
prefixed with the navigation path leading to the annotated entity type. This
named hierarchy is used for grouping instances. </p>

<p class="MsoNormal">If used with two or more parameters, it defines an unnamed
leveled hierarchy. The first parameter is the root of the hierarchy defining
the coarsest granularity and MUST either be a single-valued property path or
the virtual property <span class="Datatype">$all</span>. The other parameters
MUST be singe-valued property paths and define consecutively finer-grained
levels of the hierarchy. This unnamed hierarchy is used for grouping instances.</p>

<p class="MsoNormal">After resolving named hierarchies, the same property path
MUST NOT appear more than once.</p>

<p class="MsoNormal">Grouping with <span class="Datatype">rollup</span> is
processed for leveled hierarchies using the following equivalence
relationships, in which <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image018.png"></span>&nbsp;is a
property path, <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;
position:relative;top:2.5pt"><img width="8" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image019.png"></span>&nbsp;is a
transformation, the ellipsis stands in for zero or more property paths, and <span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="9" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image020.png"></span>&nbsp;stands in
for zero or more <span class="Datatype">rollup</span> operators or property
paths:</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">groupby((rollup(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="29" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image022.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="17" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image023.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">)</span> is equivalent to <br>
<span class="Datatype">concat(groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="29" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image022.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="17" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image023.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="17" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image026.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">),groupby((rollup(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="29" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image022.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">))</span></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span class="Datatype"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span></span><span class="Datatype">groupby((rollup(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="16" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image027.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">)</span> is equivalent to <br>
<span class="Datatype">concat(groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="16" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image027.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">), groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">))</span></p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">groupby((rollup($all,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="16" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image028.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">)</span> is equivalent to <br>
<span class="Datatype">concat(groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="12" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image024.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">),groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="9" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image020.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;
position:relative;top:2.5pt"><img width="8" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image019.png"></span><span class="Datatype">))</span></p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">groupby((rollup($all,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="16" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image028.png"></span><span class="Datatype">)),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">)</span> is equivalent to <br>
<span class="Datatype">concat(groupby((</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="13" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image021.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">),</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:2.5pt"><img width="11" height="21" src="./OData Extension for Data Aggregation Version 4.0_files/image025.png"></span><span class="Datatype">)</span></p>

<p class="MsoNormal">Loosely speaking <span class="Datatype">groupby</span> with <span class="Datatype">rollup</span> splits the input set into groups using all
grouping properties, then removes the last property from one of the hierarchies
and splits it again using the remaining grouping properties. This is repeated
until all of the hierarchies have been used up.</p>

<p class="MsoCaption">Example 26: rolling up two hierarchies, the first with two
levels, the second with three levels:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">(rollup(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image030.png"></span><span class="Datatype">),rollup(</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image032.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image033.png"></span><span class="Datatype">))</span> </p>

</div>

<p class="MsoCaption">will result in the six groupings </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image030.png"></span><span class="Datatype">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image032.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image033.png"></span><span class="Datatype">) </span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image030.png"></span><span class="Datatype">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image032.png"></span><span class="Datatype">) </span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image030.png"></span><span class="Datatype">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">) </span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image032.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image033.png"></span><span class="Datatype">) </span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">,</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="21" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image032.png"></span><span class="Datatype">) </span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; (</span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="18" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image029.png"></span><span class="Datatype">,&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span><span style="font-size:10.0pt;font-family:&quot;Arial&quot;,&quot;sans-serif&quot;;position:relative;
top:7.0pt"><img width="19" height="24" src="./OData Extension for Data Aggregation Version 4.0_files/image031.png"></span><span class="Datatype">) </span></p>

</div>

<p class="MsoNormal">Note that <span class="Keyword">rollup</span> stops one level
earlier than <span class="Datatype">GROUP BY ROLLUP</span> in TSQL, see [TSQL ROLLUP<span class="Refterm">]</span>, unless the virtual property <span class="Datatype">$all</span> is used as the hierarchy root level. Loosely
speaking the root level is never rolled up.</p>

<p class="MsoNormal">Ordering of rollup instances within detail instances is up
to the service if no <span class="Datatype">$orderby</span> is given, otherwise
at the position determined by <span class="Datatype">$orderby</span>. </p>

<p class="MsoCaption">Example 27: answering the second question in section 2.4</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((rollup(Customer/Country,Customer/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; rollup(Product/Category/Name,Product/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Currency/Code),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as Total))</p>

</div>

<p class="MsoCaption">results in seven entities for the finest grouping level</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"@odata.context":"$metadata#Sales(Customer(Country,Name),Product(Category(Name),Name),Total,Currency(Code))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Country":
"USA", "Name": "Joe" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Category": { "Name":
"Non-Food" }, "Name": "Paper" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Total": 1, "Currency": { "Code":
"USD" } <br>
&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp; ...</p>

</div>

<p class="MsoCaption">plus additional fifteen rollup entities for subtotals: five
without customer name </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Country":
"USA" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Category": { "Name":
"Food" }, "Name": "Sugar" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Total": 2, "Currency": { "Code":
"USD" }<br>
&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp; ...</p>

</div>

<p class="MsoCaption">six without product name </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Country":
"USA", "Name": "Joe" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Category": { "Name":
"Food" } }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Total": 6, "Currency": { "Code":
"USD" }<br>
&nbsp;&nbsp;&nbsp; },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
...</p>

</div>

<p class="MsoCaption">and four with neither customer nor product name </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Country":
"USA" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Category": { "Name":
"Food" } }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Total": 14, "Currency": { "Code":
"USD" }<br>
&nbsp;&nbsp;&nbsp; },<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp; ]<a name="_Toc353453200"></a><a name="_Toc353390972"></a><a name="_Toc353377470"></a><a name="_Toc353294872"></a><a name="_Toc353294820"></a><a name="_Toc353983390"></a><a name="_Toc353375616"></a><a name="_Toc353375682"></a><a name="_Toc353377469"></a><a name="_Toc353380771"></a><a name="_Toc353390971"></a><a name="_Toc353393043"></a><a name="_Toc353435843"></a><a name="_Toc353435950"></a><a name="_Toc353439898"></a><a name="_Toc353439972"></a><a name="_Toc353440069"></a><a name="_Toc353441365"></a><a name="_Toc353441428"></a><a name="_Toc353441783"></a><a name="_Toc353442339"></a><a name="_Toc353442402"></a><a name="_Toc353443200"></a><a name="_Toc353443891"></a><a name="_Toc353444312"></a><a name="_Toc353445101"></a><a name="_Toc353445346"></a><a name="_Toc353445410"></a><a name="_Toc353445474"></a><a name="_Toc353445538"></a><a name="_Toc353445602"></a><a name="_Toc353445666"></a><a name="_Toc353449531"></a><a name="_Toc353449957"></a><a name="_Toc353450127"></a><a name="_Toc353450268"></a><a name="_Toc353450778"></a><a name="_Toc353450842"></a><a name="_Toc353451148"></a><a name="_Toc353451267"></a><a name="_Toc353451515"></a><a name="_Toc353451579"></a><a name="_Toc353451643"></a><a name="_Toc353451772"></a><a name="_Toc353451836"></a><a name="_Toc353452020"></a><a name="_Toc353452269"></a><a name="_Toc353452333"></a><a name="_Toc353452507"></a><a name="_Toc353452631"></a><a name="_Toc353452695"></a><a name="_Toc353453135"></a><a name="_Toc353453199"></a><a name="_Toc353453321"></a><a name="_Toc353480532"></a><a name="_Toc353801112"></a><a name="_Toc353801219"></a><a name="_Toc353875749"></a><a name="_Toc353878572"></a><a name="_Toc353881712"></a><a name="_Toc353956681"></a><a name="_Toc353980741"></a><a name="_Toc353980848"></a><a name="_Toc353981205"></a><a name="_Toc353981625"></a><a name="_Toc353981906"></a><a name="_Toc353983079"></a><a name="_Toc353983174"></a><a name="_Toc353984650"></a><a name="_The_filter_Transformation"></a></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc362428734"></a><a name="_Toc354668960"></a><a name="_Toc354070194"></a><a name="_Toc354059083">Note that the absence of one
or more properties of the result structure imposed by the surrounding OData
context allows distinguishing rollup entities from other entities.</a></p>

<h2><a name="_Toc435016585"></a><a name="_Toc432754694"></a><a name="_Toc376977449"></a><a name="_Transformation_filter"></a>3.11 Transformation
<span class="Datatype">filter</span> </h2>

<p class="MsoNormal">The <span class="Datatype">filter</span> transformation takes
a Boolean expression that could also be passed as a <span class="Datatype">$filter</span>
system query option to its input set and returns all instances for which this
expression evaluates to <span class="Datatype">true</span>.</p>

<p class="MsoCaption">Example 28:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=filter(Amount gt 3)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 4, "Amount": 8, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 5, "Amount": 4, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353453201"></a><a name="_Toc353390973"></a><a name="_Toc353377471"></a><a name="_Toc353294873"></a><a name="_Toc353294821"></a><a name="_Toc354668961"></a><a name="_Toc354070195"></a><a name="_Toc354059084"></a><a name="_Toc353983391"></a><a name="_The_expand_Transformation"></a>The result
set of <span class="Datatype">filter</span> has the same structure as the input
set.</p>

<h2><a name="_Toc435016586"></a><a name="_Toc432754695"></a><a name="_Toc376977450"></a><a name="_Toc362428735">3.12 Transformation </a><span class="Datatype">expand</span> </h2>

<p class="MsoNormal">The <span class="Datatype">expand</span> transformation takes
a navigation property path that could also be passed as a <span class="Datatype">$expand</span>
system query option as its first parameter. The optional second parameter can
be either a <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Transformation_filter"><span style="font-family:&quot;Courier New&quot;">filter</span></a>
transformation that will be applied to the related entities or an <span class="Datatype">expand</span> transformation. An arbitrary number of <span class="Datatype">expand</span> transformations can be passed as additional
parameters to achieve multi-level expansion.</p>

<p class="MsoNormal">The result set is the input set with the specified
navigation property expanded according to the specified expand options. </p>

<p class="MsoCaption"><a name="_Toc337731796"></a><a name="_Toc340007117"></a><a name="_Toc340051406"></a><a name="_Toc340159260"></a>Example 29:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Customers?$apply=expand(Sales,filter(Amount gt 3))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Customers",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": "C1", "Name": "Joe",
"Country": "USA", <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Sales": [{ "ID": 3, "Amount": 4, ... }]},<br>
&nbsp;&nbsp;&nbsp; { "ID": "C2", "Name": "Sue",
"Country": "USA",<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Sales": [{ "ID": 4, "Amount": 8, ... },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "ID": 5, "Amount": 4, ... }]},<br>
&nbsp;&nbsp;&nbsp; { "ID": "C3", "Name": "Sue",
"Country": "Netherlands", "Sales": []},<br>
&nbsp;&nbsp;&nbsp; { "ID": "C4", "Name": "Luc",
"Country": "France",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Sales": []}<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption"><a name="_Toc353453205"></a><a name="_Toc353377481"></a><a name="_Toc353390983"></a><a name="_Toc353294883"></a><a name="_Toc353294831"></a><a name="_Toc337731807"></a><a name="_Toc354668962"></a><a name="_Toc354070196"></a><a name="_Toc354059085"></a><a name="_Ref354058284"></a><a name="_Toc353983394"></a><a name="_Toc353875752"></a><a name="_Toc353878575"></a><a name="_Toc353881715"></a><a name="_Toc353956684"></a><a name="_Toc353980744"></a><a name="_Toc353980851"></a><a name="_Toc353981208"></a><a name="_Toc353981494"></a><a name="_Toc353981628"></a><a name="_Toc353981909"></a><a name="_Toc353983082"></a><a name="_Toc353983177"></a><a name="_Toc353983392"></a><a name="_Toc353984653"></a><a name="_Toc353875753"></a><a name="_Toc353878576"></a><a name="_Toc353881716"></a><a name="_Toc353956685"></a><a name="_Toc353980745"></a><a name="_Toc353980852"></a><a name="_Toc353981209"></a><a name="_Toc353981629"></a><a name="_Toc353981910"></a><a name="_Toc353983083"></a><a name="_Toc353983178"></a><a name="_Toc353984654"></a><a name="_Toc353875763"></a><a name="_Toc353878586"></a><a name="_Toc353881726"></a><a name="_Toc353956695"></a><a name="_Toc353980755"></a><a name="_Toc353980862"></a><a name="_Toc353981219"></a><a name="_Toc353981639"></a><a name="_Toc353981920"></a><a name="_Toc353983093"></a><a name="_Toc353983188"></a><a name="_Toc353984664"></a><a name="_Toc353875764"></a><a name="_Toc353878587"></a><a name="_Toc353881727"></a><a name="_Toc353956696"></a><a name="_Toc353980756"></a><a name="_Toc353980863"></a><a name="_Toc353981220"></a><a name="_Toc353981640"></a><a name="_Toc353981921"></a><a name="_Toc353983094"></a><a name="_Toc353983189"></a><a name="_Toc353984665"></a><a name="_Toc353875765"></a><a name="_Toc353878588"></a><a name="_Toc353881728"></a><a name="_Toc353956697"></a><a name="_Toc353980757"></a><a name="_Toc353980864"></a><a name="_Toc353981221"></a><a name="_Toc353981641"></a><a name="_Toc353981922"></a><a name="_Toc353983095"></a><a name="_Toc353983190"></a><a name="_Toc353984666"></a><a name="_Toc353875766"></a><a name="_Toc353878589"></a><a name="_Toc353881729"></a><a name="_Toc353956698"></a><a name="_Toc353980758"></a><a name="_Toc353980865"></a><a name="_Toc353981222"></a><a name="_Toc353981642"></a><a name="_Toc353981923"></a><a name="_Toc353983096"></a><a name="_Toc353983191"></a><a name="_Toc353984667"></a><a name="_Toc353875768"></a><a name="_Toc353878591"></a><a name="_Toc353881731"></a><a name="_Toc353956700"></a><a name="_Toc353980760"></a><a name="_Toc353980867"></a><a name="_Toc353981224"></a><a name="_Toc353981644"></a><a name="_Toc353981925"></a><a name="_Toc353983098"></a><a name="_Toc353983193"></a><a name="_Toc353984669"></a><a name="_Toc353875773"></a><a name="_Toc353878596"></a><a name="_Toc353881736"></a><a name="_Toc353956705"></a><a name="_Toc353980765"></a><a name="_Toc353980872"></a><a name="_Toc353981229"></a><a name="_Toc353981649"></a><a name="_Toc353981930"></a><a name="_Toc353983103"></a><a name="_Toc353983198"></a><a name="_Toc353984674"></a><a name="_Toc340007123"></a><a name="_Toc340051412"></a><a name="_Toc340159266"></a><a name="_Toc338852937"></a><a name="_Toc340159268"></a><a name="_Toc337730156"></a><a name="_Toc337730224"></a><a name="_Toc337730913"></a><a name="_Toc337731743"></a><a name="_Toc337731802"></a><a name="_Toc337732515"></a><a name="_Toc337733351"></a><a name="_Toc338080811"></a><a name="_Toc338838102"></a><a name="_Toc338852939"></a><a name="_Toc337730158"></a><a name="_Toc337730226"></a><a name="_Toc337730915"></a><a name="_Toc337731745"></a><a name="_Toc337731804"></a><a name="_Toc337732517"></a><a name="_Toc337733353"></a><a name="_Toc338080813"></a><a name="_Toc338838104"></a><a name="_Toc340051416"></a>The
result has the same structure and content as</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Customers?$expand=Sales($filter=Amount gt 3)</p>

</div>

<p class="MsoNormal">An <span class="Datatype">expand</span> transformation affects
the structure of the result set in the same way as an <span class="Datatype">$expand</span>
option for the first parameter, with nested <span class="Datatype">$expand</span>
options for the optional nested <span class="Datatype">expand</span> transformations.</p>

<p class="MsoCaption"><a name="_Toc362428736">Example </a>30: nested <span class="Datatype">expand</span> transformations</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Categories?$apply=expand(Products,expand(Sales,filter(Amount gt 3)))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Customers",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"ID": "PG1", "Name": "Food", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Products": [<br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "ID": "P1", "Name": "Sugar", &nbsp;"Color":
"White", "Sales": [] },<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{ "ID": "P2", "Name": "Coffee",
"Color": "Brown", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "ID": 4, "Amount": 8, ... } ] }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
},<br>
&nbsp;&nbsp;&nbsp; { "ID": "PG2", "Name": "Non-Food", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Products": [<br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "ID": "P3", "Name": "Paper", &nbsp;"Color":
"White", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "ID": 5, "Amount": 4, ... },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
{ "ID": 8, "Amount": 2, ... } ] },<br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{ "ID": "P4", "Name": "Pencil",
"Color": "Black", "Sales": [] }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016587"></a><a name="_Toc432754696"></a><a name="_Toc376977451"></a><a name="_Transformation_search"></a>3.13 Transformation
<span class="Datatype">search</span> </h2>

<p class="MsoNormal">The <span class="Datatype">search</span> transformation takes
a search expression that could also be passed as a <span class="Datatype">$search</span>
system query option to its input set and returns all entities that match this
search expression.</p>

<p class="MsoCaption">Example 31: assuming that free-text search on <span class="Datatype">Sales</span> takes the related product name into account, </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=search(coffee)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": 3, "Amount": 4, ... },<br>
&nbsp;&nbsp;&nbsp; { "ID": 4, "Amount": 8, ... }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">The result set of <span class="Datatype">search</span> has the
same structure as the input set.</p>

<h2><a name="_Toc376977452"></a><a name="_Toc362428737"></a><a name="_Toc435016588"></a><a name="_Toc432754697"></a><a name="_Toc361047168"></a><a name="_Toc361237373"></a><a name="_Toc361237466"></a><a name="_Toc361260087"></a><a name="_Toc361332244"></a><a name="_Transformation_compute"></a>3.14 Transformation
<span class="Datatype">compute</span> </h2>

<p class="MsoNormal">The <span class="Datatype">compute</span> transformation takes
a comma-separated list of one or more <i>compute expressions</i> as parameters.
</p>

<p class="MsoNormal">A compute expression is an expression valid in a <span class="Datatype">$filter</span> system query option on the input set that results
in a simple value, followed by the <span class="Datatype">as</span> keyword,
followed by a SimpleIdentifier (see <b>[</b><span class="Refterm">OData-CSDL</span><b>,
section 17.2]</b>), called an alias. This alias MUST NOT collide with names of
properties in the input set or with other aliases introduced in the same <span class="Datatype">compute</span> transformation.</p>

<p class="MsoNormal">The result set is constructed by copying the instances of
the input set and adding one dynamic property per compute expression to each
instance of the input set. The name of the added property is the alias
following the <span class="Datatype">as</span> keyword. The value of the property
is the value of the compute expression evaluated on that instance. The type of
the property is determined by the rules for evaluating <span class="Datatype">$filter</span>
expressions and numeric promotion defined in <b>[OData-URL]</b>. The JSON
representation of these dynamic properties will include <span class="Datatype">odata.type</span>
annotations where required by <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#ODataJSONRef"><b><span style="color:black">[OData-JSON]</span></b></a><b><span style="color:black">. </span></b></p>

<p class="MsoNormal">The values of properties copied from the input set are not
changed, nor is the order of instances changed.</p>

<p class="MsoCaption">Example 32:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=compute(Amount mul Product/TaxRate as Tax)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{ </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"@odata.context": "$metadata#Sales",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value":<span class="Datatype"> [<br>
&nbsp;&nbsp;&nbsp; { "ID": 1</span>, ..., "Amount": 1, <span class="Datatype">"Tax": 0.14 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 2</span>, ..., "Amount": 2, <span class="Datatype">"Tax": 0.12 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 3</span>, ..., "Amount": 4, <span class="Datatype">"Tax": 0.24 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 4</span>, ..., "Amount": 8, <span class="Datatype">"Tax": 0.48 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 5</span>, ..., "Amount": 4, <span class="Datatype">"Tax": 0.56 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 6</span>, ..., "Amount": 2, <span class="Datatype">"Tax": 0.12 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 7</span>, ..., "Amount": 1, <span class="Datatype">"Tax": 0.14 },</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp;&nbsp;&nbsp; { "ID": 8</span>, ..., "Amount": 2, <span class="Datatype">"Tax": 0.28 }</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">&nbsp; ]</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span class="Datatype">}</span></p>

</div>

<h2><a name="_Toc435016589"></a><a name="_Toc432754698">3.15 Filter Function </a><span class="Datatype">isdefined</span></h2>

<p class="MsoNormal">Properties that are not explicitly mentioned in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_aggregate_Transformation_1"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a>
or <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:&quot;Courier New&quot;">groupby</span></a>
are considered to have been <i>aggregated away</i> and are treated as having
the null value in <span class="Datatype">$filter</span> expressions. </p>

<p class="MsoNormal">The filter function <span class="Datatype">isdefined</span>
can be used to determine whether a property has been aggregated away. It takes
a single-valued property path as its only parameter and returns <span class="Datatype">true</span> if the property has a defined value for the
aggregated entity. A property with a defined value can still have the null
value; it can represent a grouping of null values, or an aggregation that
results in a null value.</p>

<p class="MsoCaption">Example 33:<span class="Datatype">Product</span> has been
aggregated away, causing an empty result</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount with sum as Total)</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&amp;$filter=isdefined(Product)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": []</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016590"></a><a name="_Toc432754699"></a><a name="_Toc376977453"></a><a name="_Toc362428738"></a><a name="_Evaluating_$apply"></a>3.16 Evaluating <span class="Datatype">$apply</span></h2>

<p class="MsoNormal">The new system query option <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a> is evaluated first, then
the other system query options are evaluated, if applicable, on the result of <span class="Datatype">$apply</span> in their normal order (see <b>[</b><b><span class="Refterm">OData-Protocol</span></b><b>, section 11.2.1]</b>). If the result is a
collection, <span class="Datatype">$filter</span>, <span class="Datatype">$orderby</span>,
<span class="Datatype">$expand</span> and <span class="Datatype">$select</span>
work as usual on properties that are defined on the output set after evaluating
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a>.
</p>

<p class="MsoNormal">Properties that have been aggregated away in a result entity
are not represented, even if the properties are listed in <span class="Datatype">$select</span>
or <span class="Datatype">$expand</span>. In <span class="Datatype">$filter</span>
they are treated as having the null value, and in <span class="Datatype">$orderby</span>
as having a value that is even lower than null, i.e. instances for which a
property has been rolled up appear before instances that have a null value for
that property when ordering ascending.</p>

<p class="MsoNormal">On resource paths ending in <span class="Datatype">/$count</span>
the system query option <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a>
is evaluated on the set identified by the resource path without the <span class="Datatype">/$count</span> segment, the result is the plain-text number of
items in the result of <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a>.
This is similar to the combination of <span class="Datatype">/$count</span> and <span class="Datatype">$filter</span>.</p>

<p class="MsoNormal">The $count system query option is evaluated after <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a>,
the annotation <span class="Datatype">@odata.count</span> contains the number of
items in the result of <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a>.</p>

<p class="MsoNormal">Providers MAY support <span class="Datatype">$count</span>, <span class="Datatype">$top</span> and <span class="Datatype">$skip</span> together with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Grouping_with_rollup"><span style="font-family:&quot;Courier New&quot;">rollup</span></a>,
in which case rollup instances are counted identically to detail instances,
i.e. <span class="Datatype">$skip=5</span> skips the first five instances,
independently of whether some of them are rollup entities.</p>

<p class="MsoNormal">If a provider cannot satisfy a request using <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a>,
it MUST respond with <span class="Datatype">501 Not Implemented</span> and a
human-readable error message.</p>

<h2><a name="_Toc435016591"></a><a name="_Toc432754700">3.17 Evaluating </a><span class="Datatype">$apply</span> as an Expand Option</h2>

<p class="MsoNormal">The new system query option <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc337566368"><span style="font-family:&quot;Courier New&quot;">$apply</span></a> can be used as an expand
option to inline the result of aggregating related entities. The rules for <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Evaluating_$apply">evaluating <span style="font-family:&quot;Courier New&quot;">$apply</span></a>
are applied in the context of the expanded navigation, i.e. <span class="Datatype">$apply</span> is evaluated first, and other expand options on
the same navigation property are evaluated on the result of <span class="Datatype">$apply</span>.</p>

<p class="MsoCaption">Example 34: products with aggregated sales:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
Products?$expand=Sales($apply=aggregate(Amount with sum as Total))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":"$metadata#Poducts(Salees(Amount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "Name": "Coffee", "Color":
"Brown", "TaxRate": 0.06, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "@odata.id": null, "Total": &nbsp;&nbsp;12 } ]
},<br>
&nbsp; &nbsp;&nbsp;{ "Name": "Paper", &nbsp;"Color":
"White", "TaxRate": 0.</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">14 &nbsp;&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "@odata.id": null, "Total": &nbsp;&nbsp;&nbsp;8 } ]
},<br>
&nbsp; &nbsp;&nbsp;{ "Name": "Pencil", "Color":
"Black", "TaxRate": 0.14, &nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "@odata.id": null, "Total": null } ]
},<br>
&nbsp; &nbsp;&nbsp;{ "Name": "Sugar", &nbsp;"Color":
"White", "TaxRate": 0.06, &nbsp;&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "@odata.id": null, "Total": &nbsp;&nbsp;&nbsp;4 } ]
}<br>
&nbsp; ]&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016592"></a><a name="_Toc432754701"></a><a name="_Toc376977454"></a><a name="_Toc362428739"></a><a name="_Toc354668963"></a><a name="_Toc354070197"></a><a name="_Toc354059086"></a><a name="_Toc353983395">3.18
ABNF for Extended URL Conventions</a></h2>

<p class="MsoNormal">The normative ABNF construction rules for this specification
are defined in <span class="Refterm">[OData-Agg-ABNF]</span>. They incrementally
extend the rules defined in <span class="Refterm">[OData-ABNF]</span>.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016593"></a><a name="_Toc432754702"></a><a name="_Toc376977455"></a><a name="_Toc362428740"></a><a name="_Ref357764460"></a><a name="_Ref355775506"></a><a name="_Toc354668964"></a><a name="_Toc354070198"></a><a name="_Toc354059087"></a><a name="_Toc353983396"></a><a name="_Ref353973928"></a><a name="_Toc353453206"></a><a name="_Toc353390984"></a><a name="_Toc353377482"></a><a name="_Ref353365896"></a><a name="_Ref353365886"></a><a name="_Ref353365660"></a><a name="_Ref353365606"></a><a name="_Toc353294884"></a><a name="_Toc353294832"></a><a name="_Toc356208117"></a><a name="_Toc356223264"></a><a name="_Toc357758610"></a><a name="_Toc357762888"></a><a name="_Toc357764554"></a><a name="_Toc361047171"></a><a name="_Toc361237377"></a><a name="_Toc361237470"></a><a name="_Toc361260091"></a><a name="_Toc361332248"></a><a name="_Toc356208118"></a><a name="_Toc356223265"></a><a name="_Toc357758611"></a><a name="_Toc357762889"></a><a name="_Toc357764555"></a><a name="_Toc361047172"></a><a name="_Toc361237378"></a><a name="_Toc361237471"></a><a name="_Toc361260092"></a><a name="_Toc361332249"></a><a name="_Toc356208119"></a><a name="_Toc356223266"></a><a name="_Toc357758612"></a><a name="_Toc357762890"></a><a name="_Toc357764556"></a><a name="_Toc361047173"></a><a name="_Toc361237379"></a><a name="_Toc361237472"></a><a name="_Toc361260093"></a><a name="_Toc361332250"></a><a name="_Toc356208120"></a><a name="_Toc356223267"></a><a name="_Toc357758613"></a><a name="_Toc357762891"></a><a name="_Toc357764557"></a><a name="_Toc361047174"></a><a name="_Toc361237380"></a><a name="_Toc361237473"></a><a name="_Toc361260094"></a><a name="_Toc361332251"></a><a name="_Toc356208121"></a><a name="_Toc356223268"></a><a name="_Toc357758614"></a><a name="_Toc357762892"></a><a name="_Toc357764558"></a><a name="_Toc361047175"></a><a name="_Toc361237381"></a><a name="_Toc361237474"></a><a name="_Toc361260095"></a><a name="_Toc361332252"></a><a name="_Toc356208122"></a><a name="_Toc356223269"></a><a name="_Toc357758615"></a><a name="_Toc357762893"></a><a name="_Toc357764559"></a><a name="_Toc361047176"></a><a name="_Toc361237382"></a><a name="_Toc361237475"></a><a name="_Toc361260096"></a><a name="_Toc361332253"></a><a name="_Toc356208123"></a><a name="_Toc356223270"></a><a name="_Toc357758616"></a><a name="_Toc357762894"></a><a name="_Toc357764560"></a><a name="_Toc361047177"></a><a name="_Toc361237383"></a><a name="_Toc361237476"></a><a name="_Toc361260097"></a><a name="_Toc361332254"></a><a name="_Toc340159272"></a><a name="_Toc340007127"></a><a name="_Toc340051417"></a><a name="_Toc340159273"></a><a name="_Toc337733355"></a><a name="_Toc338080815"></a><a name="_Toc338838106"></a><a name="_Toc338852942"></a><a name="_Toc337733358"></a><a name="_Toc338080818"></a><a name="_Toc338838109"></a><a name="_Toc338852945"></a><a name="_Toc337733360"></a><a name="_Toc338080820"></a><a name="_Toc338838111"></a><a name="_Toc338852947"></a><a name="_Toc337733361"></a><a name="_Toc338080821"></a><a name="_Toc338838112"></a><a name="_Toc338852948"></a><a name="_Toc337733363"></a><a name="_Toc338080823"></a><a name="_Toc338838114"></a><a name="_Toc338852950"></a><a name="_Toc337732519"></a><a name="_Toc337733365"></a><a name="_Toc338080825"></a><a name="_Toc338838116"></a><a name="_Toc338852952"></a><a name="_Toc337732520"></a><a name="_Toc337733366"></a><a name="_Toc338080826"></a><a name="_Toc338838117"></a><a name="_Toc338852953"></a><a name="_Toc337732521"></a><a name="_Toc337733367"></a><a name="_Toc338080827"></a><a name="_Toc338838118"></a><a name="_Toc338852954"></a><a name="_Toc337732522"></a><a name="_Toc337733368"></a><a name="_Toc338080828"></a><a name="_Toc338838119"></a><a name="_Toc338852955"></a><a name="_Toc337732523"></a><a name="_Toc337733369"></a><a name="_Toc338080829"></a><a name="_Toc338838120"></a><a name="_Toc338852956"></a><a name="_Toc337732524"></a><a name="_Toc337733370"></a><a name="_Toc338080830"></a><a name="_Toc338838121"></a><a name="_Toc338852957"></a><a name="_Identifying_Aggregated_Entities"></a><a name="_Toc356208124"></a><a name="_Toc356223271"></a><a name="_Toc357758617"></a><a name="_Toc357762895"></a><a name="_Toc357764561"></a><a name="_Toc361047178"></a><a name="_Toc361237384"></a><a name="_Toc361237477"></a><a name="_Toc361260098"></a><a name="_Toc361332255"></a><a name="_Identifying_Aggregated_Entities_1"></a>4<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Representation
of Aggregated Instances</h1>

</div>

<p class="MsoNormal">Aggregated instances are based on the structure of the individual
instances from which they have been calculated, so the structure of the results
fits into the data model of the service. </p>

<p class="MsoNormal">Properties that have been aggregated away are not
represented at all in the aggregated instances.</p>

<p class="MsoNormal">Dynamic properties introduced through an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Keyword_as_2">alias</a> or with custom aggregates are represented as
defined by the response format.</p>

<p class="MsoNormal">Aggregated instances are logically instances of the declared
type of the collection identified by the resource path of the request. If the
resource path identifies a collection of entities, the aggregated instances are
also entities. These aggregated entities can be transient or persistent.
Transient entities dont possess an edit link or read link, and in the JSON
representation are marked with <span class="Datatype">"@odata.id": null</span>,
see <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#ODataJSONRef"><b><span style="color:black">[OData-JSON]</span></b></a>.
Edit links or read links of persistent entities MUST encode the necessary
information to re-retrieve that particular aggregate value. How the necessary
information is exactly encoded is not part of this specification. Only the
boundary conditions defined in <b>[</b><span class="Refterm">OData-Protocol</span><b>]</b>,
sections 4.1 and 4.2 MUST be met.</p>

<p class="MsoCaption">Example 35: looking again to the sample request for getting
sales amounts per product and country presented in section 3.10.1 (Example 24):</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Country,Product/Name),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
aggregate(Amount with sum as Total))</p>

</div>

<p class="MsoCaption">will return corresponding metadata as shown here for a
single transient aggregated entity:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":"$metadata#Sales(Customer(Country),Product(Name),Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": <span class="Datatype">null,</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Customer": { "Country": "Netherlands" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Product": { "Name": "Paper" }, <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Total": 3 </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
},<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016594"></a><a name="_Toc432754703"></a><a name="_Toc376977456"></a><a name="_Toc362428741"></a><a name="_Toc354668965"></a><a name="_Toc354070199"></a><a name="_Toc354059088"></a><a name="_Toc353983397"></a><a name="_Ref353967115"></a><a name="_Toc353453207"></a><a name="_Toc353390985"></a><a name="_Toc353377483"></a><a name="_Toc353294885"></a><a name="_Toc353294833"></a><a name="_Cross-Joins_and_Aggregation"></a>5<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Cross-Joins and Aggregation</h1>

</div>

<p class="MsoNormal">OData supports querying related entities through defining
navigation properties in the data model. These navigation paths help guide
simple consumers in understanding and navigating relationships.</p>

<p class="MsoNormal">In some cases, however, requests need to span entity sets
with no predefined associations. Such requests can be sent to the special
resource <span class="Datatype">$crossjoin</span> instead of an individual entity
set. The cross join of a list of entity sets is the Cartesian product of the
listed entity sets, represented as a collection of complex type instances that
have a navigation property with cardinality to-one for each participating entity
set, and queries across entity sets can be formulated using these navigation
properties. See <span class="Refterm">[OData-URL]</span> for details.</p>

<p class="MsoNormal">Where useful navigations exist it is beneficial to expose
those as explicit navigation properties in the model, but the ability to pose
queries that span entity sets not related by an association provides a mechanism
for advanced consumers to use more flexible join conditions.</p>

<p class="MsoCaption">Example 36: if Sales had a string property ProductID
instead of the navigation property Product, a join between Sales and Products
could be accessed via the <span class="Datatype">$crossjoin</span> resource</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/$crossjoin(Products,Sales)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ?$expand=Products($select=Name),Sales($select=Amount)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;$filter=Products/ID eq Sales/ProductID</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Collection(Edm.ComplexType)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; { "Products": { "Name": "Paper" },
"Sales": { "Amount": 1 } }, <br>
&nbsp;&nbsp;&nbsp; { "Products": { "Name": "Sugar" },
"Sales": { "Amount": 2 } },<br>
&nbsp;&nbsp;&nbsp; ...</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 37: using the <span class="Datatype">$crossjoin</span>
resource for aggregate queries</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/$crossjoin(Products,Sales)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; ?$apply=filter(Products/ID eq Sales/ProductID)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((Products/Name),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
aggregate(Sales(Amount with sum as Total)))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Collection(Edm.ComplexType)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; { "Products": { "Name": "Coffee" },
"Sales": { "Total": 12 } },<br>
&nbsp;&nbsp;&nbsp; { "Products": { "Name": "Paper"&nbsp; },
"Sales": { "Total":&nbsp; 8 } },<br>
&nbsp;&nbsp;&nbsp; { "Products": { "Name": "Sugar"&nbsp; },
"Sales": { "Total":&nbsp; 4 } }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">The entity container may be annotated in the same way as
entity sets to express which aggregate queries are supported, see section 6.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016595"></a><a name="_Toc432754704"></a><a name="_Toc376977457"></a><a name="_Toc362428742"></a><a name="_Toc354668966"></a><a name="_Toc354070200"></a><a name="_Toc354059089"></a><a name="_Toc353390986"></a><a name="_Toc353377484"></a><a name="_Toc353294886"></a><a name="_Toc353294834"></a><a name="_Toc337731808"></a><a name="_Ref337719112"></a><a name="_Ref337719096"></a><a name="_Toc353983398"></a><a name="_Toc353453208"></a><a name="_Vocabulary_for_Data"></a>6<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Vocabulary for Data Aggregation</h1>

</div>

<p class="MsoNormal">The following terms are defined in the vocabulary for data
aggregation <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#VocAggr"><b><span style="color:windowtext">[OData-</span></b><span style="color:windowtext"><b>VocAggr</b><b>].</b></span></a></p>

<h2><a name="_Toc435016596"></a><a name="_Toc432754705"></a><a name="_Toc376977458"></a><a name="_Aggregation_Capabilities"></a>6.1 Aggregation
Capabilities </h2>

<p class="MsoNormal">The term <span class="Datatype">ApplySupported</span> can be
applied to an entity container or to structured types and describes the
aggregation capabilities of the entity container or of collections of instances
of the annotated structured types. If present, it implies that instances of the
annotated structured type, or of structured types used in the annotated entity
container, can contain dynamic properties as an effect of <span class="Datatype">$apply</span>
even if they do not specify the <span class="Datatype">OpenType</span> attribute,
see <b>[</b><span class="Refterm">OData-CSDL</span><b>]</b>. The term has a
complex type with the following properties:</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><a name="_Toc353390987"></a><a name="_Toc353377485"></a><a name="_Toc353294887"></a><a name="_Toc353294835"></a><a name="_Ref353290823"></a><a name="_Toc337731809"></a><a name="_Toc339034386"></a><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class="Datatype">Transformations</span> collection lists
all supported set transformations. Allowed values are the names of the standard
transformations <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_aggregate_Transformation_1"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a>, <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_topcount_Transformation_1"><span style="font-family:&quot;Courier New&quot;">topcount</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_topsum_Transformation"><span style="font-family:&quot;Courier New&quot;">topsum</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_toppercent_Transformation"><span style="font-family:&quot;Courier New&quot;">toppercent</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_bottomcount_Transformation"><span style="font-family:&quot;Courier New&quot;">bottomcount</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_bottomsum_Transformation"><span style="font-family:&quot;Courier New&quot;">bottomsum</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_bottompercent_Transformation"><span style="font-family:&quot;Courier New&quot;">bottompercent</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_identity_Transformation"><span style="font-family:&quot;Courier New&quot;">identity</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_combine_Transformation"><span style="font-family:&quot;Courier New&quot;">concat</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:&quot;Courier New&quot;">groupby</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_filter_Transformation"><span style="font-family:&quot;Courier New&quot;">filter</span></a>,
and<span class="Datatype"> </span><a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_expand_Transformation"><span style="font-family:&quot;Courier New&quot;">expand</span></a>, or a namespace-qualified
name identifying a service-defined bindable function. If <span class="Datatype">Transformations</span>
is omitted the server supports all transformations defined by this
specification.</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class="Datatype">CustomAggregationMethods</span> collection
lists supported custom aggregation methods. Allowed values are
namespace-qualified names identifying service-specific aggregation methods. If omitted,
no custom aggregation methods are supported.</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">Rollup</span> specifies whether the service
supports no rollup, only a single rollup hierarchy, or multiple rollup
hierarchies in a <span class="Datatype">groupby</span> transformation. If
omitted, multiple rollup hierarchies are supported.</p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">PropertyRestrictions</span> specifies
whether all properties can be used in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:&quot;Courier New&quot;">groupby</span></a> and <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_aggregate_Transformation_1"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a>.
If not specified, or specified with a value of <span class="Datatype">false</span>,
all properties can be grouped and aggregated. If specified with a value of <span class="Datatype">true</span> clients have to check which properties are tagged as
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Groupable_Properties_1"><span style="font-family:&quot;Courier New&quot;">Groupable</span></a>
or <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Cross-Joins_and_Aggregation"><span style="font-family:&quot;Courier New&quot;">Aggregatable</span></a>.</p>

<p class="MsoNormal">All properties of <span class="Datatype">ApplySupported</span>
are optional, so it can be used as a tagging annotation to signal unlimited
support of aggregation.</p>

<p class="MsoCaption">Example 38: an entity container supporting everything
defined in this specification.</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;EntityContainer
Name="SalesData"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Annotation Term="Aggregation.ApplySupported" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ...</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;/EntityContainer&gt;</p>

</div>

<h2><a name="_Toc362428743"></a><a name="_Ref355776544"></a><a name="_Toc354668967"></a><a name="_Toc354070201"></a><a name="_Toc354059090"></a><a name="_Toc353983399"></a><a name="_Toc353453209"></a><a name="_Toc435016597"></a><a name="_Toc432754706"></a><a name="_Toc376977459"></a><a name="_Aggregatable_Properties"></a>6.2 Property Annotations</h2>

<h3><a name="_Toc435016598"></a><a name="_Toc432754707"></a><a name="_Toc376977460"></a><a name="_Groupable_Properties_1"></a>6.2.1 Groupable
Properties</h3>

<p class="MsoNormal">If a structured type is annotated with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Capabilities"><span style="font-family:&quot;Courier New&quot;">ApplySupported</span></a>
or used within an entity container that is annotated with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Capabilities"><span style="font-family:&quot;Courier New&quot;">ApplySupported</span></a>,
and the <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Capabilities"><span style="font-family:&quot;Courier New&quot;">ApplySupported</span></a>
annotation has a value of <span class="Datatype">true</span> for <span class="Datatype">PropertyRestrictions</span>, only those properties that are
annotated with the tagging term <span class="Datatype">Groupable</span> can be
used in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:&quot;Courier New&quot;">groupby</span></a>.</p>

<h3><a name="_Toc435016599"></a><a name="_Toc432754708"></a><a name="_Toc376977461"></a><a name="_Toc375242618"></a><a name="_Toc375310235"></a><a name="_Toc375225461"></a><a name="_Toc375225545"></a><a name="_Toc374645793"></a><a name="_Toc374961101"></a><a name="_Toc375063248"></a><a name="_Toc375063318"></a><a name="_Toc375136836"></a><a name="_Toc375136951"></a><a name="_Toc375225463"></a><a name="_Toc375225547"></a><a name="_Toc374645794"></a><a name="_Toc374961102"></a><a name="_Toc375063249"></a><a name="_Toc375063319"></a><a name="_Toc375136837"></a><a name="_Toc375136952"></a><a name="_Toc375225464"></a><a name="_Toc375225548"></a>6.2.2
Aggregatable Properties</h3>

<p class="MsoNormal">If a structured type is annotated with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Capabilities"><span style="font-family:&quot;Courier New&quot;">ApplySupported</span></a>
or used within an entity container that is annotated with <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Capabilities"><span style="font-family:&quot;Courier New&quot;">ApplySupported</span></a>,
and the <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregation_Capabilities"><span style="font-family:&quot;Courier New&quot;">ApplySupported</span></a>
annotation has a value of <span class="Datatype">true</span> for <span class="Datatype">PropertyRestrictions</span>, only those properties that are
annotated with the tagging term <span class="Datatype">Aggregatable</span> can be
used in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a>.</p>

<h3><a name="_Toc435016600"></a><a name="_Toc432754709"></a><a name="_Toc376977462"></a><a name="_Toc362428744"></a><a name="_Toc375242620"></a><a name="_Toc375310237"></a><a name="_Toc375225466"></a><a name="_Toc375225550"></a><a name="_Toc375225467"></a><a name="_Toc375225551"></a><a name="_Toc375225468"></a><a name="_Toc375225552"></a><a name="_Toc375136839"></a><a name="_Toc375136954"></a><a name="_Toc375225469"></a><a name="_Toc375225553"></a><a name="_Toc375136840"></a><a name="_Toc375136955"></a><a name="_Toc375225470"></a><a name="_Toc375225554"></a><a name="_Toc375136841"></a><a name="_Toc375136956"></a><a name="_Toc375225471"></a><a name="_Toc375225555"></a><a name="_Toc374645796"></a><a name="_Toc374961104"></a><a name="_Toc375063251"></a><a name="_Toc375063321"></a><a name="_Toc375136842"></a><a name="_Toc375136957"></a><a name="_Toc375225472"></a><a name="_Toc375225556"></a><a name="_Toc374610398"></a><a name="_Toc374610937"></a><a name="_Toc374621136"></a><a name="_Toc374626143"></a><a name="_Toc374626264"></a><a name="_Toc374610399"></a><a name="_Toc374610938"></a><a name="_Toc374621137"></a><a name="_Toc374626144"></a><a name="_Toc374626265"></a><a name="_Toc374610400"></a><a name="_Toc374610939"></a><a name="_Toc374621138"></a><a name="_Toc374626145"></a><a name="_Toc374626266"></a><a name="_Toc374610401"></a><a name="_Toc374610940"></a><a name="_Toc374621139"></a><a name="_Toc374626146"></a><a name="_Toc374626267"></a><a name="_Toc374610402"></a><a name="_Toc374610941"></a><a name="_Toc374621140"></a><a name="_Toc374626147"></a><a name="_Toc374626268"></a><a name="_Toc374610403"></a><a name="_Toc374610942"></a><a name="_Toc374621141"></a><a name="_Toc374626148"></a><a name="_Toc374626269"></a><a name="_Toc374610404"></a><a name="_Toc374610943"></a><a name="_Toc374621142"></a><a name="_Toc374626149"></a><a name="_Toc374626270"></a><a name="_Toc362341149"></a><a name="_Toc362342851"></a><a name="_Dynamic_Aggregatable_Properties"></a><a name="_Custom_Aggregates"></a><a name="_Custom_Dynamic_Aggregatable"></a><a name="_Custom_Aggregation_Methods"></a><a name="_Toc374645798"></a><a name="_Toc374961106"></a><a name="_Toc375063253"></a><a name="_Toc375063323"></a><a name="_Toc375136844"></a><a name="_Toc375136958"></a><a name="_Toc375225473"></a><a name="_Toc375225557"></a><a name="_Toc374645799"></a><a name="_Toc374961107"></a><a name="_Toc375063254"></a><a name="_Toc375063324"></a><a name="_Toc375136845"></a><a name="_Toc375136959"></a><a name="_Toc375225474"></a><a name="_Toc375225558"></a><a name="_Toc374645800"></a><a name="_Toc375063255"></a><a name="_Toc375063325"></a><a name="_Toc375136846"></a><a name="_Toc375136960"></a><a name="_Toc375225475"></a><a name="_Toc375225559"></a><a name="_Custom_Dynamic_Aggregatable_1"></a><a name="_Custom_AggregatesDynamic_Aggregatab"></a>6.2.3 Custom Aggregates</h3>

<p class="MsoNormal">The term <span class="Datatype">CustomAggregate</span> allows
defining dynamic properties that can be used in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_groupby_Transformation_1"><span style="font-family:&quot;Courier New&quot;">aggregate</span></a>.
No assumptions can be made on how the values of these custom aggregates are
calculated, and which input values are used.</p>

<p class="MsoNormal">When applied to a structured type, the annotation specifies
custom aggregates that are available for collections of instances of that
structured type. When applied to an entity container, the annotation specifies
custom aggregates whose input set may span multiple entity sets within the
container.</p>

<p class="MsoNormal">A custom aggregate is identified by the value of the <span class="Datatype">Qualifier</span> attribute when applying the term. The value of
the <span class="Datatype">Qualifier</span> attribute is the name of the dynamic
property. The name MUST NOT collide with the names of other custom aggregates
of the same model element. </p>

<p class="MsoNormal">The value of the annotation is a string with the qualified
name of a primitive type or type definition in scope that specifies the type
returned by the custom aggregate. </p>

<p class="MsoNormal">If the custom aggregate is associated with a structured type,
the value of the <span class="Datatype">Qualifier</span> attribute MAY be
identical to the name of a declared property of the structured type. In this
case, the value of the annotation MUST have the same value as the <span class="Datatype">Type</span> attribute of the declared property. This is typically
done when the custom aggregate is used as a default aggregate for that
property. In this case, the name refers to the custom aggregate within an
aggregate expression without a <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Toc361047145"><span style="font-family:
&quot;Courier New&quot;">with</span></a> clause, and to the property in all other cases.</p>

<p class="MsoNormal">If the custom aggregate is associated with an entity
container, the value of the <span class="Datatype">Qualifier</span> attribute
MUST NOT collide with the names of any entity sets defined in the entity
container.</p>

<p class="MsoCaption">Example 39: Sales forecasts are modeled as a custom
aggregate of the Sales entity type because it belongs there. For the budget,
there is no appropriate structured type, so it is modeled as a custom aggregate
of the <span class="Datatype">SalesData</span> entity container.</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;Annotations
Target="SalesModel.Sales"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Annotation Term="Aggregation.CustomAggregate"
Qualifier="Forecast"</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String="Edm.Decimal"
/&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;/Annotations&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;Annotations
Target="SalesModel.SalesData"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Annotation Term="Aggregation.CustomAggregate"
Qualifier="Budget"</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;String="Edm.Decimal"
/&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;/Annotations&gt;</p>

</div>

<p class="MsoCaption">These custom aggregates can be used in the <span class="Datatype">aggregate</span> transformation:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Time/Month),aggregate(Forecast))</p>

</div>

<p class="MsoCaption">and:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/$crossjoin(Time)?$apply=groupby((Time/Year),aggregate(Budget))</p>

</div>

<h3><a name="_Toc362428746"></a><a name="_Toc354668969"></a><a name="_Toc354070203"></a><a name="_Toc354059092"></a><a name="_Toc353983401"></a><a name="_Toc353453211"></a><a name="_Toc353390989"></a><a name="_Toc353377487"></a><a name="_Toc353294889"></a><a name="_Toc353294837"></a><a name="_Toc337731811"></a><a name="_Ref337728174"></a><a name="_Toc435016601"></a><a name="_Toc432754710"></a><a name="_Toc376977463"></a><a name="_Toc361944707"></a><a name="_Toc361944708"></a><a name="_Groupable_Properties"></a><a name="_Toc339034389"></a><a name="_Toc339034398"></a><a name="_Hierarchies"></a>6.2.4 Context-Defining
Properties</h3>

<p class="MsoNormal">Sometimes the value of a property or custom aggregate is
only well-defined within the context given by values of other properties, e.g. a
postal code together with its country, or a monetary amount together with its currency
unit. These context-defining properties can be listed with the term <span class="Datatype">ContextDefiningProperties</span> whose type is a collection of
property paths.</p>

<p class="MsoNormal">If present, the context-defining properties SHOULD be used
as grouping properties when aggregating the annotated property or custom
aggregate, or alternatively be restricted to a single value by a pre-filter
operation. Services MAY respond with <span class="Datatype">400 Bad Request</span>
if the context-defining properties are not sufficiently specified for
calculating a meaningful aggregate value.</p>

<h3><a name="_Toc435016602"></a><a name="_Toc432754711"></a><a name="_Toc376977464">6.2.5 Example</a></h3>

<p class="MsoCaption">Example 40: This simplified <span class="Datatype">Sales</span>
entity type has a single aggregatable property <span class="Datatype">Amount</span>
whose context is defined by the <span class="Datatype">Code</span> property of
the related <span class="Datatype">Currency</span>, and a custom aggregate <span class="Datatype">Forecast</span> with the same context. The <span class="Datatype">Code</span>
property of <span class="Datatype">Currency</span> is groupable. All other
properties are neither groupable nor aggregatable.</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;EntityType
Name="Currency"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Key&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;PropertyRef Name="Code" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Key&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Property Name="Code" Type="Edm.String"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Annotation Term="Aggregation.Groupable" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Property&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Property Name="Name" Type="Edm.String"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Annotation Term="Core.IsLanguageDependent" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Property&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;/EntityType&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;EntityType
Name="Sales"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Key&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;PropertyRef Name="ID" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Key&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Property Name="ID" Type="Edm.String"
Nullable="false" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Property Name="Amount" Type="Edm.Decimal"
Scale="variable"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Annotation Term="Aggregation.Aggregateable" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Annotation Term="Aggregation.ContextDefiningProperties"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Collection&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&lt;PropertyPath&gt;Currency/Code&lt;/PropertyPath&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/Collection&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;/Annotation&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Property&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;NavigationProperty Name="Currency"
Type="SalesModel.Currency"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;Nullable="false"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Annotation Term="Aggregation.Groupable" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&lt;/NavigationProperty&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Annotation Term="Aggregation.CustomAggregate"
Qualifier="Forecast"</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
String="Edm.Decimal"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Annotation Term="Aggregation.ContextDefiningProperties"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;Collection&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;PropertyPath&gt;Currency/Code&lt;/PropertyPath&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;/Collection&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;/Annotation&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Annotation&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;/EntityType&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;EntityContainer
Name="SalesData"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;Annotation Term="Aggregation.ApplySupported"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;Record&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
&lt;PropertyValue Property="PropertyRestrictions"
Bool="true" /&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;/Record&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;/Annotation&gt;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;EntitySet Name="Sales" EntityType="SalesModel.Sales"
/&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
&lt;EntitySet Name="Currencies"
EntityType="SalesModel.Currency" /&gt; &lt;/EntityContainer&gt;</p>

</div>

<h2><a name="_Toc435016603"></a><a name="_Toc432754712"></a><a name="_Toc376977465"></a><a name="_Toc375225479"></a><a name="_Toc375225563"></a>6.3
Hierarchies</h2>

<p class="MsoNormal">A hierarchy is an arrangement of groupable properties whose
values are represented as being above, below, or at the same level as one
another. A hierarchy can be <i>leveled</i> or <i>recursive.</i></p>

<h3><a name="_Toc435016604"></a><a name="_Toc432754713"></a><a name="_Toc376977466"></a><a name="_Toc362428747"></a><a name="_Toc354668970"></a><a name="_Leveled_Hierarchy"></a>6.3.1 Leveled Hierarchy</h3>

<p class="MsoNormal" style="page-break-after:avoid">A <i>leveled hierarchy </i>has
a fixed number of levels each of which is represented by a groupable property.
The values of a lower-level property depend on the property value of the level
above. </p>

<p class="MsoNormal" style="page-break-after:avoid">A leveled hierarchy of an
entity type is described with the term <span class="Datatype">LeveledHierarchy</span>
that lists the properties used to form the hierarchy.</p>

<p class="MsoNormal">The order of the collection is significant: it lists the
properties representing the levels, starting with the root level (coarsest
granularity) down to the lowest level of the hierarchy.</p>

<p class="MsoNormal">The term <span class="Datatype">LeveledHierarchy</span> can
only be applied to entity types, and the applying <span class="Datatype">Annotation</span>
element MUST specify the <span class="Datatype">Qualifier</span> attribute. The
value of the <span class="Datatype">Qualifier</span> attribute can be used to reference
the hierarchy in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Grouping_with_rollup_1">grouping with rollup</a>.</p>

<h3><a name="_Toc435016605"></a><a name="_Toc432754714"></a><a name="_Toc376977467"></a><a name="_Toc362428748"></a><a name="_Toc354668971"></a><a name="_Ref354400993"></a><a name="_Recursive_Hierarchy"></a>6.3.2 Recursive
Hierarchy</h3>

<p class="MsoNormal">A <i>recursive hierarchy</i> organizes the values of a
single groupable property as nodes of a tree structure. This structure does not
need to be as uniform as a leveled hierarchy. It is described by a complex term
<span class="Datatype">RecursiveHierarchy</span> with the properties:</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class="Datatype">NodeProperty</span> contains the path to
the identifier of the node.</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class="Datatype">ParentNavigationProperty</span> allows
navigation to the entity representing the parent node.</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The optional <span class="Datatype">DistanceFromRootProperty</span>
contains the path to a property that contains the number of edges between the
node and the root node.</p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The optional <span class="Datatype">IsLeafProperty</span> contains
the path to a Boolean property that indicates whether the node is a leaf of the
hierarchy.</p>

<p class="MsoNormal">The term <span class="Datatype">RecursiveHierarchy</span> can
only be applied to entity types, and the applying <span class="Datatype">Annotation</span>
element MUST specify the <span class="Datatype">Qualifier</span> attribute. The
value of the <span class="Datatype">Qualifier</span> attribute can be used to
reference the hierarchy in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Hierarchy_Filter_Functions">Hierarchy
Filter Functions</a>.</p>

<h4><a name="_Toc432754715"></a><a name="_Toc376977468"></a><a name="_Toc362428749"></a><a name="_Toc354668972"></a><a name="_Query_Functions"></a><a name="_Hierarchy_Test_Functions"></a><a name="_Hierarchy_Filter_Functions"></a>6.3.2.1
Hierarchy Filter Functions</h4>

<p class="MsoNormal">For testing the position of a given entity instance in a
recursive hierarchy annotated to the entitys type, the Aggregation vocabulary defines
functions that can be applied to any entity in <span class="Datatype">$filter</span>
expressions:</p>

<p class="MsoListParagraphCxSpFirst" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">isroot</span> returns true if and only if
the value of the node property of the specified hierarchy is the root of the
hierarchy,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">isdescendant</span> returns true if and only
if the value of the node property of the specified hierarchy is a descendant of
the given parent node with a distance of less than or equal to the optionally
specified maximum distance,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">isancestor</span> returns true if and only
if the value of the node property of the specified hierarchy is an ancestor of
the given child node with a distance of less than or equal to the optionally
specified maximum distance,</p>

<p class="MsoListParagraphCxSpMiddle" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">issibling</span> returns true if and only if
the value of the node property of the specified hierarchy has the same parent
node as the specified node,</p>

<p class="MsoListParagraphCxSpLast" style="text-indent:-.25in"><span style="font-family:Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span><span class="Datatype">isleaf</span> returns true if and only if
the value of the node property of the specified hierarchy has no descendants.</p>

<h3 style="margin-right:-6.9pt"><a name="_Toc353983402"></a><a name="_Toc353453212"></a><a name="_Toc353390990"></a><a name="_Toc353377488"></a><a name="_Toc353294890"></a><a name="_Toc353294838"></a><a name="_Toc354070204"></a><a name="_Toc354059093"></a><a name="_Toc435016606"></a><a name="_Toc432754716"></a><a name="_Toc376977469"></a><a name="_Toc362428750"></a><a name="_Toc354668973"></a><a name="_Toc361944714"></a><a name="_Toc361944715"></a><a name="_Toc361944716"></a><a name="_Toc361944717"></a><a name="_Toc361944718"></a><a name="_Toc361944719"></a><a name="_Toc361944720"></a><a name="_Toc361944721"></a><a name="_Toc361944722"></a><a name="_Toc361944723"></a><a name="_Toc361944724"></a><a name="_Toc361944725"></a><a name="_Toc361944726"></a><a name="_Toc361944727"></a><a name="_Toc361944728"></a><a name="_Toc361944729"></a><a name="_Toc361944730"></a><a name="_Toc361944731"></a><a name="_Toc361944732"></a><a name="_Toc361944733"></a><a name="_Toc361944734"></a><a name="_Toc361944735"></a><a name="_Toc361944736"></a><a name="_Toc361944737"></a><a name="_Toc361047188"></a><a name="_Toc361237394"></a><a name="_Toc361237487"></a><a name="_Toc361260108"></a><a name="_Toc361332265"></a><a name="_Toc361047189"></a><a name="_Toc361237395"></a><a name="_Toc361237488"></a><a name="_Toc361260109"></a><a name="_Toc361332266"></a><a name="_Toc361047208"></a><a name="_Toc361237414"></a><a name="_Toc361237507"></a><a name="_Toc361260128"></a><a name="_Toc361332285"></a><a name="_Toc353480545"></a><a name="_Toc353801125"></a><a name="_Toc353801232"></a><a name="_Toc353875785"></a><a name="_Toc353878608"></a><a name="_Toc353881748"></a><a name="_Toc353956717"></a><a name="_Toc353980777"></a><a name="_Toc353980884"></a><a name="_Toc353981241"></a><a name="_Toc353981661"></a><a name="_Toc353981942"></a><a name="_Toc353983115"></a><a name="_Toc353983210"></a><a name="_Toc353984686"></a><a name="_Toc353480547"></a><a name="_Toc353801127"></a><a name="_Toc353801234"></a><a name="_Toc353875787"></a><a name="_Toc353878610"></a><a name="_Toc353881750"></a><a name="_Toc353956719"></a><a name="_Toc353980779"></a><a name="_Toc353980886"></a><a name="_Toc353981243"></a><a name="_Toc353981663"></a><a name="_Toc353981944"></a><a name="_Toc353983117"></a><a name="_Toc353983212"></a><a name="_Toc353984688"></a><a name="_Toc345683962"></a><a name="_Toc345683969"></a><a name="_Toc345683972"></a><a name="_Toc345683974"></a><a name="_Toc345683975"></a><a name="_Toc345683976"></a><a name="_Toc345683979"></a><a name="_Toc345683981"></a><a name="_Toc345683990"></a><a name="_Toc345684023"></a><a name="_Toc345684039"></a>6.3.3 Examples</h3>

<p class="MsoCaption">Example 41: leveled hierarchies for products and time, and
a recursive hierarchy for the sales organizations</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span style="color:black">&lt;edmx:Edmx xmlns:edmx="</span><a href="http://docs.oasis-open.org/odata/ns/edmx"><span style="color:black">http://docs.oasis-open.org/odata/ns/edmx</span></a><span style="color:black">"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Version="4.0"&gt;<br>
&nbsp;&lt;edmx:Reference Uri="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs01/vocabularies/Org.OData.Aggregation.V1.xml"&gt;<br>
&nbsp; &lt;edmx:Include Alias="Aggregation"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Namespace="Org.OData.Aggregation.V1" /&gt;<br>
&nbsp;&lt;/edmx:Reference&gt;</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span style="color:black">&nbsp;&lt;edmx:DataServices&gt;</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span style="color:black">&nbsp; &lt;Schema xmlns="</span><a href="http://docs.oasis-open.org/odata/ns/edm"><span style="color:black">http://docs.oasis-open.org/odata/ns/edm</span></a><span style="color:black">"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;Alias="SalesModel" Namespace="org.example.odata.salesservice"&gt;<br>
&nbsp;&nbsp; &lt;Annotations Target="SalesModel.Product"&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Annotation Term="Aggregation.LeveledHierarchy"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Qualifier="ProductHierarchy"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Collection&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span>PropertyPath<span style="color:black">&gt;Category/Name&lt;/</span>PropertyPath<span style="color:black">&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span>PropertyPath<span style="color:black">&gt;Name&lt;/</span>PropertyPath<span style="color:black">&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Collection&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/Annotation&gt;<br>
&nbsp;&nbsp; &lt;/Annotations&gt;<br>
<br>
</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span style="color:black">&nbsp;&nbsp; &lt;Annotations Target="SalesModel.Time"&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Annotation Term="Aggregation.LeveledHierarchy"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Qualifier="TimeHierarchy"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;Collection&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span>PropertyPath<span style="color:black">&gt;Year&lt;/</span>PropertyPath<span style="color:black">&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span>PropertyPath<span style="color:black">&gt;Quarter&lt;/</span>PropertyPath<span style="color:black">&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;</span>PropertyPath<span style="color:black">&gt;Month&lt;/</span>PropertyPath<span style="color:black">&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Collection&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/Annotation&gt;<br>
&nbsp;&nbsp; &lt;/Annotations&gt;<br>
<br>
</span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span style="color:black">&nbsp;&nbsp; &lt;Annotations Target="SalesModel.SalesOrganization"&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;Annotation Term="Aggregation.RecursiveHierarchy"<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Qualifier="SalesOrgHierarchy"&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;Record&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;PropertyValue Property="NodeProperty" <br>
</span>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; PropertyPath<span style="color:black">="ID"
/&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &lt;PropertyValue Property="ParentNavigationProperty" </span></p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9"><span style="color:black">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>PropertyPath<span style="color:black">="Superordinate" /&gt;<br>
&nbsp;&nbsp;&nbsp;&nbsp; &lt;/Record&gt;<br>
&nbsp;&nbsp;&nbsp; &lt;/Annotation&gt;<br>
&nbsp;&nbsp; &lt;/Annotations&gt;<br>
&nbsp; &lt;/Schema&gt;<br>
&nbsp;&lt;/edmx:DataServices&gt;<br>
&lt;/edmx:Edmx&gt;</span></p>

</div>

<p class="MsoCaption">The recursive hierarchy <span class="Datatype">SalesOrgHierarchy</span>
can be used in functions with the <span class="Datatype">$filter</span> system
query option.</p>

<p class="MsoCaption">Example 42: requesting all organizations below EMEA</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/SalesOrganizations?<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $filter=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $it/Aggregation.isdescendant(Hierarchy='SalesOrgHierarchy',Node='EMEA')</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#SalesOrganizations",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "ID": "EMEA Central",&nbsp;&nbsp;&nbsp;&nbsp; "Name":
"EMEA Central" },<br>
&nbsp;&nbsp;&nbsp; { "ID": "Sales Netherland", "Name":
"Sales Netherland" },<br>
&nbsp;&nbsp;&nbsp; { "ID": "Sales Germany",&nbsp;&nbsp;&nbsp; "Name":
"Sales Germany" },<br>
&nbsp;&nbsp;&nbsp; { "ID": "EMEA South",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Name":
"EMEA South" },<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp;&nbsp;&nbsp; { "ID": "EMEA North",&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Name":
"EMEA North" },<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 43: requesting just those organizations directly
below EMEA</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET SalesOrganizations?$filter=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $it/Aggregation.isdescendant(Hierarchy='SalesOrgHierarchy',<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Node='EMEA',MaxDistance=1)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#SalesOrganizations",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value":<span style="font-family:&quot;Calibri&quot;,&quot;sans-serif&quot;"> </span>[&nbsp;&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; { "ID": "EMEA Central", "Name": "EMEA
Central" },<br>
&nbsp;&nbsp;&nbsp; { "ID": "EMEA South",&nbsp;&nbsp; "Name": "EMEA
South" },<br>
&nbsp;&nbsp;&nbsp; { "ID": "EMEA North",&nbsp;&nbsp; "Name": "EMEA
North" },<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 44: just the lowest-level organizations</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET SalesOrganizations?$filter=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $it/Aggregation.isleaf(Hierarchy='SalesOrgHierarchy')</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#SalesOrganizations",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"value": [&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; { "ID": "Sales Office London",&nbsp;&nbsp; "Name":
"Sales Office London" },<br>
&nbsp;&nbsp; &nbsp;{ "ID": "Sales Office New York", "Name":
"Sales Office New York" },<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 45: the lowest-level organizations including their superordinate's
ID</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
SalesOrganizations?$filter=<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; $it/Aggregation.isleaf(Hierarchy='SalesOrgHierarchy')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;$expand=Superordinate($select=ID)</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#SalesOrganizations(*,Superordinate(ID))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; { "ID": "Sales Office London",&nbsp;&nbsp; "Name":
"Sales Office London", <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Superordinate: { "ID": "EMEA United Kingdom" }
},<br>
&nbsp;&nbsp;&nbsp; { "ID": "Sales Office New York", "Name":
"Sales Office New York", <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Superordinate: { "ID": "US East" } },<br>
&nbsp;&nbsp;&nbsp; ...<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 46: retrieving the sales IDs involving sales
organizations from EMEA can be requested by</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
Sales?$select=ID&amp;$filter=</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; SalesOrganization/Aggregation.isdescendant(Hierarchy='SalesOrgHierarchy',</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Node='EMEA')</p>

</div>

<p class="MsoCaption"><a name="_Toc354668974">results in</a></p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(ID)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [&nbsp;&nbsp;&nbsp; <br>
&nbsp;&nbsp;&nbsp; { "ID": 6 },<br>
&nbsp;&nbsp;&nbsp; { "ID": 7 },<br>
&nbsp;&nbsp;&nbsp; { "ID": 8 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016607"></a><a name="_Toc432754717"></a><a name="_Toc376977470"></a><a name="_Toc362428751">6.4 Actions and Functions on
Aggregated Entities</a> </h2>

<p class="MsoNormal">Bound actions and functions may or may not be applicable to
aggregated entities. By default such bindings are not applicable to aggregated
entities. Actions or functions annotated with the term <span class="Datatype">AvailableOnAggregates</span>
are applicable to (a subset of the) aggregated entities under specific
conditions:</p>

<p class="MsoListParagraph" style="text-indent:-.25in"><span style="font-family:
Symbol">·<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span></span>The <span class="Datatype">RequiredProperties</span> collection
lists all properties that must be available in the aggregated entities;
otherwise, the annotated function or action will be inapplicable. </p>

<p class="MsoCaption">Example 47: assume the product is an implicit input for a
function bindable to Sales, then aggregating away the product makes this
function inapplicable.</p>

<p class="MsoNormal">Calculating a set of aggregated entities and invoking an
action on them cannot be accomplished with a single request, because the action
URL cannot be constructed by the client. It is also impossible to construct a
URL that calculates a single aggregated entity and applies a function or action
on it. Consequently, applicable bound actions or functions on a single
aggregated entity, or bound actions on a collection of aggregated entities MUST
be advertised in the response to make them available to clients. A client is
then able to request the aggregated entities in a first request and invoke the
action or function in a follow-up request using the advertised target URL. </p>

<p class="MsoCaption">Example 48: full representation of an action applicable to
a collection of aggregated entities, and an action that is applicable to one of
the entities in the collection. The string <span class="Datatype">&lt;properties
in $apply&gt;</span> is a stand-in for the list of properties describing the
shape of the result set</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"@odata.context":
"$metadata#Sales(&lt;properties in $apply&gt;)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"@odata.readLink":
"http://.../aggregated-stuff2143248437259843",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"#Model.ColAction": {</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
"title": "Do something on this collection",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
"target":
"http://.../aggregated-stuff2143248437259843/Model.ColAction"</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"value": [ </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp; {</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp;&nbsp; "@odata.id":
"aggregated-stuff2143248437259843-1",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp;&nbsp; "#Model.SingleAction": {</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"title": "Do something on this entity",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"target": </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"http://.../aggregated-stuff2143248437259843-1/Model.SingleAction"</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
},</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp;&nbsp; ...</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp; },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp; ...</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc353390991"></a><a name="_Toc353377489"></a><a name="_Toc353294891"></a><a name="_Toc353294839"></a><a name="_Toc337731839"></a><a name="_Toc287332011"></a><a name="_Toc353453213">Services advertising the
availability of functions or actions via the term </a><span class="Datatype">AvailableOnAggregates</span>
MUST provide read links or edit links for aggregated entities, see section 4.<a name="_Rollup_Instances"></a></p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1 style="margin-left:21.55pt;text-indent:-21.55pt"><a name="_Toc435016608"></a><a name="_Toc432754718"></a><a name="_Toc376977471"></a><a name="_Toc362428752"></a><a name="_Toc354668975"></a><a name="_Toc354070205"></a><a name="_Toc354059094"></a><a name="_Toc353983403"></a><a name="_Toc375242630"></a><a name="_Toc375310247"></a><a name="_Toc375242631"></a><a name="_Toc375310248"></a><a name="_Toc375136855"></a><a name="_Toc375136969"></a><a name="_Toc375225487"></a><a name="_Toc375225571"></a>7<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; </span>Examples</h1>

</div>

<p class="MsoNormal">The following examples show some common aggregation-related
questions that can be answered by combining the transformations defined in
chapter 3.</p>

<h2><a name="_Toc435016609"></a><a name="_Toc432754719"></a><a name="_Toc376977472"></a><a name="_Toc362428753"></a><a name="_Toc354668976"></a><a name="_Toc354070206"></a><a name="_Toc354059095"></a><a name="_Toc353983404"></a><a name="_Toc353453214">7.1 Distinct Values</a></h2>

<p class="MsoNormal">Grouping without specifying a set transformation returns the
distinct combination of the grouping properties.</p>

<p class="MsoCaption">Example 49:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Customers?$apply=groupby((Name))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Customers(Name)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Name": "Luc" },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Name": "Joe" },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Name": "Sue" }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Note that "Sue" appears only once although the
customer base contains two different Sues. </p>

<p class="MsoNormal">Aggregation is also possible across related entities. </p>

<p class="MsoCaption">Example 50: customers that bought something</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Name))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Name))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Joe" } },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Sue" } }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">The result has the same structure as a standard OData
request that expands the navigation properties and selects the data properties
specified in <span class="Datatype">groupby</span> and <span class="Datatype">aggregate</span>.</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?<span class="Datatype">$expand=Customer($select=Name)</span> </p>

</div>

<p class="MsoCaption">Note that "Luc" does not appear in the aggregated
result as he hasnt bought anything and therefore there are no sales entities
that refer/navigate to Luc.</p>

<p class="MsoCaption">However, even though both Sues bought products, only one
"Sue" appears in the aggregate result. Including properties that
guarantee the right level of uniqueness in the grouping can repair that.</p>

<p class="MsoCaption">Example 51:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Name,Customer/ID))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Name,ID))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Joe", "ID": "C1" } },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Sue", "ID": "C2" } },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Name":
"Sue", "ID": "C3" } }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">This could also have been formulated as</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">GET ~/Sales?$apply=groupby((Customer))</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;$expand=Customer($select=Name,ID)</p>

</div>

<p class="MsoNormal">Grouping by a navigation property adds the deferred
representation of the navigation property to the result structure, which then
can be expanded and projected partially away using the standard query options <span class="Datatype">$expand</span> and <span class="Datatype">$select</span>.</p>

<p class="MsoNormal">Note: the typical representation of a deferred navigation
property is a URL relative to the source entity, e.g. <span class="Datatype">~/Sales(1)/Customer</span>.
This has the benefit that this URL doesnt change if the sales entity would be
associated to a different customer. For aggregated entities this would actually
be a drawback, so the representation MUST be the canonical URL of the target
entity, i.e. <span class="Datatype">~/Customers('C1')</span> for the first entity
in the above result.</p>

<p class="MsoCaption">Example 52: the first question in the motivating example in
section 2.4, which customers bought which products, can now be expressed as</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~Sales?$apply=groupby((Customer/Name,Customer/ID,Product/Name))</p>

</div>

<p class="MsoNormal" style="margin-right:-6.9pt">and results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Name,ID),Product(Name))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Joe", "ID": "C1" }, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Coffee"} },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Joe", "ID": "C1" }, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Paper" } },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Joe", "ID": "C1" },&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product: { "Name: "Sugar" } },<br>
&nbsp;&nbsp;&nbsp; { "@odata.id": null, "Customer": { "Name":
"Sue", "ID": "C2" },&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product: { "Name": "Coffee"} },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Name":
"Sue", "ID": "C2" },&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Paper" } },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Name": "Sue",
"ID": "C3" },&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Paper" } },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; {
"@odata.id": null, "Customer": { "Name":
"Sue", "ID": "C3" },&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Sugar" } }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016610"></a><a name="_Toc432754720"></a><a name="_Toc376977473">7.2 Aggregation Methods</a> </h2>

<p class="MsoNormal">The client may specify one of the predefined aggregation
methods <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Standard_Aggregation"><span style="font-family:&quot;Courier New&quot;">min</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method_1"><span style="font-family:&quot;Courier New&quot;">max</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_Standard_Aggregation_1"><span style="font-family:&quot;Courier New&quot;">sum</span></a>,
<a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method_2"><span style="font-family:&quot;Courier New&quot;">average</span></a>,
and <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Standard_Aggregation_Method"><span style="font-family:&quot;Courier New&quot;">countdistinct</span></a>,
or a <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Aggregation_Methods_1">custom aggregation method</a>, to
aggregate an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Aggregatable_Properties">aggregatable property</a>.
Expressions defining an aggregate method MUST specify an <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Keyword_as_2">alias</a>. The aggregated values are returned in a
dynamic property whose name is determined by the alias.</p>

<p class="MsoCaption">Example 53:&nbsp; </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET ~/Products?$apply=groupby((Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Sales/Amount with sum as Total))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,Sales(Total))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Coffee", "Sales":
[ { "Total": &nbsp;&nbsp;12 } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Paper",&nbsp; "Sales":
[ { "Total": &nbsp;&nbsp;&nbsp;8 } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Pencil", "Sales":
[ { "Total": null } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Sugar",&nbsp; "Sales":
[ { "Total":&nbsp; &nbsp;&nbsp;4 } ] }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Note that the base set of the request is <span class="Datatype">Products</span>, so there is a result item for product <span class="Datatype">Pencil</span> even though there are no sales item. As <span class="Datatype">aggregate</span> returns exactly one result item even if there
are no items to be aggregated, the <span class="Datatype">Sales</span> navigation
propertys value is an array with one element representing the sum over no
input values, which is <span class="Datatype">null</span>.</p>

<p class="MsoCaption">Example 54: careful observers will notice that the above
amounts have been aggregated across currencies, which is semantically wrong.
Yet it is the correct response to the question asked, so be careful what you
ask for. The semantically meaningful question</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">GET ~/Products?$apply=groupby((Name,Sales/Currency/Code),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Sales/Amount with sum as Total))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,Sales(Total,Currency(Code)))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Coffee", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "Total": 12, "Currency": { "Code":
"USD" } } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name: "Paper",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Sales":
[ { "Total":&nbsp; 3, "Currency": { "Code":
"EUR" } },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;{ "Total":&nbsp; 5, "Currency": { "Code":
"USD" } } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name: "Pencil", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name: "Sugar",&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; "Sales": [ { "Total":&nbsp; 2, "Currency": { "Code":
"EUR" } },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; { "Total":&nbsp; 2, "Currency": { "Code":
"USD" } } ] }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal" style="page-break-after:avoid">Note that navigation
properties are "expanded" in a left-outer-join fashion, starting from
the target of the aggregation request, before grouping the entities for
aggregation. Afterwards the results are folded back to match the cardinality
of the navigation properties.</p>

<p class="MsoCaption">Example 55:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Customers?$apply=groupby((Country,Sales/Product/Name))</p>

</div>

<p class="MsoCaption">returns the different products sold per country:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Customers(Country,Sales(Product(Name)))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Country":
"Netherlands", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "Product": { "Name":
"Paper"&nbsp; },<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "Product": { "Name": "Sugar"&nbsp;
} ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Country": "USA",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"Sales":
[ { "Product": { "Name": "Coffee" },<br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "Product": { "Name": "Paper"&nbsp;
},<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;{ "Product": { "Name": "Sugar"&nbsp;
} ] }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 56:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Country),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
aggregate(Amount with average as AverageAmount))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Country),AverageAmount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp;&nbsp; &nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" }, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"AverageAmount": 1.6666667 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"AverageAmount": 3.8 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">If the example model would contain a list of hobbies per
customer, with Hobbies a collection of strings, the number of different hobbies
across the customer base could be requested. A navigation property followed by
a <span class="Datatype">/$count</span> segment is a valid expression in the
context that declares the navigation property, so the result property is placed
in the same context as the navigation property.</p>

<p class="MsoCaption">Example 57:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Products?$apply=groupby((Name),aggregate(Sales/$count as SalesCount))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,SalesCount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Coffee", "SalesCount":
2 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Paper",&nbsp; "SalesCount":
4 },<br>
&nbsp;&nbsp; &nbsp;{ "@odata.id": null, "Name": "Pencil", "SalesCount":
0 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Sugar",&nbsp; "SalesCount":
2 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">Note that this differs from the placement of an aggregated
property in a related entity: the aggregated property has the same navigation
path as the original value. </p>

<p class="MsoCaption">Example 58: the result properties for Sales/$count and
Sales(Amount) are placed differently</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Products?$apply=groupby((Name),aggregate(Sales/$count as SalesCount,</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Sales(Amount with sum as TotalAmount)))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,SalesCount,Sales(TotalAmount))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Coffee", "SalesCount":
2,</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "TotalAmount": 12 } ] },<br>
&nbsp;&nbsp; &nbsp;{ "@odata.id": null, "Name": "Paper",&nbsp; "SalesCount":
4,<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Sales": [ { "TotalAmount":&nbsp; 8 } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Pencil", "SalesCount":
0,<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Sales": [ { "TotalAmount": null } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Sugar",&nbsp; "SalesCount":
2,</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Sales":
[ { "TotalAmount":&nbsp; 4 } ] }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal"><a name="_Toc362428756"></a><a name="_Toc354668979"></a><a name="_Toc354070209"></a><a name="_Toc354059098"></a><a name="_Toc353983407"></a><a name="_Toc353453218"></a><a name="_Custom_Aggregates_1"></a>To place the number
of instances in a group next to other aggregated values, the virtual property <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Virtual_Property_$count"><span style="font-family:&quot;Courier New&quot;">$count</span></a>
can be used: </p>

<p class="MsoCaption">Example 59: the result properties for Sales/$count and
Sales/Amount are placed differently</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Products?$apply=groupby((Name),aggregate(Sales($count as SalesCount),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Sales(Amount with sum as TotalAmount)))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,Sales(SalesCount,TotalAmount))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Coffee", </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Sales": [ { "SalesCount": 2, "TotalAmount": 12 }
] },<br>
&nbsp;&nbsp; &nbsp;{ "@odata.id": null, "Name": "Paper",&nbsp; <br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Sales": [ { "SalesCount": 4, "TotalAmount":&nbsp;
8 } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Pencil", <br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Sales": [ { "SalesCount": 0, "TotalAmount":&nbsp;
null } ] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Name": "Sugar",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Sales":
[ { "SalesCount": 2, "TotalAmount":&nbsp; 4 } ] }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016611"></a><a name="_Toc432754721"></a><a name="_Toc376977474">7.3 Custom Aggregates</a></h2>

<p class="MsoNormal">Custom aggregates are defined through the <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Dynamic_Aggregatable_1"><span style="font-family:&quot;Courier New&quot;">CustomAggregate</span></a>
annotation. They can be associated with either an entity type or an entity
container. </p>

<p class="MsoNormal">A <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Dynamic_Aggregatable">custom aggregate</a>
can be used by specifying the name of the custom aggregate in the <span class="Datatype">aggregate</span> clause.</p>

<p class="MsoCaption">Example 60:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Country),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as Actual,Forecast))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"@odata.context": "$metadata#Sales(Customer(Country),Actual,Forecast))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp; &nbsp;"Actual":&nbsp; 5, "Forecast": 4 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp; &nbsp;"Actual": 19, "Forecast": 21 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">The introduced dynamic properties MUST always be in the same
set as the original property.</p>

<p class="MsoCaption">Example 61:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Products?$apply=groupby((Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Sales(Amount with sum as Actual), <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sales/Forecast))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,Sales(Actual,Forecast))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null,"Name":"Coffee","Sales":[{"Actual":12,"Forecast":6}]
},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null,"Name":"Paper", "Sales":[{"Actual":
8,"Forecast":2}] },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null,"Name":"Pencil","Sales":[]
},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null,"Name":"Sugar", "Sales":[{"Actual":
4,"Forecast":7}] }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">When associated with an entity type a custom aggregate MAY
have the same name as a property of the entity with the same type as the type
returned by the custom aggregate. This is typically done when the aggregate is
used as a default aggregate for that property.</p>

<p class="MsoCaption">Example 62 A custom aggregate can be defined with the same
name as a property of the same type in order to define a default aggregate for
that property.</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET ~/Sales?$apply=groupby((Customer/Country),aggregate(Amount))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Country),Amount)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null, "Customer":{ "Country":"Netherlands"
}, "Amount": 5 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id":null, "Customer":{ "Country":"USA"
}, &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;"Amount":19 }<br>
&nbsp; ]<br>
}</p>

</div>

<h2><a name="_Toc435016612"></a><a name="_Toc432754722"></a><a name="_Toc376977475">7.4 Aliasing</a></h2>

<p class="MsoNormal">A property can be aggregated in multiple ways, each with a
different alias.</p>

<p class="MsoCaption">Example 63:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Country),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as Total,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Amount with average as AvgAmt))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"@odata.context": "$metadata#Sales(Customer(Country),Total,AvgAmt))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp; &nbsp;"Total":&nbsp; 5, "AvgAmt": 1.6666667 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:10.5pt;
background:#D9D9D9">&nbsp;&nbsp; &nbsp;"Total": 19, "AvgAmt": 3.8 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">The introduced dynamic properties MUST always be in the same
set as the original property.</p>

<p class="MsoCaption">Example 64:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Products?$apply=groupby((Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Sales(Amount with sum as Total), <br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Sales(Amount with average as AvgAmt)))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Products(Name,Sales(Total,AvgAmt))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{"@odata.id":null,"Name":"Coffee","Sales":[{"Total":&nbsp;
12,"AvgAmt":&nbsp;&nbsp; 6}]},<br>
&nbsp; &nbsp;&nbsp;{"@odata.id":null,"Name":"Paper", "Sales":[{"Total":&nbsp;
&nbsp;8,"AvgAmt":&nbsp;&nbsp; 2}]},<br>
&nbsp; &nbsp;&nbsp;{"@odata.id":null,"Name":"Pencil","Sales":[{"Total":null,"AvgAmt":null}]},<br>
&nbsp; &nbsp;&nbsp;{"@odata.id":null,"Name":"Sugar", "Sales":[{"Total":&nbsp;
&nbsp;4,"AvgAmt":&nbsp;&nbsp; 2}]}<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">There is no hard distinction between groupable and
aggregatable properties: the same property can be aggregated and used to group
the aggregated results.</p>

<p class="MsoCaption">Example 65:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Amount),aggregate(Amount with sum as Total))</p>

</div>

<p class="MsoCaption">will return all distinct amounts appearing in sales orders
and how much money was made with deals of this amount</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Amount,Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Amount": 1, "Total": 2
},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Amount": 2, "Total": 6
},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Amount": 4, "Total": 8
},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Amount": 8, "Total": 8
}<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016613"></a><a name="_Toc432754723"></a><a name="_Toc376977476"></a><a name="_Toc362428757"></a><a name="_Toc354668980"></a><a name="_Toc354070210"></a><a name="_Toc354059099"></a><a name="_Toc353983408"></a><a name="_Toc353453220"></a><a name="_Toc353390980"></a><a name="_Toc353377478"></a><a name="_Toc353294880"></a><a name="_Toc353294828">7.5 Co</a>mbining
Transformations per Group</h2>

<p class="MsoCaption">Example 66: to get the best-selling product per country
with sub-totals for every country, the partial results of a transformation
sequence and a <span class="Datatype">groupby</span> transformation are
concatenated:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">GET ~/Sales?$apply=concat(</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
groupby((Customer/Country,Product/Name,Currency/Code),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as Total))</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((Customer/Country,Currency/Code),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; topcount(1,Total)),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
groupby((Customer/Country,Currency/Code),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as
Total)))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":<br>
&nbsp;&nbsp;&nbsp; &nbsp;"$metadata#Sales(Customer(Country),Product(Name),Total,Currency(Code))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "value":
[<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },<br>
&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;"Product":&nbsp; { "Name": "Coffee" }, <br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total": 12, "Currency": { "Code":
"USD" } <br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Product":&nbsp;
{ "Name": "Paper" }, <br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total":&nbsp; 3, "Currency": { "Code":
"EUR" }<br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" }, <br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total": 19, "Currency": { "Code":
"USD" }<br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" }, <br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total":&nbsp; 5, "Currency": { "Code":
"EUR" }<br>
&nbsp; &nbsp;&nbsp;}<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption"><a name="_Toc354668981"></a><a name="_Toc354070211"></a><a name="_Toc354059100"></a><a name="_Toc353983409"></a><a name="_Toc353453221"></a><a name="_Toc353390981"></a><a name="_Toc353377479"></a><a name="_Toc353294881"></a><a name="_Toc353294829">Example </a>67: transformation sequences are also useful
inside <span class="Datatype">groupby</span>: To get the aggregated amount by only
considering the top two sales amounts per product and county:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Customer/Country,Product/Name,Currency/Code),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
topcount(2,Amount)/aggregate(Amount with sum as Total))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":<br>
&nbsp;&nbsp;&nbsp; &nbsp;"$metadata#Sales(Customer(Country),Product(Name),Total,Currency(Code))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Paper" }, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Total":&nbsp; 3, "Currency": { "Code":
"EUR" }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Product":
{ "Name": "Sugar" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total":&nbsp;
2, "Currency": { "Code": "EUR" }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Coffee" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total":
12, "Currency": { "Code": "USD" }</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Paper" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"Total":&nbsp;
5, "Currency": { "Code": "USD" }&nbsp; </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp; }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016614"></a><a name="_Toc432754724"></a><a name="_Toc376977477"></a><a name="_Toc362428758"></a><a name="_Ref362422336">7.6
Model Functions as Set Transformations</a></h2>

<p class="MsoCaption">Example 68: as a variation of the example shown in the
previous section, a query for returning the best-selling product per country
and the total amount of the remaining products can be formulated with the help
of a model function.</p>

<p class="MsoCaption">For this purpose, the model includes a definition of a <span class="Datatype">TopCountAndBalance</span> function that accepts the count for
the top entities in the given input set not to be considered for the balance:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;edm:Function
Name="TopCountAndBalance" </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
ReturnType="Collection(<span class="Datatype">Edm.EntityType</span>)" </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
IsBound="true"&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;edm:Parameter Name="EntityCollection" </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
Type="Collection(<span class="Datatype">Edm.EntityType</span>)"/&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;edm:Parameter Name="Count" Type="Edm.Int16"/&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;
&lt;edm:Parameter Name="Property" Type="Edm.String"/&gt;</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&lt;/edm:Function&gt;</p>

</div>

<p class="MsoCaption">The function takes the name of a numeric property as a
parameter, retains those entities that <span class="Datatype">topcount</span>
also would retain, and replaces the remaining entities by a single aggregated
entity, where only the numeric property has a defined value being the
aggregated value over those remaining entities:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">GET ~/Sales?$apply=groupby((Customer/Country,Product/Name),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;text-indent:.2in;
page-break-after:avoid;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount
with sum as Total))</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((Customer/Country),</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;page-break-after:avoid;
background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;Self.TopCountAndBalance(Count=1,Property='Total'))</p>

</div>

<p class="MsoCaption">results in </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Country),Product(Name),Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Paper" }, "Total":&nbsp;
3 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"Product":
{ "Name": "**Other**" }, "Total":&nbsp; 2 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "Coffee" }, "Total":
12 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Product": { "Name": "**Other**" }, "Total":&nbsp;
5 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">Note that these two entities get their values for the <span class="Datatype">Country</span> property from the <span class="Datatype">groupby</span>
transformation, which ensures that they contain all grouping properties with
the correct values.</p>

<h2><a name="_Toc435016615"></a><a name="_Toc432754725"></a><a name="_Toc376977478"></a><a name="_Toc362428759">7.7 Controlling Aggregation
per Rollup Level</a></h2>

<p class="MsoNormal">Consumers may specify a different aggregation method per
level for every property passed to <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Grouping_with_rollup"><span style="font-family:&quot;Courier New&quot;">rollup</span></a> as a hierarchy level below
the root level. </p>

<p class="MsoCaption">Example 69: get the average of the overall amount by month
per product.</p>

<p class="MsoCaption">Using a transformation sequence:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Product/ID,Product/Name,Time/Month),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregate(Amount with sum) as Total))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((Product/ID,Product/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Total with average as AverageAmount))</p>

</div>

<p class="MsoCaption">Using <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_The_from_Keyword"><span style="font-family:
&quot;Courier New&quot;">from</span></a>:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Product/ID,Product/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as MonthlyAverage</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
from Time/Month with average))</p>

</div>

<p class="MsoCaption">Example 70: for an aggregate entity set listing the total
sales amounts per customer and country, the rollup shall produce additional instances
for the average total sales amount of customers per country and the average of
that average (which is a bit boring because the example data doesnt have two
countries with the same currency<span style="font-family:Wingdings">J</span>)</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((rollup($all,Customer/Country,Customer/ID),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; Currency/Code),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as CustomerCountryAverage<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from Customer/ID&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; with average<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; from Customer/Country with average))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Customer(Country,ID),CustomerCountryAverage,Currency(Code))",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA", "ID": "C1" }, <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;"CustomerCountryAverage": &nbsp;&nbsp;7, "Currency": { "Code":
"USD" } <br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA", "ID": "C2" }, <br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"CustomerCountryAverage": &nbsp;12, "Currency": { "Code":
"USD" } <br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"USA" }, <br>
&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;"CustomerCountryAverage": 9.5, "Currency": { "Code":
"USD" }<br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands", "ID": "C3" }, <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;"CustomerCountryAverage": &nbsp;&nbsp;5, "Currency": { "Code":
"EUR" } <br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Customer": { "Country":
"Netherlands" }, <br>
&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;"CustomerCountryAverage": &nbsp;&nbsp;5, "Currency": { "Code":
"EUR" }<br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"CustomerCountryAverage": 9.5, "Currency": { "Code":
"USD" }<br>
&nbsp; &nbsp;&nbsp;},<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null,</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;"CustomerCountryAverage":
&nbsp;&nbsp;5, "Currency": { "Code": "EUR" }<br>
&nbsp; &nbsp;&nbsp;}<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<h2><a name="_Toc435016616"></a><a name="_Toc432754726"></a><a name="_Toc376977479"></a><a name="_Toc362428760"></a><a name="_Toc354668982"></a><a name="_Toc354070212"></a><a name="_Toc354059101"></a><a name="_Toc353983410"></a><a name="_Toc353453222">7.8 Transformation </a>Sequences</h2>

<p class="MsoNormal">Applying aggregation first covers the most prominent use
cases. The slightly more sophisticated question "how much money is earned
with small sales" requires filtering the base set before applying the
aggregation. To enable this type of question several transformations can be
specified in <span class="Datatype">$apply</span> in the order they are to be
applied, separated by a forward slash.</p>

<p class="MsoCaption">Example 71:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=filter(Amount le 1)/aggregate(Amount with sum as Total)</p>

</div>

<p class="MsoCaption">means "filter first, then aggregate", and results
in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Total": 2 }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoNormal">Using <span class="Datatype">filter</span> within <span class="Datatype">$apply</span> does not preclude using it as a normal system
query option.</p>

<p class="MsoCaption">Example 72:</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=filter(Amount le 2)/groupby((Product/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Amount with sum as Total))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &amp;$filter=Total ge 4</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp; "@odata.context":
"$metadata#Sales(Product(Name),Total)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Total": 4, "Product": {
"Name": "Paper" } },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Total": 4, "Product": {
"Name": "Sugar" } }<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 73: Revisiting the Example 14 in section 0 for using the <span class="Datatype">from</span> keyword with the <span class="Datatype">aggregate</span> function, the request </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=aggregate(Amount as DailyAverage from Time with average)</p>

</div>

<p class="MsoCaption">could be rewritten in a more procedural way using a transformation
sequence returning the same result</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Sales?$apply=groupby((Time),aggregate(Amount with sum as Total))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /aggregate(Total with average as DailyAverage)</p>

</div>

<p class="MsoCaption">For further examples, consider another data model
containing entity sets for cities, countries and continents and the obvious
associations between them.</p>

<p class="MsoCaption">Example 74: getting the population per country with</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Cities?$apply=groupby((Continent/Name,Country/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Population with sum as TotalPopulation))</p>

</div>

<p class="MsoCaption">results in</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">{</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"@odata.context":</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp; "$metadata#Cities(Continent(Name),Country(Name),TotalPopulation)",</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;
"value": [<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Continent": { "Name":
"Asia" }, </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Country": { "Name": "China" }, "TotalPopulation":
692.580.000 },<br>
&nbsp; &nbsp;&nbsp;{ "@odata.id": null, "Continent": { "Name":
"Asia" },</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
"Country": { "Name": "India" }, "TotalPopulation":
390.600.000 },<br>
&nbsp; &nbsp;&nbsp;...<br>
&nbsp; ]</p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">}</p>

</div>

<p class="MsoCaption">Example 75: all countries with megacities and their continents</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Cities?$apply=filter(Population ge 10000000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((Continent/Name,Country/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Population with sum as TotalPopulation))</p>

</div>

<p class="MsoCaption">Example 76: all countries with tens of millions of city
dwellers and the continents only for these countries</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Cities?$apply=groupby((Continent/Name,Country/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Population with sum as CountryPopulation))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /filter(CountryPopulation ge 10000000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /concat(identity,<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; groupby((Continent/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(CountryPopulation with sum </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
as TotalPopulation)))</p>

</div>

<p class="MsoCaption"> OR </p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Cities?$apply=groupby((Continent/Name,Country/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Population with sum as CountryPopulation))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /filter(CountryPopulation ge 10000000)<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((rollup(Continent/Name,Country/Name)),<br>
&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregate(CountryPopulation with sum </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
as TotalPopulation))</p>

</div>

<p class="MsoCaption">Example 77: all countries with tens of millions of city
dwellers and all continents with cities independent of their size</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/Cities?$apply=groupby((Continent/Name,Country/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Population with sum as CountryPopulation))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /concat(filter(CountryPopulation ge 10000000),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; groupby((Continent/Name),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;aggregate(CountryPopulation with sum </p>

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
as TotalPopulation)))</p>

</div>

<p class="MsoCaption">Example 78: assuming the data model includes a sales order
entity set with related sets for order items and customers, the base set as
well as the related items can be filtered before aggregation</p>

<div style="border-top:solid windowtext 1.0pt;border-left:none;border-bottom:
solid windowtext 1.0pt;border-right:none;padding:3.0pt 0in 3.0pt 0in;
background:#D9D9D9;margin-left:.3in;margin-right:.3in">

<p class="Code" style="margin:0in;margin-bottom:.0001pt;background:#D9D9D9">GET
~/SalesOrders?$apply=filter(Status eq 'incomplete')<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /expand(Items,filter(not Shipped))<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; /groupby((Customer/Country),<br>
&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; aggregate(Items/Amount with sum as ItemAmount))</p>

</div>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<h1><a name="_Toc435016617"></a><a name="_Toc432754727"></a><a name="_Toc376977480"></a><a name="_Toc362428761"></a><a name="_Toc354668983"></a><a name="_Toc354070213"></a><a name="_Toc354059102"></a><a name="_Toc353983411"></a><a name="_Toc353453223">8<span style="font:7.0pt &quot;Times New Roman&quot;">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span>Conformance</a></h1>

</div>

<p class="MsoNormal">Conforming services MUST follow all rules of this
specification for the set transformations and aggregation methods they support.
They MUST implement all set transformations and aggregation methods they
advertise via the <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#_Custom_Aggregates_1">Custom Aggregates</a> annotation.
</p>

<p class="MsoNormal">Conforming clients MUST be prepared to consume a model that
uses any or all of the constructs defined in this specification, including
custom aggregation methods defined by the service, and MUST ignore any
constructs not defined in this version of the specification.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<p class="AppendixHeading1"><a name="_Toc435016618"></a><a name="_Toc432754728"></a><a name="_Toc376977481"></a><a name="_Toc362428762"></a><a name="_Toc354668984"></a><a name="_Toc354070214"></a><a name="_Toc354059103"></a><a name="_Toc353983412"></a><a name="_Toc353453224"></a><a name="_Toc353390992"></a><a name="_Toc353377490"></a><a name="_Toc353294892"></a><a name="_Toc353294840"></a><a name="_Toc337731840"></a><a name="_Toc287332012"></a><a name="_Toc85472897"></a><a name="_Toc356208146"></a><a name="_Toc356223293"></a><a name="_Toc357758639"></a><a name="_Toc357762917"></a><a name="_Toc357764583"></a><a name="_Toc361047221"></a><a name="_Toc361237427"></a><a name="_Toc361237520"></a><a name="_Toc361260141"></a><a name="_Toc361332298"></a>Appendix
A.<span style="font:7.0pt &quot;Times New Roman&quot;"> </span>Acknowledgments</p>

</div>

<p class="MsoNormal">The contributions of the OASIS OData Technical Committee
members, enumerated in <a href="http://docs.oasis-open.org/odata/odata-data-aggregation-ext/v4.0/cs02/odata-data-aggregation-ext-v4.0-cs02.html#odata"><b>[OData-Protocol]</b></a>, are
gratefully acknowledged.</p>

<div style="border:none;border-top:solid gray 1.0pt;padding:6.0pt 0in 0in 0in">

<p class="AppendixHeading1"><a name="_Toc435016619"></a><a name="_Toc432754729"></a><a name="_Toc376977482"></a><a name="_Toc362428763"></a><a name="_Toc354668988"></a><a name="_Toc354070218"></a><a name="_Toc354059107"></a><a name="_Toc353983416"></a><a name="_Toc353453228"></a><a name="_Toc353390996"></a><a name="_Toc353377494"></a><a name="_Toc353294896"></a><a name="_Toc353294844"></a><a name="_Toc337731844"></a><a name="_Toc287332014"></a><a name="_Toc85472898">Appendix B.<span style="font:7.0pt &quot;Times New Roman&quot;"> </span>Revision History</a></p>

</div>

<table class="MsoNormalTable" border="1" cellspacing="0" cellpadding="0" style="margin-left:5.4pt;border-collapse:collapse;border:none">
 <tbody><tr>
  <td width="96" valign="top" style="width:1.0in;border:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><b>Revision</b></p>
  </td>
  <td width="96" valign="top" style="width:1.0in;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><b>Date</b></p>
  </td>
  <td width="144" valign="top" style="width:1.5in;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><b>Editor</b></p>
  </td>
  <td width="295" valign="top" style="width:221.4pt;border:solid windowtext 1.0pt;
  border-left:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal"><b>Changes Made</b></p>
  </td>
 </tr>
 <tr>
  <td width="96" valign="top" style="width:1.0in;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Working Draft 01</p>
  </td>
  <td width="96" valign="top" style="width:1.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">2012-11-12</p>
  </td>
  <td width="144" valign="top" style="width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Ralf Handl</p>
  </td>
  <td width="295" valign="top" style="width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Translated contribution into OASIS format</p>
  </td>
 </tr>
 <tr>
  <td width="96" valign="top" style="width:1.0in;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Committee Specification Draft 01</p>
  </td>
  <td width="96" valign="top" style="width:1.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">2013-07-25</p>
  </td>
  <td width="144" valign="top" style="width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Ralf Handl</p>
  <p class="MsoNormal">Hubert Heijkers</p>
  <p class="MsoNormal">Gerald Krause</p>
  <p class="MsoNormal">Michael Pizzo</p>
  <p class="MsoNormal">Martin Zurmuehl</p>
  </td>
  <td width="295" valign="top" style="width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Switched to pipe-and-filter-style query language based on
  composable set transformations</p>
  <p class="MsoNormal">Fleshed out examples and addressed numerous editorial and
  technical issues processed through the TC</p>
  <p class="MsoNormal">Added Conformance section</p>
  </td>
 </tr>
 <tr>
  <td width="96" valign="top" style="width:1.0in;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Committee Specification Draft 02</p>
  </td>
  <td width="96" valign="top" style="width:1.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">2014-01-09</p>
  </td>
  <td width="144" valign="top" style="width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Ralf Handl</p>
  <p class="MsoNormal">Hubert Heijkers</p>
  <p class="MsoNormal">Gerald Krause</p>
  <p class="MsoNormal">Michael Pizzo</p>
  <p class="MsoNormal">Martin Zurmuehl</p>
  </td>
  <td width="295" valign="top" style="width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Dynamic properties used all aggregated values. either via
  aliases or via custom aggregates</p>
  <p class="MsoNormal">Refactored annotations</p>
  </td>
 </tr>
 <tr>
  <td width="96" valign="top" style="width:1.0in;border:solid windowtext 1.0pt;
  border-top:none;padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Committee Specification Draft 03</p>
  </td>
  <td width="96" valign="top" style="width:1.0in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">2015-07-16</p>
  </td>
  <td width="144" valign="top" style="width:1.5in;border-top:none;border-left:none;
  border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Ralf Handl</p>
  <p class="MsoNormal">Hubert Heijkers</p>
  <p class="MsoNormal">Gerald Krause</p>
  <p class="MsoNormal">Michael Pizzo</p>
  <p class="MsoNormal">Martin Zurmuehl</p>
  </td>
  <td width="295" valign="top" style="width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext 1.0pt;border-right:solid windowtext 1.0pt;
  padding:0in 5.4pt 0in 5.4pt">
  <p class="MsoNormal">Added <span class="Datatype">compute</span> transformation</p>
  <p class="MsoNormal">Minor clean-up</p>
  </td>
 </tr>
</tbody></table>

<p class="MsoNormal">&nbsp;</p>

</div>




</body></html>